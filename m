Return-Path: <linux-mediatek-bounces+lists+linux-mediatek=lfdr.de@lists.infradead.org>
X-Original-To: lists+linux-mediatek@lfdr.de
Delivered-To: lists+linux-mediatek@lfdr.de
Received: from bombadil.infradead.org (bombadil.infradead.org [IPv6:2607:7c80:54:e::133])
	by mail.lfdr.de (Postfix) with ESMTPS id A45D36BAEC
	for <lists+linux-mediatek@lfdr.de>; Wed, 17 Jul 2019 13:03:43 +0200 (CEST)
DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt; c=relaxed/relaxed;
	d=lists.infradead.org; s=bombadil.20170209; h=Sender:
	Content-Transfer-Encoding:Content-Type:Cc:List-Subscribe:List-Help:List-Post:
	List-Archive:List-Unsubscribe:List-Id:MIME-Version:Message-Id:Date:Subject:To
	:From:Reply-To:Content-ID:Content-Description:Resent-Date:Resent-From:
	Resent-Sender:Resent-To:Resent-Cc:Resent-Message-ID:In-Reply-To:References:
	List-Owner; bh=xUeqjGqdVgMnyb0NJXelxX5f8TDdjBDY0BaWflSrjrY=; b=fXKV+dfOYCP6Ma
	THx4RjgoruhuRZa2YXh7HMYWKZwDmbZ+m7ryNtSRiY16BepSZrFSl4KBjfCZHIEhJI83fZSSlzpof
	Rn0lrEfhyCld2n+WjvT/CSGP8OQPMrk6K2qdjpSyuA9I6WcM0NWk2rnsdSLMtiT8nhed4S73AWj4o
	HbMNybIcU/lW7Ty6O3iV8AM4XrOjm8YJN8NRkmQail1ivG41oRF1YBqAZFOecT3ptjqjmec4nT0b2
	d6CdrHq89un8mY+JyY7WPMBtb51DW97N06MX6ksDN11xMRdtYXLNatiMXLrHx9dmHhpbty9diM9fC
	Qjs0jutExSjs4yPeBSOQ==;
Received: from localhost ([127.0.0.1] helo=bombadil.infradead.org)
	by bombadil.infradead.org with esmtp (Exim 4.92 #3 (Red Hat Linux))
	id 1hnhih-0003jF-Lr; Wed, 17 Jul 2019 11:03:35 +0000
Received: from mx2.mailbox.org ([80.241.60.215])
 by bombadil.infradead.org with esmtps (Exim 4.92 #3 (Red Hat Linux))
 id 1hnhib-0003iT-Sy
 for linux-mediatek@lists.infradead.org; Wed, 17 Jul 2019 11:03:33 +0000
Received: from smtp2.mailbox.org (smtp2.mailbox.org [80.241.60.241])
 (using TLSv1.2 with cipher ECDHE-RSA-CHACHA20-POLY1305 (256/256 bits))
 (No client certificate requested)
 by mx2.mailbox.org (Postfix) with ESMTPS id 244B2A1216;
 Wed, 17 Jul 2019 13:03:24 +0200 (CEST)
X-Virus-Scanned: amavisd-new at heinlein-support.de
Received: from smtp2.mailbox.org ([80.241.60.241])
 by spamfilter05.heinlein-hosting.de (spamfilter05.heinlein-hosting.de
 [80.241.56.123]) (amavisd-new, port 10030)
 with ESMTP id M45nXhf2bWdX; Wed, 17 Jul 2019 13:02:50 +0200 (CEST)
From: Stefan Roese <sr@denx.de>
To: netdev@vger.kernel.org
Subject: [PATCH] net: ethernet: mediatek: Add MT7628/88 SoC support
Date: Wed, 17 Jul 2019 13:02:43 +0200
Message-Id: <20190717110243.14240-1-sr@denx.de>
MIME-Version: 1.0
X-CRM114-Version: 20100106-BlameMichelson ( TRE 0.8.0 (BSD) ) MR-646709E3 
X-CRM114-CacheID: sfid-20190717_040330_257592_841FE536 
X-CRM114-Status: GOOD (  20.72  )
X-Spam-Score: -0.7 (/)
X-Spam-Report: SpamAssassin version 3.4.2 on bombadil.infradead.org summary:
 Content analysis details:   (-0.7 points)
 pts rule name              description
 ---- ---------------------- --------------------------------------------------
 -0.7 RCVD_IN_DNSWL_LOW      RBL: Sender listed at https://www.dnswl.org/,
 low trust [80.241.60.215 listed in list.dnswl.org]
 0.0 SPF_NONE               SPF: sender does not publish an SPF Record
 0.0 SPF_HELO_NONE          SPF: HELO does not publish an SPF Record
X-BeenThere: linux-mediatek@lists.infradead.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: <linux-mediatek.lists.infradead.org>
List-Unsubscribe: <http://lists.infradead.org/mailman/options/linux-mediatek>, 
 <mailto:linux-mediatek-request@lists.infradead.org?subject=unsubscribe>
List-Archive: <http://lists.infradead.org/pipermail/linux-mediatek/>
List-Post: <mailto:linux-mediatek@lists.infradead.org>
List-Help: <mailto:linux-mediatek-request@lists.infradead.org?subject=help>
List-Subscribe: <http://lists.infradead.org/mailman/listinfo/linux-mediatek>, 
 <mailto:linux-mediatek-request@lists.infradead.org?subject=subscribe>
Cc: =?UTF-8?q?Ren=C3=A9=20van=20Dorst?= <opensource@vdorst.com>,
 Felix Fietkau <nbd@openwrt.org>, Sean Wang <sean.wang@mediatek.com>,
 linux-mediatek@lists.infradead.org, John Crispin <john@phrozen.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Sender: "Linux-mediatek" <linux-mediatek-bounces@lists.infradead.org>
Errors-To: linux-mediatek-bounces+lists+linux-mediatek=lfdr.de@lists.infradead.org

VGhpcyBwYXRjaCBhZGRzIHN1cHBvcnQgZm9yIHRoZSBNZWRpYVRlayBNVDc2MjgvODggU29DcyB0
byB0aGUgY29tbW9uCk1lZGlhVGVrIGV0aGVybmV0IGRyaXZlci4gU29tZSBtaW5vciBjaGFuZ2Vz
IGFyZSBuZWVkZWQgZm9yIHRoaXMgYW5kCmEgYmlnZ2VyIGNoYW5nZSwgYXMgdGhlIE1UNzYyOCBk
b2VzIG5vdCBzdXBwb3J0IFFETUEgKG9ubHkgUERNQSkuCgpTaWduZWQtb2ZmLWJ5OiBTdGVmYW4g
Um9lc2UgPHNyQGRlbnguZGU+CkNjOiBSZW7DqSB2YW4gRG9yc3QgPG9wZW5zb3VyY2VAdmRvcnN0
LmNvbT4KQ2M6IFNlYW4gV2FuZyA8c2Vhbi53YW5nQG1lZGlhdGVrLmNvbT4KQ2M6IEZlbGl4IEZp
ZXRrYXUgPG5iZEBvcGVud3J0Lm9yZz4KQ2M6IEpvaG4gQ3Jpc3BpbiA8am9obkBwaHJvemVuLm9y
Zz4KLS0tCiAuLi4vZGV2aWNldHJlZS9iaW5kaW5ncy9uZXQvbWVkaWF0ZWstbmV0LnR4dCAgfCAg
IDEgKwogZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVkaWF0ZWsvbXRrX2V0aF9wYXRoLmMgIHwgICA0
ICsKIGRyaXZlcnMvbmV0L2V0aGVybmV0L21lZGlhdGVrL210a19ldGhfc29jLmMgICB8IDQ5MCAr
KysrKysrKysrKysrKy0tLS0KIGRyaXZlcnMvbmV0L2V0aGVybmV0L21lZGlhdGVrL210a19ldGhf
c29jLmggICB8ICAzOSArLQogNCBmaWxlcyBjaGFuZ2VkLCA0MjQgaW5zZXJ0aW9ucygrKSwgMTEw
IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL0RvY3VtZW50YXRpb24vZGV2aWNldHJlZS9iaW5k
aW5ncy9uZXQvbWVkaWF0ZWstbmV0LnR4dCBiL0RvY3VtZW50YXRpb24vZGV2aWNldHJlZS9iaW5k
aW5ncy9uZXQvbWVkaWF0ZWstbmV0LnR4dAppbmRleCA3NzBmZjk4ZDQ1MjQuLmVjNjc5MzU2MjE0
OCAxMDA2NDQKLS0tIGEvRG9jdW1lbnRhdGlvbi9kZXZpY2V0cmVlL2JpbmRpbmdzL25ldC9tZWRp
YXRlay1uZXQudHh0CisrKyBiL0RvY3VtZW50YXRpb24vZGV2aWNldHJlZS9iaW5kaW5ncy9uZXQv
bWVkaWF0ZWstbmV0LnR4dApAQCAtMTEsNiArMTEsNyBAQCBSZXF1aXJlZCBwcm9wZXJ0aWVzOgog
CQkibWVkaWF0ZWssbXQyNzAxLWV0aCI6IGZvciBNVDI3MDEgU29DCiAJCSJtZWRpYXRlayxtdDc2
MjMtZXRoIiwgIm1lZGlhdGVrLG10MjcwMS1ldGgiOiBmb3IgTVQ3NjIzIFNvQwogCQkibWVkaWF0
ZWssbXQ3NjIyLWV0aCI6IGZvciBNVDc2MjIgU29DCisJCSJtZWRpYXRlayxtdDc2MjgtZXRoIjog
Zm9yIE1UNzYyOC84OCBTb0MKIAkJIm1lZGlhdGVrLG10NzYyOS1ldGgiOiBmb3IgTVQ3NjI5IFNv
QwogLSByZWc6IEFkZHJlc3MgYW5kIGxlbmd0aCBvZiB0aGUgcmVnaXN0ZXIgc2V0IGZvciB0aGUg
ZGV2aWNlCiAtIGludGVycnVwdHM6IFNob3VsZCBjb250YWluIHRoZSB0aHJlZSBmcmFtZSBlbmdp
bmVzIGludGVycnVwdHMgaW4gbnVtZXJpYwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9uZXQvZXRoZXJu
ZXQvbWVkaWF0ZWsvbXRrX2V0aF9wYXRoLmMgYi9kcml2ZXJzL25ldC9ldGhlcm5ldC9tZWRpYXRl
ay9tdGtfZXRoX3BhdGguYwppbmRleCA3ZjA1ODgwY2Y5ZWYuLjI4OTYwZTRjNGU0MyAxMDA2NDQK
LS0tIGEvZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVkaWF0ZWsvbXRrX2V0aF9wYXRoLmMKKysrIGIv
ZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVkaWF0ZWsvbXRrX2V0aF9wYXRoLmMKQEAgLTMxNSw2ICsz
MTUsMTAgQEAgaW50IG10a19zZXR1cF9od19wYXRoKHN0cnVjdCBtdGtfZXRoICpldGgsIGludCBt
YWNfaWQsIGludCBwaHltb2RlKQogewogCWludCBlcnI7CiAKKwkvKiBObyBtdXgnaW5nIGZvciBN
VDc2MjgvODggKi8KKwlpZiAoTVRLX0hBU19DQVBTKGV0aC0+c29jLT5jYXBzLCBNVEtfU09DX01U
NzYyOCkpCisJCXJldHVybiAwOworCiAJc3dpdGNoIChwaHltb2RlKSB7CiAJY2FzZSBQSFlfSU5U
RVJGQUNFX01PREVfVFJHTUlJOgogCWNhc2UgUEhZX0lOVEVSRkFDRV9NT0RFX1JHTUlJX1RYSUQ6
CmRpZmYgLS1naXQgYS9kcml2ZXJzL25ldC9ldGhlcm5ldC9tZWRpYXRlay9tdGtfZXRoX3NvYy5j
IGIvZHJpdmVycy9uZXQvZXRoZXJuZXQvbWVkaWF0ZWsvbXRrX2V0aF9zb2MuYwppbmRleCBiMjBi
M2E1YTFlYmIuLjFmMjQ4ZWY2ZWY4OCAxMDA2NDQKLS0tIGEvZHJpdmVycy9uZXQvZXRoZXJuZXQv
bWVkaWF0ZWsvbXRrX2V0aF9zb2MuYworKysgYi9kcml2ZXJzL25ldC9ldGhlcm5ldC9tZWRpYXRl
ay9tdGtfZXRoX3NvYy5jCkBAIC0zMjMsMTEgKzMyMywxNCBAQCBzdGF0aWMgaW50IG10a19waHlf
Y29ubmVjdChzdHJ1Y3QgbmV0X2RldmljZSAqZGV2KQogCQlnb3RvIGVycl9waHk7CiAJfQogCi0J
LyogcHV0IHRoZSBnbWFjIGludG8gdGhlIHJpZ2h0IG1vZGUgKi8KLQlyZWdtYXBfcmVhZChldGgt
PmV0aHN5cywgRVRIU1lTX1NZU0NGRzAsICZ2YWwpOwotCXZhbCAmPSB+U1lTQ0ZHMF9HRV9NT0RF
KFNZU0NGRzBfR0VfTUFTSywgbWFjLT5pZCk7Ci0JdmFsIHw9IFNZU0NGRzBfR0VfTU9ERShtYWMt
PmdlX21vZGUsIG1hYy0+aWQpOwotCXJlZ21hcF93cml0ZShldGgtPmV0aHN5cywgRVRIU1lTX1NZ
U0NGRzAsIHZhbCk7CisJLyogTm8gTVQ3NjI4Lzg4IHN1cHBvcnQgZm9yIG5vdyAqLworCWlmICgh
TVRLX0hBU19DQVBTKGV0aC0+c29jLT5jYXBzLCBNVEtfU09DX01UNzYyOCkpIHsKKwkJLyogcHV0
IHRoZSBnbWFjIGludG8gdGhlIHJpZ2h0IG1vZGUgKi8KKwkJcmVnbWFwX3JlYWQoZXRoLT5ldGhz
eXMsIEVUSFNZU19TWVNDRkcwLCAmdmFsKTsKKwkJdmFsICY9IH5TWVNDRkcwX0dFX01PREUoU1lT
Q0ZHMF9HRV9NQVNLLCBtYWMtPmlkKTsKKwkJdmFsIHw9IFNZU0NGRzBfR0VfTU9ERShtYWMtPmdl
X21vZGUsIG1hYy0+aWQpOworCQlyZWdtYXBfd3JpdGUoZXRoLT5ldGhzeXMsIEVUSFNZU19TWVND
RkcwLCB2YWwpOworCX0KIAogCS8qIGNvdXBsZSBwaHlkZXYgdG8gbmV0X2RldmljZSAqLwogCWlm
IChtdGtfcGh5X2Nvbm5lY3Rfbm9kZShldGgsIG1hYywgbnApKQpAQCAtMzk1LDggKzM5OCw4IEBA
IHN0YXRpYyBpbmxpbmUgdm9pZCBtdGtfdHhfaXJxX2Rpc2FibGUoc3RydWN0IG10a19ldGggKmV0
aCwgdTMyIG1hc2spCiAJdTMyIHZhbDsKIAogCXNwaW5fbG9ja19pcnFzYXZlKCZldGgtPnR4X2ly
cV9sb2NrLCBmbGFncyk7Ci0JdmFsID0gbXRrX3IzMihldGgsIE1US19RRE1BX0lOVF9NQVNLKTsK
LQltdGtfdzMyKGV0aCwgdmFsICYgfm1hc2ssIE1US19RRE1BX0lOVF9NQVNLKTsKKwl2YWwgPSBt
dGtfcjMyKGV0aCwgZXRoLT50eF9pbnRfbWFza19yZWcpOworCW10a193MzIoZXRoLCB2YWwgJiB+
bWFzaywgZXRoLT50eF9pbnRfbWFza19yZWcpOwogCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmV0
aC0+dHhfaXJxX2xvY2ssIGZsYWdzKTsKIH0KIApAQCAtNDA2LDggKzQwOSw4IEBAIHN0YXRpYyBp
bmxpbmUgdm9pZCBtdGtfdHhfaXJxX2VuYWJsZShzdHJ1Y3QgbXRrX2V0aCAqZXRoLCB1MzIgbWFz
aykKIAl1MzIgdmFsOwogCiAJc3Bpbl9sb2NrX2lycXNhdmUoJmV0aC0+dHhfaXJxX2xvY2ssIGZs
YWdzKTsKLQl2YWwgPSBtdGtfcjMyKGV0aCwgTVRLX1FETUFfSU5UX01BU0spOwotCW10a193MzIo
ZXRoLCB2YWwgfCBtYXNrLCBNVEtfUURNQV9JTlRfTUFTSyk7CisJdmFsID0gbXRrX3IzMihldGgs
IGV0aC0+dHhfaW50X21hc2tfcmVnKTsKKwltdGtfdzMyKGV0aCwgdmFsIHwgbWFzaywgZXRoLT50
eF9pbnRfbWFza19yZWcpOwogCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmV0aC0+dHhfaXJxX2xv
Y2ssIGZsYWdzKTsKIH0KIApAQCAtNDM3LDYgKzQ0MCw3IEBAIHN0YXRpYyBpbnQgbXRrX3NldF9t
YWNfYWRkcmVzcyhzdHJ1Y3QgbmV0X2RldmljZSAqZGV2LCB2b2lkICpwKQogewogCWludCByZXQg
PSBldGhfbWFjX2FkZHIoZGV2LCBwKTsKIAlzdHJ1Y3QgbXRrX21hYyAqbWFjID0gbmV0ZGV2X3By
aXYoZGV2KTsKKwlzdHJ1Y3QgbXRrX2V0aCAqZXRoID0gbWFjLT5odzsKIAljb25zdCBjaGFyICpt
YWNhZGRyID0gZGV2LT5kZXZfYWRkcjsKIAogCWlmIChyZXQpCkBAIC00NDYsMTEgKzQ1MCwxOSBA
QCBzdGF0aWMgaW50IG10a19zZXRfbWFjX2FkZHJlc3Moc3RydWN0IG5ldF9kZXZpY2UgKmRldiwg
dm9pZCAqcCkKIAkJcmV0dXJuIC1FQlVTWTsKIAogCXNwaW5fbG9ja19iaCgmbWFjLT5ody0+cGFn
ZV9sb2NrKTsKLQltdGtfdzMyKG1hYy0+aHcsIChtYWNhZGRyWzBdIDw8IDgpIHwgbWFjYWRkclsx
XSwKLQkJTVRLX0dETUFfTUFDX0FEUkgobWFjLT5pZCkpOwotCW10a193MzIobWFjLT5odywgKG1h
Y2FkZHJbMl0gPDwgMjQpIHwgKG1hY2FkZHJbM10gPDwgMTYpIHwKLQkJKG1hY2FkZHJbNF0gPDwg
OCkgfCBtYWNhZGRyWzVdLAotCQlNVEtfR0RNQV9NQUNfQURSTChtYWMtPmlkKSk7CisJaWYgKE1U
S19IQVNfQ0FQUyhldGgtPnNvYy0+Y2FwcywgTVRLX1NPQ19NVDc2MjgpKSB7CisJCW10a193MzIo
bWFjLT5odywgKG1hY2FkZHJbMF0gPDwgOCkgfCBtYWNhZGRyWzFdLAorCQkJTVQ3NjI4X1NETV9N
QUNfQURSSCk7CisJCW10a193MzIobWFjLT5odywgKG1hY2FkZHJbMl0gPDwgMjQpIHwgKG1hY2Fk
ZHJbM10gPDwgMTYpIHwKKwkJCShtYWNhZGRyWzRdIDw8IDgpIHwgbWFjYWRkcls1XSwKKwkJCU1U
NzYyOF9TRE1fTUFDX0FEUkwpOworCX0gZWxzZSB7CisJCW10a193MzIobWFjLT5odywgKG1hY2Fk
ZHJbMF0gPDwgOCkgfCBtYWNhZGRyWzFdLAorCQkJTVRLX0dETUFfTUFDX0FEUkgobWFjLT5pZCkp
OworCQltdGtfdzMyKG1hYy0+aHcsIChtYWNhZGRyWzJdIDw8IDI0KSB8IChtYWNhZGRyWzNdIDw8
IDE2KSB8CisJCQkobWFjYWRkcls0XSA8PCA4KSB8IG1hY2FkZHJbNV0sCisJCQlNVEtfR0RNQV9N
QUNfQURSTChtYWMtPmlkKSk7CisJfQogCXNwaW5fdW5sb2NrX2JoKCZtYWMtPmh3LT5wYWdlX2xv
Y2spOwogCiAJcmV0dXJuIDA7CkBAIC02MjYsMTkgKzYzOCw0NyBAQCBzdGF0aWMgaW5saW5lIHN0
cnVjdCBtdGtfdHhfYnVmICptdGtfZGVzY190b190eF9idWYoc3RydWN0IG10a190eF9yaW5nICpy
aW5nLAogCXJldHVybiAmcmluZy0+YnVmW2lkeF07CiB9CiAKK3N0YXRpYyBzdHJ1Y3QgbXRrX3R4
X2RtYSAqcWRtYV90b19wZG1hKHN0cnVjdCBtdGtfdHhfcmluZyAqcmluZywKKwkJCQkgICAgICAg
c3RydWN0IG10a190eF9kbWEgKmRtYSkKK3sKKwlyZXR1cm4gcmluZy0+ZG1hX3BkbWEgLSByaW5n
LT5kbWEgKyBkbWE7Cit9CisKK3N0YXRpYyBpbnQgdHhkX3RvX2lkeChzdHJ1Y3QgbXRrX3R4X3Jp
bmcgKnJpbmcsIHN0cnVjdCBtdGtfdHhfZG1hICpkbWEpCit7CisJcmV0dXJuICgodTMyKWRtYSAt
ICh1MzIpcmluZy0+ZG1hKSAvIHNpemVvZigqZG1hKTsKK30KKwogc3RhdGljIHZvaWQgbXRrX3R4
X3VubWFwKHN0cnVjdCBtdGtfZXRoICpldGgsIHN0cnVjdCBtdGtfdHhfYnVmICp0eF9idWYpCiB7
Ci0JaWYgKHR4X2J1Zi0+ZmxhZ3MgJiBNVEtfVFhfRkxBR1NfU0lOR0xFMCkgewotCQlkbWFfdW5t
YXBfc2luZ2xlKGV0aC0+ZGV2LAotCQkJCSBkbWFfdW5tYXBfYWRkcih0eF9idWYsIGRtYV9hZGRy
MCksCi0JCQkJIGRtYV91bm1hcF9sZW4odHhfYnVmLCBkbWFfbGVuMCksCi0JCQkJIERNQV9UT19E
RVZJQ0UpOwotCX0gZWxzZSBpZiAodHhfYnVmLT5mbGFncyAmIE1US19UWF9GTEFHU19QQUdFMCkg
ewotCQlkbWFfdW5tYXBfcGFnZShldGgtPmRldiwKLQkJCSAgICAgICBkbWFfdW5tYXBfYWRkcih0
eF9idWYsIGRtYV9hZGRyMCksCi0JCQkgICAgICAgZG1hX3VubWFwX2xlbih0eF9idWYsIGRtYV9s
ZW4wKSwKLQkJCSAgICAgICBETUFfVE9fREVWSUNFKTsKKwlpZiAoTVRLX0hBU19DQVBTKGV0aC0+
c29jLT5jYXBzLCBNVEtfU09DX01UNzYyOCkpIHsKKwkJaWYgKGRtYV91bm1hcF9sZW4odHhfYnVm
LCBkbWFfbGVuMCkpIHsKKwkJCWRtYV91bm1hcF9wYWdlKGV0aC0+ZGV2LAorCQkJCSAgICAgICBk
bWFfdW5tYXBfYWRkcih0eF9idWYsIGRtYV9hZGRyMCksCisJCQkJICAgICAgIGRtYV91bm1hcF9s
ZW4odHhfYnVmLCBkbWFfbGVuMCksCisJCQkJICAgICAgIERNQV9UT19ERVZJQ0UpOworCQl9CisK
KwkJaWYgKGRtYV91bm1hcF9sZW4odHhfYnVmLCBkbWFfbGVuMSkpIHsKKwkJCWRtYV91bm1hcF9w
YWdlKGV0aC0+ZGV2LAorCQkJCSAgICAgICBkbWFfdW5tYXBfYWRkcih0eF9idWYsIGRtYV9hZGRy
MSksCisJCQkJICAgICAgIGRtYV91bm1hcF9sZW4odHhfYnVmLCBkbWFfbGVuMSksCisJCQkJICAg
ICAgIERNQV9UT19ERVZJQ0UpOworCQl9CisJfSBlbHNlIHsKKwkJaWYgKHR4X2J1Zi0+ZmxhZ3Mg
JiBNVEtfVFhfRkxBR1NfU0lOR0xFMCkgeworCQkJZG1hX3VubWFwX3NpbmdsZShldGgtPmRldiwK
KwkJCQkJIGRtYV91bm1hcF9hZGRyKHR4X2J1ZiwgZG1hX2FkZHIwKSwKKwkJCQkJIGRtYV91bm1h
cF9sZW4odHhfYnVmLCBkbWFfbGVuMCksCisJCQkJCSBETUFfVE9fREVWSUNFKTsKKwkJfSBlbHNl
IGlmICh0eF9idWYtPmZsYWdzICYgTVRLX1RYX0ZMQUdTX1BBR0UwKSB7CisJCQlkbWFfdW5tYXBf
cGFnZShldGgtPmRldiwKKwkJCQkgICAgICAgZG1hX3VubWFwX2FkZHIodHhfYnVmLCBkbWFfYWRk
cjApLAorCQkJCSAgICAgICBkbWFfdW5tYXBfbGVuKHR4X2J1ZiwgZG1hX2xlbjApLAorCQkJCSAg
ICAgICBETUFfVE9fREVWSUNFKTsKKwkJfQogCX0KKwogCXR4X2J1Zi0+ZmxhZ3MgPSAwOwogCWlm
ICh0eF9idWYtPnNrYiAmJgogCSAgICAodHhfYnVmLT5za2IgIT0gKHN0cnVjdCBza19idWZmICop
TVRLX0RNQV9EVU1NWV9ERVNDKSkKQEAgLTY0NiwxOSArNjg2LDQ1IEBAIHN0YXRpYyB2b2lkIG10
a190eF91bm1hcChzdHJ1Y3QgbXRrX2V0aCAqZXRoLCBzdHJ1Y3QgbXRrX3R4X2J1ZiAqdHhfYnVm
KQogCXR4X2J1Zi0+c2tiID0gTlVMTDsKIH0KIAorc3RhdGljIHZvaWQgc2V0dXBfdHhfYnVmKHN0
cnVjdCBtdGtfZXRoICpldGgsIHN0cnVjdCBtdGtfdHhfYnVmICp0eF9idWYsCisJCQkgc3RydWN0
IG10a190eF9kbWEgKnR4ZCwgZG1hX2FkZHJfdCBtYXBwZWRfYWRkciwKKwkJCSBzaXplX3Qgc2l6
ZSwgaW50IGlkeCkKK3sKKwlpZiAoTVRLX0hBU19DQVBTKGV0aC0+c29jLT5jYXBzLCBNVEtfU09D
X01UNzYyOCkpIHsKKwkJaWYgKGlkeCAmIDEpIHsKKwkJCXR4ZC0+dHhkMyA9IG1hcHBlZF9hZGRy
OworCQkJdHhkLT50eGQyIHw9IFRYX0RNQV9QTEVOMShzaXplKTsKKwkJCWRtYV91bm1hcF9hZGRy
X3NldCh0eF9idWYsIGRtYV9hZGRyMSwgbWFwcGVkX2FkZHIpOworCQkJZG1hX3VubWFwX2xlbl9z
ZXQodHhfYnVmLCBkbWFfbGVuMSwgc2l6ZSk7CisJCX0gZWxzZSB7CisJCQl0eF9idWYtPnNrYiA9
IChzdHJ1Y3Qgc2tfYnVmZiAqKU1US19ETUFfRFVNTVlfREVTQzsKKwkJCXR4ZC0+dHhkMSA9IG1h
cHBlZF9hZGRyOworCQkJdHhkLT50eGQyID0gVFhfRE1BX1BMRU4wKHNpemUpOworCQkJZG1hX3Vu
bWFwX2FkZHJfc2V0KHR4X2J1ZiwgZG1hX2FkZHIwLCBtYXBwZWRfYWRkcik7CisJCQlkbWFfdW5t
YXBfbGVuX3NldCh0eF9idWYsIGRtYV9sZW4wLCBzaXplKTsKKwkJfQorCX0gZWxzZSB7CisJCWRt
YV91bm1hcF9hZGRyX3NldCh0eF9idWYsIGRtYV9hZGRyMCwgbWFwcGVkX2FkZHIpOworCQlkbWFf
dW5tYXBfbGVuX3NldCh0eF9idWYsIGRtYV9sZW4wLCBzaXplKTsKKwl9Cit9CisKIHN0YXRpYyBp
bnQgbXRrX3R4X21hcChzdHJ1Y3Qgc2tfYnVmZiAqc2tiLCBzdHJ1Y3QgbmV0X2RldmljZSAqZGV2
LAogCQkgICAgICBpbnQgdHhfbnVtLCBzdHJ1Y3QgbXRrX3R4X3JpbmcgKnJpbmcsIGJvb2wgZ3Nv
KQogewogCXN0cnVjdCBtdGtfbWFjICptYWMgPSBuZXRkZXZfcHJpdihkZXYpOwogCXN0cnVjdCBt
dGtfZXRoICpldGggPSBtYWMtPmh3OwogCXN0cnVjdCBtdGtfdHhfZG1hICppdHhkLCAqdHhkOwor
CXN0cnVjdCBtdGtfdHhfZG1hICppdHhkX3BkbWEsICp0eGRfcGRtYTsKIAlzdHJ1Y3QgbXRrX3R4
X2J1ZiAqaXR4X2J1ZiwgKnR4X2J1ZjsKIAlkbWFfYWRkcl90IG1hcHBlZF9hZGRyOwogCXVuc2ln
bmVkIGludCBucl9mcmFnczsKIAlpbnQgaSwgbl9kZXNjID0gMTsKIAl1MzIgdHhkNCA9IDAsIGZw
b3J0OworCWludCBrID0gMDsKIAogCWl0eGQgPSByaW5nLT5uZXh0X2ZyZWU7CisJaXR4ZF9wZG1h
ID0gcWRtYV90b19wZG1hKHJpbmcsIGl0eGQpOwogCWlmIChpdHhkID09IHJpbmctPmxhc3RfZnJl
ZSkKIAkJcmV0dXJuIC1FTk9NRU07CiAKQEAgLTY4OSwxMiArNzU1LDE0IEBAIHN0YXRpYyBpbnQg
bXRrX3R4X21hcChzdHJ1Y3Qgc2tfYnVmZiAqc2tiLCBzdHJ1Y3QgbmV0X2RldmljZSAqZGV2LAog
CWl0eF9idWYtPmZsYWdzIHw9IE1US19UWF9GTEFHU19TSU5HTEUwOwogCWl0eF9idWYtPmZsYWdz
IHw9ICghbWFjLT5pZCkgPyBNVEtfVFhfRkxBR1NfRlBPUlQwIDoKIAkJCSAgTVRLX1RYX0ZMQUdT
X0ZQT1JUMTsKLQlkbWFfdW5tYXBfYWRkcl9zZXQoaXR4X2J1ZiwgZG1hX2FkZHIwLCBtYXBwZWRf
YWRkcik7Ci0JZG1hX3VubWFwX2xlbl9zZXQoaXR4X2J1ZiwgZG1hX2xlbjAsIHNrYl9oZWFkbGVu
KHNrYikpOworCXNldHVwX3R4X2J1ZihldGgsIGl0eF9idWYsIGl0eGRfcGRtYSwgbWFwcGVkX2Fk
ZHIsIHNrYl9oZWFkbGVuKHNrYiksCisJCSAgICAgaysrKTsKIAogCS8qIFRYIFNHIG9mZmxvYWQg
Ki8KIAl0eGQgPSBpdHhkOworCXR4ZF9wZG1hID0gcWRtYV90b19wZG1hKHJpbmcsIHR4ZCk7CiAJ
bnJfZnJhZ3MgPSBza2Jfc2hpbmZvKHNrYiktPm5yX2ZyYWdzOworCiAJZm9yIChpID0gMDsgaSA8
IG5yX2ZyYWdzOyBpKyspIHsKIAkJc3RydWN0IHNrYl9mcmFnX3N0cnVjdCAqZnJhZyA9ICZza2Jf
c2hpbmZvKHNrYiktPmZyYWdzW2ldOwogCQl1bnNpZ25lZCBpbnQgb2Zmc2V0ID0gMDsKQEAgLTcw
MywxMiArNzcxLDIwIEBAIHN0YXRpYyBpbnQgbXRrX3R4X21hcChzdHJ1Y3Qgc2tfYnVmZiAqc2ti
LCBzdHJ1Y3QgbmV0X2RldmljZSAqZGV2LAogCQl3aGlsZSAoZnJhZ19zaXplKSB7CiAJCQlib29s
IGxhc3RfZnJhZyA9IGZhbHNlOwogCQkJdW5zaWduZWQgaW50IGZyYWdfbWFwX3NpemU7CisJCQli
b29sIG5ld19kZXNjID0gdHJ1ZTsKKworCQkJaWYgKE1US19IQVNfQ0FQUyhldGgtPnNvYy0+Y2Fw
cywgTVRLX1NPQ19NVDc2MjgpICYmCisJCQkgICAgIShpICYgMHgxKSkgeworCQkJCW5ld19kZXNj
ID0gZmFsc2U7CisJCQl9IGVsc2UgeworCQkJCXR4ZCA9IG10a19xZG1hX3BoeXNfdG9fdmlydChy
aW5nLCB0eGQtPnR4ZDIpOworCQkJCXR4ZF9wZG1hID0gcWRtYV90b19wZG1hKHJpbmcsIHR4ZCk7
CisJCQkJaWYgKHR4ZCA9PSByaW5nLT5sYXN0X2ZyZWUpCisJCQkJCWdvdG8gZXJyX2RtYTsKKwor
CQkJCW5fZGVzYysrOworCQkJfQogCi0JCQl0eGQgPSBtdGtfcWRtYV9waHlzX3RvX3ZpcnQocmlu
ZywgdHhkLT50eGQyKTsKLQkJCWlmICh0eGQgPT0gcmluZy0+bGFzdF9mcmVlKQotCQkJCWdvdG8g
ZXJyX2RtYTsKLQotCQkJbl9kZXNjKys7CiAJCQlmcmFnX21hcF9zaXplID0gbWluKGZyYWdfc2l6
ZSwgTVRLX1RYX0RNQV9CVUZfTEVOKTsKIAkJCW1hcHBlZF9hZGRyID0gc2tiX2ZyYWdfZG1hX21h
cChldGgtPmRldiwgZnJhZywgb2Zmc2V0LAogCQkJCQkJICAgICAgIGZyYWdfbWFwX3NpemUsCkBA
IC03MjcsMTQgKzgwMywxNiBAQCBzdGF0aWMgaW50IG10a190eF9tYXAoc3RydWN0IHNrX2J1ZmYg
KnNrYiwgc3RydWN0IG5ldF9kZXZpY2UgKmRldiwKIAkJCVdSSVRFX09OQ0UodHhkLT50eGQ0LCBm
cG9ydCk7CiAKIAkJCXR4X2J1ZiA9IG10a19kZXNjX3RvX3R4X2J1ZihyaW5nLCB0eGQpOwotCQkJ
bWVtc2V0KHR4X2J1ZiwgMCwgc2l6ZW9mKCp0eF9idWYpKTsKKwkJCWlmIChuZXdfZGVzYykKKwkJ
CQltZW1zZXQodHhfYnVmLCAwLCBzaXplb2YoKnR4X2J1ZikpOwogCQkJdHhfYnVmLT5za2IgPSAo
c3RydWN0IHNrX2J1ZmYgKilNVEtfRE1BX0RVTU1ZX0RFU0M7CiAJCQl0eF9idWYtPmZsYWdzIHw9
IE1US19UWF9GTEFHU19QQUdFMDsKIAkJCXR4X2J1Zi0+ZmxhZ3MgfD0gKCFtYWMtPmlkKSA/IE1U
S19UWF9GTEFHU19GUE9SVDAgOgogCQkJCQkgTVRLX1RYX0ZMQUdTX0ZQT1JUMTsKIAotCQkJZG1h
X3VubWFwX2FkZHJfc2V0KHR4X2J1ZiwgZG1hX2FkZHIwLCBtYXBwZWRfYWRkcik7Ci0JCQlkbWFf
dW5tYXBfbGVuX3NldCh0eF9idWYsIGRtYV9sZW4wLCBmcmFnX21hcF9zaXplKTsKKwkJCXNldHVw
X3R4X2J1ZihldGgsIHR4X2J1ZiwgdHhkX3BkbWEsIG1hcHBlZF9hZGRyLAorCQkJCSAgICAgZnJh
Z19tYXBfc2l6ZSwgaysrKTsKKwogCQkJZnJhZ19zaXplIC09IGZyYWdfbWFwX3NpemU7CiAJCQlv
ZmZzZXQgKz0gZnJhZ19tYXBfc2l6ZTsKIAkJfQpAQCAtNzQ2LDYgKzgyNCwxMiBAQCBzdGF0aWMg
aW50IG10a190eF9tYXAoc3RydWN0IHNrX2J1ZmYgKnNrYiwgc3RydWN0IG5ldF9kZXZpY2UgKmRl
diwKIAlXUklURV9PTkNFKGl0eGQtPnR4ZDQsIHR4ZDQpOwogCVdSSVRFX09OQ0UoaXR4ZC0+dHhk
MywgKFRYX0RNQV9TV0MgfCBUWF9ETUFfUExFTjAoc2tiX2hlYWRsZW4oc2tiKSkgfAogCQkJCSgh
bnJfZnJhZ3MgKiBUWF9ETUFfTFMwKSkpOworCWlmIChNVEtfSEFTX0NBUFMoZXRoLT5zb2MtPmNh
cHMsIE1US19TT0NfTVQ3NjI4KSkgeworCQlpZiAoayAmIDB4MSkKKwkJCXR4ZF9wZG1hLT50eGQy
IHw9IFRYX0RNQV9MUzA7CisJCWVsc2UKKwkJCXR4ZF9wZG1hLT50eGQyIHw9IFRYX0RNQV9MUzE7
CisJfQogCiAJbmV0ZGV2X3NlbnRfcXVldWUoZGV2LCBza2ItPmxlbik7CiAJc2tiX3R4X3RpbWVz
dGFtcChza2IpOwpAQCAtNzU4LDkgKzg0MiwxNSBAQCBzdGF0aWMgaW50IG10a190eF9tYXAoc3Ry
dWN0IHNrX2J1ZmYgKnNrYiwgc3RydWN0IG5ldF9kZXZpY2UgKmRldiwKIAkgKi8KIAl3bWIoKTsK
IAotCWlmIChuZXRpZl94bWl0X3N0b3BwZWQobmV0ZGV2X2dldF90eF9xdWV1ZShkZXYsIDApKSB8
fAotCSAgICAhbmV0ZGV2X3htaXRfbW9yZSgpKQotCQltdGtfdzMyKGV0aCwgdHhkLT50eGQyLCBN
VEtfUVRYX0NUWF9QVFIpOworCWlmIChNVEtfSEFTX0NBUFMoZXRoLT5zb2MtPmNhcHMsIE1US19T
T0NfTVQ3NjI4KSkgeworCQlpbnQgbmV4dF9pZHggPSBORVhUX0RFU1BfSURYKHR4ZF90b19pZHgo
cmluZywgdHhkKSwKKwkJCQkJICAgICByaW5nLT5kbWFfc2l6ZSk7CisJCW10a193MzIoZXRoLCBu
ZXh0X2lkeCwgTVQ3NjI4X1RYX0NUWF9JRFgwKTsKKwl9IGVsc2UgeworCQlpZiAobmV0aWZfeG1p
dF9zdG9wcGVkKG5ldGRldl9nZXRfdHhfcXVldWUoZGV2LCAwKSkgfHwKKwkJICAgICFuZXRkZXZf
eG1pdF9tb3JlKCkpCisJCQltdGtfdzMyKGV0aCwgdHhkLT50eGQyLCBNVEtfUVRYX0NUWF9QVFIp
OworCX0KIAogCXJldHVybiAwOwogCkBAIC03NzIsNyArODYyLDExIEBAIHN0YXRpYyBpbnQgbXRr
X3R4X21hcChzdHJ1Y3Qgc2tfYnVmZiAqc2tiLCBzdHJ1Y3QgbmV0X2RldmljZSAqZGV2LAogCQlt
dGtfdHhfdW5tYXAoZXRoLCB0eF9idWYpOwogCiAJCWl0eGQtPnR4ZDMgPSBUWF9ETUFfTFMwIHwg
VFhfRE1BX09XTkVSX0NQVTsKKwkJaWYgKE1US19IQVNfQ0FQUyhldGgtPnNvYy0+Y2FwcywgTVRL
X1NPQ19NVDc2MjgpKQorCQkJaXR4ZF9wZG1hLT50eGQyID0gVFhfRE1BX0RFU1AyX0RFRjsKKwog
CQlpdHhkID0gbXRrX3FkbWFfcGh5c190b192aXJ0KHJpbmcsIGl0eGQtPnR4ZDIpOworCQlpdHhk
X3BkbWEgPSBxZG1hX3RvX3BkbWEocmluZywgaXR4ZCk7CiAJfSB3aGlsZSAoaXR4ZCAhPSB0eGQp
OwogCiAJcmV0dXJuIC1FTk9NRU07CkBAIC05MDIsNyArOTk2LDcgQEAgc3RhdGljIHN0cnVjdCBt
dGtfcnhfcmluZyAqbXRrX2dldF9yeF9yaW5nKHN0cnVjdCBtdGtfZXRoICpldGgpCiAKIAlmb3Ig
KGkgPSAwOyBpIDwgTVRLX01BWF9SWF9SSU5HX05VTTsgaSsrKSB7CiAJCXJpbmcgPSAmZXRoLT5y
eF9yaW5nW2ldOwotCQlpZHggPSBORVhUX1JYX0RFU1BfSURYKHJpbmctPmNhbGNfaWR4LCByaW5n
LT5kbWFfc2l6ZSk7CisJCWlkeCA9IE5FWFRfREVTUF9JRFgocmluZy0+Y2FsY19pZHgsIHJpbmct
PmRtYV9zaXplKTsKIAkJaWYgKHJpbmctPmRtYVtpZHhdLnJ4ZDIgJiBSWF9ETUFfRE9ORSkgewog
CQkJcmluZy0+Y2FsY19pZHhfdXBkYXRlID0gdHJ1ZTsKIAkJCXJldHVybiByaW5nOwpAQCAtOTQ1
LDEzICsxMDM5LDEzIEBAIHN0YXRpYyBpbnQgbXRrX3BvbGxfcngoc3RydWN0IG5hcGlfc3RydWN0
ICpuYXBpLCBpbnQgYnVkZ2V0LAogCQlzdHJ1Y3QgbmV0X2RldmljZSAqbmV0ZGV2OwogCQl1bnNp
Z25lZCBpbnQgcGt0bGVuOwogCQlkbWFfYWRkcl90IGRtYV9hZGRyOwotCQlpbnQgbWFjID0gMDsK
KwkJaW50IG1hYzsKIAogCQlyaW5nID0gbXRrX2dldF9yeF9yaW5nKGV0aCk7CiAJCWlmICh1bmxp
a2VseSghcmluZykpCiAJCQlnb3RvIHJ4X2RvbmU7CiAKLQkJaWR4ID0gTkVYVF9SWF9ERVNQX0lE
WChyaW5nLT5jYWxjX2lkeCwgcmluZy0+ZG1hX3NpemUpOworCQlpZHggPSBORVhUX0RFU1BfSURY
KHJpbmctPmNhbGNfaWR4LCByaW5nLT5kbWFfc2l6ZSk7CiAJCXJ4ZCA9ICZyaW5nLT5kbWFbaWR4
XTsKIAkJZGF0YSA9IHJpbmctPmRhdGFbaWR4XTsKIApAQCAtOTYwLDkgKzEwNTQsMTMgQEAgc3Rh
dGljIGludCBtdGtfcG9sbF9yeChzdHJ1Y3QgbmFwaV9zdHJ1Y3QgKm5hcGksIGludCBidWRnZXQs
CiAJCQlicmVhazsKIAogCQkvKiBmaW5kIG91dCB3aGljaCBtYWMgdGhlIHBhY2tldCBjb21lIGZy
b20uIHZhbHVlcyBzdGFydCBhdCAxICovCi0JCW1hYyA9ICh0cnhkLnJ4ZDQgPj4gUlhfRE1BX0ZQ
T1JUX1NISUZUKSAmCi0JCSAgICAgIFJYX0RNQV9GUE9SVF9NQVNLOwotCQltYWMtLTsKKwkJaWYg
KE1US19IQVNfQ0FQUyhldGgtPnNvYy0+Y2FwcywgTVRLX1NPQ19NVDc2MjgpKSB7CisJCQltYWMg
PSAwOworCQl9IGVsc2UgeworCQkJbWFjID0gKHRyeGQucnhkNCA+PiBSWF9ETUFfRlBPUlRfU0hJ
RlQpICYKKwkJCQlSWF9ETUFfRlBPUlRfTUFTSzsKKwkJCW1hYy0tOworCQl9CiAKIAkJaWYgKHVu
bGlrZWx5KG1hYyA8IDAgfHwgbWFjID49IE1US19NQUNfQ09VTlQgfHwKIAkJCSAgICAgIWV0aC0+
bmV0ZGV2W21hY10pKQpAQCAtOTgwLDcgKzEwNzgsOCBAQCBzdGF0aWMgaW50IG10a19wb2xsX3J4
KHN0cnVjdCBuYXBpX3N0cnVjdCAqbmFwaSwgaW50IGJ1ZGdldCwKIAkJCWdvdG8gcmVsZWFzZV9k
ZXNjOwogCQl9CiAJCWRtYV9hZGRyID0gZG1hX21hcF9zaW5nbGUoZXRoLT5kZXYsCi0JCQkJCSAg
bmV3X2RhdGEgKyBORVRfU0tCX1BBRCwKKwkJCQkJICBuZXdfZGF0YSArIE5FVF9TS0JfUEFEICsK
KwkJCQkJICBldGgtPmlwX2FsaWduLAogCQkJCQkgIHJpbmctPmJ1Zl9zaXplLAogCQkJCQkgIERN
QV9GUk9NX0RFVklDRSk7CiAJCWlmICh1bmxpa2VseShkbWFfbWFwcGluZ19lcnJvcihldGgtPmRl
diwgZG1hX2FkZHIpKSkgewpAQCAtMTAwMyw3ICsxMTAyLDcgQEAgc3RhdGljIGludCBtdGtfcG9s
bF9yeChzdHJ1Y3QgbmFwaV9zdHJ1Y3QgKm5hcGksIGludCBidWRnZXQsCiAJCXBrdGxlbiA9IFJY
X0RNQV9HRVRfUExFTjAodHJ4ZC5yeGQyKTsKIAkJc2tiLT5kZXYgPSBuZXRkZXY7CiAJCXNrYl9w
dXQoc2tiLCBwa3RsZW4pOwotCQlpZiAodHJ4ZC5yeGQ0ICYgUlhfRE1BX0w0X1ZBTElEKQorCQlp
ZiAodHJ4ZC5yeGQ0ICYgZXRoLT5yeF9kbWFfbDRfdmFsaWQpCiAJCQlza2ItPmlwX3N1bW1lZCA9
IENIRUNLU1VNX1VOTkVDRVNTQVJZOwogCQllbHNlCiAJCQlza2JfY2hlY2tzdW1fbm9uZV9hc3Nl
cnQoc2tiKTsKQEAgLTEwMjAsNyArMTExOSwxMCBAQCBzdGF0aWMgaW50IG10a19wb2xsX3J4KHN0
cnVjdCBuYXBpX3N0cnVjdCAqbmFwaSwgaW50IGJ1ZGdldCwKIAkJcnhkLT5yeGQxID0gKHVuc2ln
bmVkIGludClkbWFfYWRkcjsKIAogcmVsZWFzZV9kZXNjOgotCQlyeGQtPnJ4ZDIgPSBSWF9ETUFf
UExFTjAocmluZy0+YnVmX3NpemUpOworCQlpZiAoTVRLX0hBU19DQVBTKGV0aC0+c29jLT5jYXBz
LCBNVEtfU09DX01UNzYyOCkpCisJCQlyeGQtPnJ4ZDIgPSBSWF9ETUFfTFNPOworCQllbHNlCisJ
CQlyeGQtPnJ4ZDIgPSBSWF9ETUFfUExFTjAocmluZy0+YnVmX3NpemUpOwogCiAJCXJpbmctPmNh
bGNfaWR4ID0gaWR4OwogCkBAIC0xMDM5LDE5ICsxMTQxLDE0IEBAIHN0YXRpYyBpbnQgbXRrX3Bv
bGxfcngoc3RydWN0IG5hcGlfc3RydWN0ICpuYXBpLCBpbnQgYnVkZ2V0LAogCXJldHVybiBkb25l
OwogfQogCi1zdGF0aWMgaW50IG10a19wb2xsX3R4KHN0cnVjdCBtdGtfZXRoICpldGgsIGludCBi
dWRnZXQpCitzdGF0aWMgaW50IG10a19wb2xsX3R4X3FkbWEoc3RydWN0IG10a19ldGggKmV0aCwg
aW50IGJ1ZGdldCwKKwkJCSAgICB1bnNpZ25lZCBpbnQgKmRvbmUsIHVuc2lnbmVkIGludCAqYnl0
ZXMpCiB7CiAJc3RydWN0IG10a190eF9yaW5nICpyaW5nID0gJmV0aC0+dHhfcmluZzsKIAlzdHJ1
Y3QgbXRrX3R4X2RtYSAqZGVzYzsKIAlzdHJ1Y3Qgc2tfYnVmZiAqc2tiOwogCXN0cnVjdCBtdGtf
dHhfYnVmICp0eF9idWY7Ci0JdW5zaWduZWQgaW50IGRvbmVbTVRLX01BWF9ERVZTXTsKLQl1bnNp
Z25lZCBpbnQgYnl0ZXNbTVRLX01BWF9ERVZTXTsKIAl1MzIgY3B1LCBkbWE7Ci0JaW50IHRvdGFs
ID0gMCwgaTsKLQotCW1lbXNldChkb25lLCAwLCBzaXplb2YoZG9uZSkpOwotCW1lbXNldChieXRl
cywgMCwgc2l6ZW9mKGJ5dGVzKSk7CiAKIAljcHUgPSBtdGtfcjMyKGV0aCwgTVRLX1FUWF9DUlhf
UFRSKTsKIAlkbWEgPSBtdGtfcjMyKGV0aCwgTVRLX1FUWF9EUlhfUFRSKTsKQEAgLTEwODksNiAr
MTE4Niw2MiBAQCBzdGF0aWMgaW50IG10a19wb2xsX3R4KHN0cnVjdCBtdGtfZXRoICpldGgsIGlu
dCBidWRnZXQpCiAKIAltdGtfdzMyKGV0aCwgY3B1LCBNVEtfUVRYX0NSWF9QVFIpOwogCisJcmV0
dXJuIGJ1ZGdldDsKK30KKworc3RhdGljIGludCBtdGtfcG9sbF90eF9wZG1hKHN0cnVjdCBtdGtf
ZXRoICpldGgsIGludCBidWRnZXQsCisJCQkgICAgdW5zaWduZWQgaW50ICpkb25lLCB1bnNpZ25l
ZCBpbnQgKmJ5dGVzKQoreworCXN0cnVjdCBtdGtfdHhfcmluZyAqcmluZyA9ICZldGgtPnR4X3Jp
bmc7CisJc3RydWN0IG10a190eF9kbWEgKmRlc2M7CisJc3RydWN0IHNrX2J1ZmYgKnNrYjsKKwlz
dHJ1Y3QgbXRrX3R4X2J1ZiAqdHhfYnVmOworCXUzMiBjcHUsIGRtYTsKKworCWNwdSA9IHJpbmct
PmNwdV9pZHg7CisJZG1hID0gbXRrX3IzMihldGgsIE1UNzYyOF9UWF9EVFhfSURYMCk7CisKKwl3
aGlsZSAoKGNwdSAhPSBkbWEpICYmIGJ1ZGdldCkgeworCQl0eF9idWYgPSAmcmluZy0+YnVmW2Nw
dV07CisJCXNrYiA9IHR4X2J1Zi0+c2tiOworCQlpZiAoIXNrYikKKwkJCWJyZWFrOworCisJCWlm
IChza2IgIT0gKHN0cnVjdCBza19idWZmICopTVRLX0RNQV9EVU1NWV9ERVNDKSB7CisJCQlieXRl
c1swXSArPSBza2ItPmxlbjsKKwkJCWRvbmVbMF0rKzsKKwkJCWJ1ZGdldC0tOworCQl9CisKKwkJ
bXRrX3R4X3VubWFwKGV0aCwgdHhfYnVmKTsKKworCQlkZXNjID0gJnJpbmctPmRtYVtjcHVdOwor
CQlyaW5nLT5sYXN0X2ZyZWUgPSBkZXNjOworCQlhdG9taWNfaW5jKCZyaW5nLT5mcmVlX2NvdW50
KTsKKworCQljcHUgPSBORVhUX0RFU1BfSURYKGNwdSwgcmluZy0+ZG1hX3NpemUpOworCX0KKwor
CXJpbmctPmNwdV9pZHggPSBjcHU7CisKKwlyZXR1cm4gYnVkZ2V0OworfQorCitzdGF0aWMgaW50
IG10a19wb2xsX3R4KHN0cnVjdCBtdGtfZXRoICpldGgsIGludCBidWRnZXQpCit7CisJc3RydWN0
IG10a190eF9yaW5nICpyaW5nID0gJmV0aC0+dHhfcmluZzsKKwl1bnNpZ25lZCBpbnQgZG9uZVtN
VEtfTUFYX0RFVlNdOworCXVuc2lnbmVkIGludCBieXRlc1tNVEtfTUFYX0RFVlNdOworCWludCB0
b3RhbCA9IDAsIGk7CisKKwltZW1zZXQoZG9uZSwgMCwgc2l6ZW9mKGRvbmUpKTsKKwltZW1zZXQo
Ynl0ZXMsIDAsIHNpemVvZihieXRlcykpOworCisJaWYgKE1US19IQVNfQ0FQUyhldGgtPnNvYy0+
Y2FwcywgTVRLX1NPQ19NVDc2MjgpKQorCQlidWRnZXQgPSBtdGtfcG9sbF90eF9wZG1hKGV0aCwg
YnVkZ2V0LCBkb25lLCBieXRlcyk7CisJZWxzZQorCQlidWRnZXQgPSBtdGtfcG9sbF90eF9xZG1h
KGV0aCwgYnVkZ2V0LCBkb25lLCBieXRlcyk7CisKIAlmb3IgKGkgPSAwOyBpIDwgTVRLX01BQ19D
T1VOVDsgaSsrKSB7CiAJCWlmICghZXRoLT5uZXRkZXZbaV0gfHwgIWRvbmVbaV0pCiAJCQljb250
aW51ZTsKQEAgLTExMjAsOCArMTI3MywxMiBAQCBzdGF0aWMgaW50IG10a19uYXBpX3R4KHN0cnVj
dCBuYXBpX3N0cnVjdCAqbmFwaSwgaW50IGJ1ZGdldCkKIAl1MzIgc3RhdHVzLCBtYXNrOwogCWlu
dCB0eF9kb25lID0gMDsKIAotCW10a19oYW5kbGVfc3RhdHVzX2lycShldGgpOwotCW10a193MzIo
ZXRoLCBNVEtfVFhfRE9ORV9JTlQsIE1US19RTVRLX0lOVF9TVEFUVVMpOworCWlmIChNVEtfSEFT
X0NBUFMoZXRoLT5zb2MtPmNhcHMsIE1US19TT0NfTVQ3NjI4KSkgeworCQltdGtfdzMyKGV0aCwg
TVRLX1RYX0RPTkVfSU5ULCBNVEtfUERNQV9JTlRfU1RBVFVTKTsKKwl9IGVsc2UgeworCQltdGtf
aGFuZGxlX3N0YXR1c19pcnEoZXRoKTsKKwkJbXRrX3czMihldGgsIE1US19UWF9ET05FX0lOVCwg
TVRLX1FNVEtfSU5UX1NUQVRVUyk7CisJfQogCXR4X2RvbmUgPSBtdGtfcG9sbF90eChldGgsIGJ1
ZGdldCk7CiAKIAlpZiAodW5saWtlbHkobmV0aWZfbXNnX2ludHIoZXRoKSkpIHsKQEAgLTExMzUs
NyArMTI5MiwxMCBAQCBzdGF0aWMgaW50IG10a19uYXBpX3R4KHN0cnVjdCBuYXBpX3N0cnVjdCAq
bmFwaSwgaW50IGJ1ZGdldCkKIAlpZiAodHhfZG9uZSA9PSBidWRnZXQpCiAJCXJldHVybiBidWRn
ZXQ7CiAKLQlzdGF0dXMgPSBtdGtfcjMyKGV0aCwgTVRLX1FNVEtfSU5UX1NUQVRVUyk7CisJaWYg
KE1US19IQVNfQ0FQUyhldGgtPnNvYy0+Y2FwcywgTVRLX1NPQ19NVDc2MjgpKQorCQlzdGF0dXMg
PSBtdGtfcjMyKGV0aCwgTVRLX1BETUFfSU5UX1NUQVRVUyk7CisJZWxzZQorCQlzdGF0dXMgPSBt
dGtfcjMyKGV0aCwgTVRLX1FNVEtfSU5UX1NUQVRVUyk7CiAJaWYgKHN0YXR1cyAmIE1US19UWF9E
T05FX0lOVCkKIAkJcmV0dXJuIGJ1ZGdldDsKIApAQCAtMTIwMiw2ICsxMzYyLDI0IEBAIHN0YXRp
YyBpbnQgbXRrX3R4X2FsbG9jKHN0cnVjdCBtdGtfZXRoICpldGgpCiAJCXJpbmctPmRtYVtpXS50
eGQzID0gVFhfRE1BX0xTMCB8IFRYX0RNQV9PV05FUl9DUFU7CiAJfQogCisJLyogT24gTVQ3Njg4
IChQRE1BIG9ubHkpIHRoaXMgZHJpdmVyIHVzZXMgdGhlIHJpbmctPmRtYSBzdHJ1Y3RzCisJICog
b25seSBhcyB0aGUgZnJhbWV3b3JrLiBUaGUgcmVhbCBIVyBkZXNjcmlwdG9ycyBhcmUgdGhlIFBE
TUEKKwkgKiBkZXNjcmlwdG9ycyBpbiByaW5nLT5kbWFfcGRtYS4KKwkgKi8KKwlpZiAoTVRLX0hB
U19DQVBTKGV0aC0+c29jLT5jYXBzLCBNVEtfU09DX01UNzYyOCkpIHsKKwkJcmluZy0+ZG1hX3Bk
bWEgPSBkbWFfYWxsb2NfY29oZXJlbnQoZXRoLT5kZXYsIE1US19ETUFfU0laRSAqIHN6LAorCQkJ
CQkJICAgICZyaW5nLT5waHlzX3BkbWEsCisJCQkJCQkgICAgR0ZQX0FUT01JQyk7CisJCWlmICgh
cmluZy0+ZG1hX3BkbWEpCisJCQlnb3RvIG5vX3R4X21lbTsKKworCQlmb3IgKGkgPSAwOyBpIDwg
TVRLX0RNQV9TSVpFOyBpKyspIHsKKwkJCXJpbmctPmRtYV9wZG1hW2ldLnR4ZDIgPSBUWF9ETUFf
REVTUDJfREVGOworCQkJcmluZy0+ZG1hX3BkbWFbaV0udHhkNCA9IDA7CisJCX0KKwl9CisKKwly
aW5nLT5kbWFfc2l6ZSA9IE1US19ETUFfU0laRTsKIAlhdG9taWNfc2V0KCZyaW5nLT5mcmVlX2Nv
dW50LCBNVEtfRE1BX1NJWkUgLSAyKTsKIAlyaW5nLT5uZXh0X2ZyZWUgPSAmcmluZy0+ZG1hWzBd
OwogCXJpbmctPmxhc3RfZnJlZSA9ICZyaW5nLT5kbWFbTVRLX0RNQV9TSVpFIC0gMV07CkBAIC0x
MjEyLDE1ICsxMzkwLDIzIEBAIHN0YXRpYyBpbnQgbXRrX3R4X2FsbG9jKHN0cnVjdCBtdGtfZXRo
ICpldGgpCiAJICovCiAJd21iKCk7CiAKLQltdGtfdzMyKGV0aCwgcmluZy0+cGh5cywgTVRLX1FU
WF9DVFhfUFRSKTsKLQltdGtfdzMyKGV0aCwgcmluZy0+cGh5cywgTVRLX1FUWF9EVFhfUFRSKTsK
LQltdGtfdzMyKGV0aCwKLQkJcmluZy0+cGh5cyArICgoTVRLX0RNQV9TSVpFIC0gMSkgKiBzeiks
Ci0JCU1US19RVFhfQ1JYX1BUUik7Ci0JbXRrX3czMihldGgsCi0JCXJpbmctPnBoeXMgKyAoKE1U
S19ETUFfU0laRSAtIDEpICogc3opLAotCQlNVEtfUVRYX0RSWF9QVFIpOwotCW10a193MzIoZXRo
LCAoUURNQV9SRVNfVEhSRVMgPDwgOCkgfCBRRE1BX1JFU19USFJFUywgTVRLX1FUWF9DRkcoMCkp
OworCWlmIChNVEtfSEFTX0NBUFMoZXRoLT5zb2MtPmNhcHMsIE1US19TT0NfTVQ3NjI4KSkgewor
CQltdGtfdzMyKGV0aCwgcmluZy0+cGh5c19wZG1hLCBNVDc2MjhfVFhfQkFTRV9QVFIwKTsKKwkJ
bXRrX3czMihldGgsIE1US19ETUFfU0laRSwgTVQ3NjI4X1RYX01BWF9DTlQwKTsKKwkJbXRrX3cz
MihldGgsIDAsIE1UNzYyOF9UWF9DVFhfSURYMCk7CisJCW10a193MzIoZXRoLCBNVDc2MjhfUFNU
X0RUWF9JRFgwLCBNVEtfUERNQV9SU1RfSURYKTsKKwl9IGVsc2UgeworCQltdGtfdzMyKGV0aCwg
cmluZy0+cGh5cywgTVRLX1FUWF9DVFhfUFRSKTsKKwkJbXRrX3czMihldGgsIHJpbmctPnBoeXMs
IE1US19RVFhfRFRYX1BUUik7CisJCW10a193MzIoZXRoLAorCQkJcmluZy0+cGh5cyArICgoTVRL
X0RNQV9TSVpFIC0gMSkgKiBzeiksCisJCQlNVEtfUVRYX0NSWF9QVFIpOworCQltdGtfdzMyKGV0
aCwKKwkJCXJpbmctPnBoeXMgKyAoKE1US19ETUFfU0laRSAtIDEpICogc3opLAorCQkJTVRLX1FU
WF9EUlhfUFRSKTsKKwkJbXRrX3czMihldGgsIChRRE1BX1JFU19USFJFUyA8PCA4KSB8IFFETUFf
UkVTX1RIUkVTLAorCQkJTVRLX1FUWF9DRkcoMCkpOworCX0KIAogCXJldHVybiAwOwogCkBAIC0x
MjQ3LDYgKzE0MzMsMTQgQEAgc3RhdGljIHZvaWQgbXRrX3R4X2NsZWFuKHN0cnVjdCBtdGtfZXRo
ICpldGgpCiAJCQkJICByaW5nLT5waHlzKTsKIAkJcmluZy0+ZG1hID0gTlVMTDsKIAl9CisKKwlp
ZiAocmluZy0+ZG1hX3BkbWEpIHsKKwkJZG1hX2ZyZWVfY29oZXJlbnQoZXRoLT5kZXYsCisJCQkJ
ICBNVEtfRE1BX1NJWkUgKiBzaXplb2YoKnJpbmctPmRtYV9wZG1hKSwKKwkJCQkgIHJpbmctPmRt
YV9wZG1hLAorCQkJCSAgcmluZy0+cGh5c19wZG1hKTsKKwkJcmluZy0+ZG1hX3BkbWEgPSBOVUxM
OworCX0KIH0KIAogc3RhdGljIGludCBtdGtfcnhfYWxsb2Moc3RydWN0IG10a19ldGggKmV0aCwg
aW50IHJpbmdfbm8sIGludCByeF9mbGFnKQpAQCAtMTI5NCwxNCArMTQ4OCwxNyBAQCBzdGF0aWMg
aW50IG10a19yeF9hbGxvYyhzdHJ1Y3QgbXRrX2V0aCAqZXRoLCBpbnQgcmluZ19ubywgaW50IHJ4
X2ZsYWcpCiAKIAlmb3IgKGkgPSAwOyBpIDwgcnhfZG1hX3NpemU7IGkrKykgewogCQlkbWFfYWRk
cl90IGRtYV9hZGRyID0gZG1hX21hcF9zaW5nbGUoZXRoLT5kZXYsCi0JCQkJcmluZy0+ZGF0YVtp
XSArIE5FVF9TS0JfUEFELAorCQkJCXJpbmctPmRhdGFbaV0gKyBORVRfU0tCX1BBRCArIGV0aC0+
aXBfYWxpZ24sCiAJCQkJcmluZy0+YnVmX3NpemUsCiAJCQkJRE1BX0ZST01fREVWSUNFKTsKIAkJ
aWYgKHVubGlrZWx5KGRtYV9tYXBwaW5nX2Vycm9yKGV0aC0+ZGV2LCBkbWFfYWRkcikpKQogCQkJ
cmV0dXJuIC1FTk9NRU07CiAJCXJpbmctPmRtYVtpXS5yeGQxID0gKHVuc2lnbmVkIGludClkbWFf
YWRkcjsKIAotCQlyaW5nLT5kbWFbaV0ucnhkMiA9IFJYX0RNQV9QTEVOMChyaW5nLT5idWZfc2l6
ZSk7CisJCWlmIChNVEtfSEFTX0NBUFMoZXRoLT5zb2MtPmNhcHMsIE1US19TT0NfTVQ3NjI4KSkK
KwkJCXJpbmctPmRtYVtpXS5yeGQyID0gUlhfRE1BX0xTTzsKKwkJZWxzZQorCQkJcmluZy0+ZG1h
W2ldLnJ4ZDIgPSBSWF9ETUFfUExFTjAocmluZy0+YnVmX3NpemUpOwogCX0KIAlyaW5nLT5kbWFf
c2l6ZSA9IHJ4X2RtYV9zaXplOwogCXJpbmctPmNhbGNfaWR4X3VwZGF0ZSA9IGZhbHNlOwpAQCAt
MTYxNyw5ICsxODE0LDE2IEBAIHN0YXRpYyBpbnQgbXRrX2RtYV9idXN5X3dhaXQoc3RydWN0IG10
a19ldGggKmV0aCkKIAl1bnNpZ25lZCBsb25nIHRfc3RhcnQgPSBqaWZmaWVzOwogCiAJd2hpbGUg
KDEpIHsKLQkJaWYgKCEobXRrX3IzMihldGgsIE1US19RRE1BX0dMT19DRkcpICYKLQkJICAgICAg
KE1US19SWF9ETUFfQlVTWSB8IE1US19UWF9ETUFfQlVTWSkpKQotCQkJcmV0dXJuIDA7CisJCWlm
IChNVEtfSEFTX0NBUFMoZXRoLT5zb2MtPmNhcHMsIE1US19TT0NfTVQ3NjI4KSkgeworCQkJaWYg
KCEobXRrX3IzMihldGgsIE1US19QRE1BX0dMT19DRkcpICYKKwkJCSAgICAgIChNVEtfUlhfRE1B
X0JVU1kgfCBNVEtfVFhfRE1BX0JVU1kpKSkKKwkJCQlyZXR1cm4gMDsKKwkJfSBlbHNlIHsKKwkJ
CWlmICghKG10a19yMzIoZXRoLCBNVEtfUURNQV9HTE9fQ0ZHKSAmCisJCQkgICAgICAoTVRLX1JY
X0RNQV9CVVNZIHwgTVRLX1RYX0RNQV9CVVNZKSkpCisJCQkJcmV0dXJuIDA7CisJCX0KKwogCQlp
ZiAodGltZV9hZnRlcihqaWZmaWVzLCB0X3N0YXJ0ICsgTVRLX0RNQV9CVVNZX1RJTUVPVVQpKQog
CQkJYnJlYWs7CiAJfQpAQCAtMTYzNiwyMCArMTg0MCwyNCBAQCBzdGF0aWMgaW50IG10a19kbWFf
aW5pdChzdHJ1Y3QgbXRrX2V0aCAqZXRoKQogCWlmIChtdGtfZG1hX2J1c3lfd2FpdChldGgpKQog
CQlyZXR1cm4gLUVCVVNZOwogCi0JLyogUURNQSBuZWVkcyBzY3JhdGNoIG1lbW9yeSBmb3IgaW50
ZXJuYWwgcmVvcmRlcmluZyBvZiB0aGUKLQkgKiBkZXNjcmlwdG9ycwotCSAqLwotCWVyciA9IG10
a19pbml0X2ZxX2RtYShldGgpOwotCWlmIChlcnIpCi0JCXJldHVybiBlcnI7CisJaWYgKCFNVEtf
SEFTX0NBUFMoZXRoLT5zb2MtPmNhcHMsIE1US19TT0NfTVQ3NjI4KSkgeworCQkvKiBRRE1BIG5l
ZWRzIHNjcmF0Y2ggbWVtb3J5IGZvciBpbnRlcm5hbCByZW9yZGVyaW5nIG9mIHRoZQorCQkgKiBk
ZXNjcmlwdG9ycworCQkgKi8KKwkJZXJyID0gbXRrX2luaXRfZnFfZG1hKGV0aCk7CisJCWlmIChl
cnIpCisJCQlyZXR1cm4gZXJyOworCX0KIAogCWVyciA9IG10a190eF9hbGxvYyhldGgpOwogCWlm
IChlcnIpCiAJCXJldHVybiBlcnI7CiAKLQllcnIgPSBtdGtfcnhfYWxsb2MoZXRoLCAwLCBNVEtf
UlhfRkxBR1NfUURNQSk7Ci0JaWYgKGVycikKLQkJcmV0dXJuIGVycjsKKwlpZiAoIU1US19IQVNf
Q0FQUyhldGgtPnNvYy0+Y2FwcywgTVRLX1NPQ19NVDc2MjgpKSB7CisJCWVyciA9IG10a19yeF9h
bGxvYyhldGgsIDAsIE1US19SWF9GTEFHU19RRE1BKTsKKwkJaWYgKGVycikKKwkJCXJldHVybiBl
cnI7CisJfQogCiAJZXJyID0gbXRrX3J4X2FsbG9jKGV0aCwgMCwgTVRLX1JYX0ZMQUdTX05PUk1B
TCk7CiAJaWYgKGVycikKQEAgLTE2NjYsMTAgKzE4NzQsMTQgQEAgc3RhdGljIGludCBtdGtfZG1h
X2luaXQoc3RydWN0IG10a19ldGggKmV0aCkKIAkJCXJldHVybiBlcnI7CiAJfQogCi0JLyogRW5h
YmxlIHJhbmRvbSBlYXJseSBkcm9wIGFuZCBzZXQgZHJvcCB0aHJlc2hvbGQgYXV0b21hdGljYWxs
eSAqLwotCW10a193MzIoZXRoLCBGQ19USFJFU19EUk9QX01PREUgfCBGQ19USFJFU19EUk9QX0VO
IHwgRkNfVEhSRVNfTUlOLAotCQlNVEtfUURNQV9GQ19USFJFUyk7Ci0JbXRrX3czMihldGgsIDB4
MCwgTVRLX1FETUFfSFJFRDIpOworCWlmICghTVRLX0hBU19DQVBTKGV0aC0+c29jLT5jYXBzLCBN
VEtfU09DX01UNzYyOCkpIHsKKwkJLyogRW5hYmxlIHJhbmRvbSBlYXJseSBkcm9wIGFuZCBzZXQg
ZHJvcCB0aHJlc2hvbGQKKwkJICogYXV0b21hdGljYWxseQorCQkgKi8KKwkJbXRrX3czMihldGgs
IEZDX1RIUkVTX0RST1BfTU9ERSB8IEZDX1RIUkVTX0RST1BfRU4gfAorCQkJRkNfVEhSRVNfTUlO
LCBNVEtfUURNQV9GQ19USFJFUyk7CisJCW10a193MzIoZXRoLCAweDAsIE1US19RRE1BX0hSRUQy
KTsKKwl9CiAKIAlyZXR1cm4gMDsKIH0KQEAgLTE3NDAsMTQgKzE5NTIsMjMgQEAgc3RhdGljIGly
cXJldHVybl90IG10a19oYW5kbGVfaXJxX3R4KGludCBpcnEsIHZvaWQgKl9ldGgpCiBzdGF0aWMg
aXJxcmV0dXJuX3QgbXRrX2hhbmRsZV9pcnEoaW50IGlycSwgdm9pZCAqX2V0aCkKIHsKIAlzdHJ1
Y3QgbXRrX2V0aCAqZXRoID0gX2V0aDsKKwl1MzIgc3RhdHVzOwogCisJc3RhdHVzID0gbXRrX3Iz
MihldGgsIE1US19QRE1BX0lOVF9TVEFUVVMpOwogCWlmIChtdGtfcjMyKGV0aCwgTVRLX1BETUFf
SU5UX01BU0spICYgTVRLX1JYX0RPTkVfSU5UKSB7CiAJCWlmIChtdGtfcjMyKGV0aCwgTVRLX1BE
TUFfSU5UX1NUQVRVUykgJiBNVEtfUlhfRE9ORV9JTlQpCiAJCQltdGtfaGFuZGxlX2lycV9yeChp
cnEsIF9ldGgpOwogCX0KLQlpZiAobXRrX3IzMihldGgsIE1US19RRE1BX0lOVF9NQVNLKSAmIE1U
S19UWF9ET05FX0lOVCkgewotCQlpZiAobXRrX3IzMihldGgsIE1US19RTVRLX0lOVF9TVEFUVVMp
ICYgTVRLX1RYX0RPTkVfSU5UKQotCQkJbXRrX2hhbmRsZV9pcnFfdHgoaXJxLCBfZXRoKTsKKwlp
ZiAoTVRLX0hBU19DQVBTKGV0aC0+c29jLT5jYXBzLCBNVEtfU09DX01UNzYyOCkpIHsKKwkJaWYg
KG10a19yMzIoZXRoLCBNVEtfUERNQV9JTlRfTUFTSykgJiBNVEtfVFhfRE9ORV9JTlQpIHsKKwkJ
CWlmIChtdGtfcjMyKGV0aCwgTVRLX1BETUFfSU5UX1NUQVRVUykgJiBNVEtfVFhfRE9ORV9JTlQp
CisJCQkJbXRrX2hhbmRsZV9pcnFfdHgoaXJxLCBfZXRoKTsKKwkJfQorCX0gZWxzZSB7CisJCWlm
IChtdGtfcjMyKGV0aCwgTVRLX1FETUFfSU5UX01BU0spICYgTVRLX1RYX0RPTkVfSU5UKSB7CisJ
CQlpZiAobXRrX3IzMihldGgsIE1US19RTVRLX0lOVF9TVEFUVVMpICYgTVRLX1RYX0RPTkVfSU5U
KQorCQkJCW10a19oYW5kbGVfaXJxX3R4KGlycSwgX2V0aCk7CisJCX0KIAl9CiAKIAlyZXR1cm4g
SVJRX0hBTkRMRUQ7CkBAIC0xNzc4LDE3ICsxOTk5LDIzIEBAIHN0YXRpYyBpbnQgbXRrX3N0YXJ0
X2RtYShzdHJ1Y3QgbXRrX2V0aCAqZXRoKQogCQlyZXR1cm4gZXJyOwogCX0KIAotCW10a193MzIo
ZXRoLAotCQlNVEtfVFhfV0JfRERPTkUgfCBNVEtfVFhfRE1BX0VOIHwKLQkJTVRLX0RNQV9TSVpF
XzE2RFdPUkRTIHwgTVRLX05EUF9DT19QUk8gfAotCQlNVEtfUlhfRE1BX0VOIHwgTVRLX1JYXzJC
X09GRlNFVCB8Ci0JCU1US19SWF9CVF8zMkRXT1JEUywKLQkJTVRLX1FETUFfR0xPX0NGRyk7CisJ
aWYgKCFNVEtfSEFTX0NBUFMoZXRoLT5zb2MtPmNhcHMsIE1US19TT0NfTVQ3NjI4KSkgeworCQlt
dGtfdzMyKGV0aCwKKwkJCU1US19UWF9XQl9ERE9ORSB8IE1US19UWF9ETUFfRU4gfAorCQkJTVRL
X0RNQV9TSVpFXzE2RFdPUkRTIHwgTVRLX05EUF9DT19QUk8gfAorCQkJTVRLX1JYX0RNQV9FTiB8
IE1US19SWF8yQl9PRkZTRVQgfAorCQkJTVRLX1JYX0JUXzMyRFdPUkRTLAorCQkJTVRLX1FETUFf
R0xPX0NGRyk7CiAKLQltdGtfdzMyKGV0aCwKLQkJTVRLX1JYX0RNQV9FTiB8IHJ4XzJiX29mZnNl
dCB8Ci0JCU1US19SWF9CVF8zMkRXT1JEUyB8IE1US19NVUxUSV9FTiwKLQkJTVRLX1BETUFfR0xP
X0NGRyk7CisJCW10a193MzIoZXRoLAorCQkJTVRLX1JYX0RNQV9FTiB8IHJ4XzJiX29mZnNldCB8
CisJCQlNVEtfUlhfQlRfMzJEV09SRFMgfCBNVEtfTVVMVElfRU4sCisJCQlNVEtfUERNQV9HTE9f
Q0ZHKTsKKwl9IGVsc2UgeworCQltdGtfdzMyKGV0aCwgTVRLX1RYX1dCX0RET05FIHwgTVRLX1RY
X0RNQV9FTiB8IE1US19SWF9ETUFfRU4gfAorCQkJTVRLX01VTFRJX0VOIHwgTVRLX1BETUFfU0la
RV84RFdPUkRTLAorCQkJTVRLX1BETUFfR0xPX0NGRyk7CisJfQogCiAJcmV0dXJuIDA7CiB9CkBA
IC0xODE2LDcgKzIwNDMsNiBAQCBzdGF0aWMgaW50IG10a19vcGVuKHN0cnVjdCBuZXRfZGV2aWNl
ICpkZXYpCiAKIAlwaHlfc3RhcnQoZGV2LT5waHlkZXYpOwogCW5ldGlmX3N0YXJ0X3F1ZXVlKGRl
dik7Ci0KIAlyZXR1cm4gMDsKIH0KIApAQCAtMTg2MCw3ICsyMDg2LDggQEAgc3RhdGljIGludCBt
dGtfc3RvcChzdHJ1Y3QgbmV0X2RldmljZSAqZGV2KQogCW5hcGlfZGlzYWJsZSgmZXRoLT50eF9u
YXBpKTsKIAluYXBpX2Rpc2FibGUoJmV0aC0+cnhfbmFwaSk7CiAKLQltdGtfc3RvcF9kbWEoZXRo
LCBNVEtfUURNQV9HTE9fQ0ZHKTsKKwlpZiAoIU1US19IQVNfQ0FQUyhldGgtPnNvYy0+Y2Fwcywg
TVRLX1NPQ19NVDc2MjgpKQorCQltdGtfc3RvcF9kbWEoZXRoLCBNVEtfUURNQV9HTE9fQ0ZHKTsK
IAltdGtfc3RvcF9kbWEoZXRoLCBNVEtfUERNQV9HTE9fQ0ZHKTsKIAogCW10a19kbWFfZnJlZShl
dGgpOwpAQCAtMTkyMiw2ICsyMTQ5LDI0IEBAIHN0YXRpYyBpbnQgbXRrX2h3X2luaXQoc3RydWN0
IG10a19ldGggKmV0aCkKIAlpZiAocmV0KQogCQlnb3RvIGVycl9kaXNhYmxlX3BtOwogCisJaWYg
KE1US19IQVNfQ0FQUyhldGgtPnNvYy0+Y2FwcywgTVRLX1NPQ19NVDc2MjgpKSB7CisJCXJldCA9
IGRldmljZV9yZXNldChldGgtPmRldik7CisJCWlmIChyZXQpIHsKKwkJCWRldl9lcnIoZXRoLT5k
ZXYsICJNQUMgcmVzZXQgZmFpbGVkIVxuIik7CisJCQlnb3RvIGVycl9kaXNhYmxlX3BtOworCQl9
CisKKwkJLyogZW5hYmxlIGludGVycnVwdCBkZWxheSBmb3IgUlggKi8KKwkJbXRrX3czMihldGgs
IE1US19QRE1BX0RFTEFZX1JYX0RFTEFZLCBNVEtfUERNQV9ERUxBWV9JTlQpOworCisJCS8qIGRp
c2FibGUgZGVsYXkgYW5kIG5vcm1hbCBpbnRlcnJ1cHQgKi8KKwkJbXRrX3R4X2lycV9kaXNhYmxl
KGV0aCwgfjApOworCQltdGtfcnhfaXJxX2Rpc2FibGUoZXRoLCB+MCk7CisKKwkJcmV0dXJuIDA7
CisJfQorCisJLyogTm9uLU1UNzYyOCBoYW5kbGluZy4uLiAqLwogCWV0aHN5c19yZXNldChldGgs
IFJTVENUUkxfRkUpOwogCWV0aHN5c19yZXNldChldGgsIFJTVENUUkxfUFBFKTsKIApAQCAtMjQy
NSwxMyArMjY3MCwxMyBAQCBzdGF0aWMgaW50IG10a19hZGRfbWFjKHN0cnVjdCBtdGtfZXRoICpl
dGgsIHN0cnVjdCBkZXZpY2Vfbm9kZSAqbnApCiAJZXRoLT5uZXRkZXZbaWRdLT5uZXRkZXZfb3Bz
ID0gJm10a19uZXRkZXZfb3BzOwogCWV0aC0+bmV0ZGV2W2lkXS0+YmFzZV9hZGRyID0gKHVuc2ln
bmVkIGxvbmcpZXRoLT5iYXNlOwogCi0JZXRoLT5uZXRkZXZbaWRdLT5od19mZWF0dXJlcyA9IE1U
S19IV19GRUFUVVJFUzsKKwlldGgtPm5ldGRldltpZF0tPmh3X2ZlYXR1cmVzID0gZXRoLT5zb2Mt
Pmh3X2ZlYXR1cmVzOwogCWlmIChldGgtPmh3bHJvKQogCQlldGgtPm5ldGRldltpZF0tPmh3X2Zl
YXR1cmVzIHw9IE5FVElGX0ZfTFJPOwogCi0JZXRoLT5uZXRkZXZbaWRdLT52bGFuX2ZlYXR1cmVz
ID0gTVRLX0hXX0ZFQVRVUkVTICYKKwlldGgtPm5ldGRldltpZF0tPnZsYW5fZmVhdHVyZXMgPSBl
dGgtPnNvYy0+aHdfZmVhdHVyZXMgJgogCQl+KE5FVElGX0ZfSFdfVkxBTl9DVEFHX1RYIHwgTkVU
SUZfRl9IV19WTEFOX0NUQUdfUlgpOwotCWV0aC0+bmV0ZGV2W2lkXS0+ZmVhdHVyZXMgfD0gTVRL
X0hXX0ZFQVRVUkVTOworCWV0aC0+bmV0ZGV2W2lkXS0+ZmVhdHVyZXMgfD0gZXRoLT5zb2MtPmh3
X2ZlYXR1cmVzOwogCWV0aC0+bmV0ZGV2W2lkXS0+ZXRodG9vbF9vcHMgPSAmbXRrX2V0aHRvb2xf
b3BzOwogCiAJZXRoLT5uZXRkZXZbaWRdLT5pcnEgPSBldGgtPmlycVswXTsKQEAgLTI0NjMsMTUg
KzI3MDgsMjYgQEAgc3RhdGljIGludCBtdGtfcHJvYmUoc3RydWN0IHBsYXRmb3JtX2RldmljZSAq
cGRldikKIAlpZiAoSVNfRVJSKGV0aC0+YmFzZSkpCiAJCXJldHVybiBQVFJfRVJSKGV0aC0+YmFz
ZSk7CiAKKwlpZiAoTVRLX0hBU19DQVBTKGV0aC0+c29jLT5jYXBzLCBNVEtfU09DX01UNzYyOCkp
IHsKKwkJZXRoLT50eF9pbnRfbWFza19yZWcgPSBNVEtfUERNQV9JTlRfTUFTSzsKKwkJZXRoLT5y
eF9kbWFfbDRfdmFsaWQgPSBSWF9ETUFfTDRfVkFMSURfUERNQTsKKwkJZXRoLT5pcF9hbGlnbiA9
IE5FVF9JUF9BTElHTjsKKwl9IGVsc2UgeworCQlldGgtPnR4X2ludF9tYXNrX3JlZyA9IE1US19R
RE1BX0lOVF9NQVNLOworCQlldGgtPnJ4X2RtYV9sNF92YWxpZCA9IFJYX0RNQV9MNF9WQUxJRDsK
Kwl9CisKIAlzcGluX2xvY2tfaW5pdCgmZXRoLT5wYWdlX2xvY2spOwogCXNwaW5fbG9ja19pbml0
KCZldGgtPnR4X2lycV9sb2NrKTsKIAlzcGluX2xvY2tfaW5pdCgmZXRoLT5yeF9pcnFfbG9jayk7
CiAKLQlldGgtPmV0aHN5cyA9IHN5c2Nvbl9yZWdtYXBfbG9va3VwX2J5X3BoYW5kbGUocGRldi0+
ZGV2Lm9mX25vZGUsCi0JCQkJCQkgICAgICAibWVkaWF0ZWssZXRoc3lzIik7Ci0JaWYgKElTX0VS
UihldGgtPmV0aHN5cykpIHsKLQkJZGV2X2VycigmcGRldi0+ZGV2LCAibm8gZXRoc3lzIHJlZ21h
cCBmb3VuZFxuIik7Ci0JCXJldHVybiBQVFJfRVJSKGV0aC0+ZXRoc3lzKTsKKwlpZiAoIU1US19I
QVNfQ0FQUyhldGgtPnNvYy0+Y2FwcywgTVRLX1NPQ19NVDc2MjgpKSB7CisJCWV0aC0+ZXRoc3lz
ID0gc3lzY29uX3JlZ21hcF9sb29rdXBfYnlfcGhhbmRsZShwZGV2LT5kZXYub2Zfbm9kZSwKKwkJ
CQkJCQkgICAgICAibWVkaWF0ZWssZXRoc3lzIik7CisJCWlmIChJU19FUlIoZXRoLT5ldGhzeXMp
KSB7CisJCQlkZXZfZXJyKCZwZGV2LT5kZXYsICJubyBldGhzeXMgcmVnbWFwIGZvdW5kXG4iKTsK
KwkJCXJldHVybiBQVFJfRVJSKGV0aC0+ZXRoc3lzKTsKKwkJfQogCX0KIAogCWlmIChNVEtfSEFT
X0NBUFMoZXRoLT5zb2MtPmNhcHMsIE1US19JTkZSQSkpIHsKQEAgLTI1NzAsOSArMjgyNiwxMiBA
QCBzdGF0aWMgaW50IG10a19wcm9iZShzdHJ1Y3QgcGxhdGZvcm1fZGV2aWNlICpwZGV2KQogCWlm
IChlcnIpCiAJCWdvdG8gZXJyX2ZyZWVfZGV2OwogCi0JZXJyID0gbXRrX21kaW9faW5pdChldGgp
OwotCWlmIChlcnIpCi0JCWdvdG8gZXJyX2ZyZWVfZGV2OworCS8qIE5vIE1UNzYyOC84OCBzdXBw
b3J0IHlldCAqLworCWlmICghTVRLX0hBU19DQVBTKGV0aC0+c29jLT5jYXBzLCBNVEtfU09DX01U
NzYyOCkpIHsKKwkJZXJyID0gbXRrX21kaW9faW5pdChldGgpOworCQlpZiAoZXJyKQorCQkJZ290
byBlcnJfZnJlZV9kZXY7CisJfQogCiAJZm9yIChpID0gMDsgaSA8IE1US19NQVhfREVWUzsgaSsr
KSB7CiAJCWlmICghZXRoLT5uZXRkZXZbaV0pCkBAIC0yNjM1LDEyICsyODk0LDE0IEBAIHN0YXRp
YyBpbnQgbXRrX3JlbW92ZShzdHJ1Y3QgcGxhdGZvcm1fZGV2aWNlICpwZGV2KQogCiBzdGF0aWMg
Y29uc3Qgc3RydWN0IG10a19zb2NfZGF0YSBtdDI3MDFfZGF0YSA9IHsKIAkuY2FwcyA9IE1UNzYy
M19DQVBTIHwgTVRLX0hXTFJPLAorCS5od19mZWF0dXJlcyA9IE1US19IV19GRUFUVVJFUywKIAku
cmVxdWlyZWRfY2xrcyA9IE1UNzYyM19DTEtTX0JJVE1BUCwKIAkucmVxdWlyZWRfcGN0bCA9IHRy
dWUsCiB9OwogCiBzdGF0aWMgY29uc3Qgc3RydWN0IG10a19zb2NfZGF0YSBtdDc2MjFfZGF0YSA9
IHsKIAkuY2FwcyA9IE1UNzYyMV9DQVBTLAorCS5od19mZWF0dXJlcyA9IE1US19IV19GRUFUVVJF
UywKIAkucmVxdWlyZWRfY2xrcyA9IE1UNzYyMV9DTEtTX0JJVE1BUCwKIAkucmVxdWlyZWRfcGN0
bCA9IGZhbHNlLAogfTsKQEAgLTI2NDgsMTkgKzI5MDksMjkgQEAgc3RhdGljIGNvbnN0IHN0cnVj
dCBtdGtfc29jX2RhdGEgbXQ3NjIxX2RhdGEgPSB7CiBzdGF0aWMgY29uc3Qgc3RydWN0IG10a19z
b2NfZGF0YSBtdDc2MjJfZGF0YSA9IHsKIAkuYW5hX3JnYzMgPSAweDIwMjgsCiAJLmNhcHMgPSBN
VDc2MjJfQ0FQUyB8IE1US19IV0xSTywKKwkuaHdfZmVhdHVyZXMgPSBNVEtfSFdfRkVBVFVSRVMs
CiAJLnJlcXVpcmVkX2Nsa3MgPSBNVDc2MjJfQ0xLU19CSVRNQVAsCiAJLnJlcXVpcmVkX3BjdGwg
PSBmYWxzZSwKIH07CiAKIHN0YXRpYyBjb25zdCBzdHJ1Y3QgbXRrX3NvY19kYXRhIG10NzYyM19k
YXRhID0gewogCS5jYXBzID0gTVQ3NjIzX0NBUFMgfCBNVEtfSFdMUk8sCisJLmh3X2ZlYXR1cmVz
ID0gTVRLX0hXX0ZFQVRVUkVTLAogCS5yZXF1aXJlZF9jbGtzID0gTVQ3NjIzX0NMS1NfQklUTUFQ
LAogCS5yZXF1aXJlZF9wY3RsID0gdHJ1ZSwKIH07CiAKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgbXRr
X3NvY19kYXRhIG10NzYyOF9kYXRhID0geworCS5jYXBzID0gTVQ3NjI4X0NBUFMsCisJLmh3X2Zl
YXR1cmVzID0gTVRLX0hXX0ZFQVRVUkVTX01UNzYyOCwKKwkucmVxdWlyZWRfY2xrcyA9IE1UNzYy
OF9DTEtTX0JJVE1BUCwKKwkucmVxdWlyZWRfcGN0bCA9IGZhbHNlLAorfTsKKwogc3RhdGljIGNv
bnN0IHN0cnVjdCBtdGtfc29jX2RhdGEgbXQ3NjI5X2RhdGEgPSB7CiAJLmFuYV9yZ2MzID0gMHgx
MjgsCiAJLmNhcHMgPSBNVDc2MjlfQ0FQUyB8IE1US19IV0xSTywKKwkuaHdfZmVhdHVyZXMgPSBN
VEtfSFdfRkVBVFVSRVMsCiAJLnJlcXVpcmVkX2Nsa3MgPSBNVDc2MjlfQ0xLU19CSVRNQVAsCiAJ
LnJlcXVpcmVkX3BjdGwgPSBmYWxzZSwKIH07CkBAIC0yNjcwLDYgKzI5NDEsNyBAQCBjb25zdCBz
dHJ1Y3Qgb2ZfZGV2aWNlX2lkIG9mX210a19tYXRjaFtdID0gewogCXsgLmNvbXBhdGlibGUgPSAi
bWVkaWF0ZWssbXQ3NjIxLWV0aCIsIC5kYXRhID0gJm10NzYyMV9kYXRhfSwKIAl7IC5jb21wYXRp
YmxlID0gIm1lZGlhdGVrLG10NzYyMi1ldGgiLCAuZGF0YSA9ICZtdDc2MjJfZGF0YX0sCiAJeyAu
Y29tcGF0aWJsZSA9ICJtZWRpYXRlayxtdDc2MjMtZXRoIiwgLmRhdGEgPSAmbXQ3NjIzX2RhdGF9
LAorCXsgLmNvbXBhdGlibGUgPSAibWVkaWF0ZWssbXQ3NjI4LWV0aCIsIC5kYXRhID0gJm10NzYy
OF9kYXRhfSwKIAl7IC5jb21wYXRpYmxlID0gIm1lZGlhdGVrLG10NzYyOS1ldGgiLCAuZGF0YSA9
ICZtdDc2MjlfZGF0YX0sCiAJe30sCiB9OwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9uZXQvZXRoZXJu
ZXQvbWVkaWF0ZWsvbXRrX2V0aF9zb2MuaCBiL2RyaXZlcnMvbmV0L2V0aGVybmV0L21lZGlhdGVr
L210a19ldGhfc29jLmgKaW5kZXggYmFiOTRmNzYzZTJjLi5jMzg2NmQ2NDUxZTIgMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvbmV0L2V0aGVybmV0L21lZGlhdGVrL210a19ldGhfc29jLmgKKysrIGIvZHJp
dmVycy9uZXQvZXRoZXJuZXQvbWVkaWF0ZWsvbXRrX2V0aF9zb2MuaApAQCAtMzksNyArMzksOCBA
QAogCQkJCSBORVRJRl9GX1NHIHwgTkVUSUZfRl9UU08gfCBcCiAJCQkJIE5FVElGX0ZfVFNPNiB8
IFwKIAkJCQkgTkVUSUZfRl9JUFY2X0NTVU0pCi0jZGVmaW5lIE5FWFRfUlhfREVTUF9JRFgoWCwg
WSkJKCgoWCkgKyAxKSAmICgoWSkgLSAxKSkKKyNkZWZpbmUgTVRLX0hXX0ZFQVRVUkVTX01UNzYy
OAkoTkVUSUZfRl9TRyB8IE5FVElGX0ZfUlhDU1VNKQorI2RlZmluZSBORVhUX0RFU1BfSURYKFgs
IFkpCSgoKFgpICsgMSkgJiAoKFkpIC0gMSkpCiAKICNkZWZpbmUgTVRLX01BWF9SWF9SSU5HX05V
TQk0CiAjZGVmaW5lIE1US19IV19MUk9fRE1BX1NJWkUJOApAQCAtMTE4LDYgKzExOSw3IEBACiAv
KiBQRE1BIEdsb2JhbCBDb25maWd1cmF0aW9uIFJlZ2lzdGVyICovCiAjZGVmaW5lIE1US19QRE1B
X0dMT19DRkcJMHhhMDQKICNkZWZpbmUgTVRLX01VTFRJX0VOCQlCSVQoMTApCisjZGVmaW5lIE1U
S19QRE1BX1NJWkVfOERXT1JEUwkoMSA8PCA0KQogCiAvKiBQRE1BIFJlc2V0IEluZGV4IFJlZ2lz
dGVyICovCiAjZGVmaW5lIE1US19QRE1BX1JTVF9JRFgJMHhhMDgKQEAgLTI3NiwxMSArMjc4LDE4
IEBACiAjZGVmaW5lIFRYX0RNQV9PV05FUl9DUFUJQklUKDMxKQogI2RlZmluZSBUWF9ETUFfTFMw
CQlCSVQoMzApCiAjZGVmaW5lIFRYX0RNQV9QTEVOMChfeCkJKCgoX3gpICYgTVRLX1RYX0RNQV9C
VUZfTEVOKSA8PCAxNikKKyNkZWZpbmUgVFhfRE1BX1BMRU4xKF94KQkoKF94KSAmIE1US19UWF9E
TUFfQlVGX0xFTikKICNkZWZpbmUgVFhfRE1BX1NXQwkJQklUKDE0KQogI2RlZmluZSBUWF9ETUFf
U0RMKF94KQkJKCgoX3gpICYgMHgzZmZmKSA8PCAxNikKIAorLyogUERNQSBvbiBNVDc2MjggKi8K
KyNkZWZpbmUgVFhfRE1BX0RPTkUJCUJJVCgzMSkKKyNkZWZpbmUgVFhfRE1BX0xTMQkJQklUKDE0
KQorI2RlZmluZSBUWF9ETUFfREVTUDJfREVGCShUWF9ETUFfTFMwIHwgVFhfRE1BX0RPTkUpCisK
IC8qIFFETUEgZGVzY3JpcHRvciByeGQyICovCiAjZGVmaW5lIFJYX0RNQV9ET05FCQlCSVQoMzEp
CisjZGVmaW5lIFJYX0RNQV9MU08JCUJJVCgzMCkKICNkZWZpbmUgUlhfRE1BX1BMRU4wKF94KQko
KChfeCkgJiAweDNmZmYpIDw8IDE2KQogI2RlZmluZSBSWF9ETUFfR0VUX1BMRU4wKF94KQkoKChf
eCkgPj4gMTYpICYgMHgzZmZmKQogCkBAIC0yODksNiArMjk4LDcgQEAKIAogLyogUURNQSBkZXNj
cmlwdG9yIHJ4ZDQgKi8KICNkZWZpbmUgUlhfRE1BX0w0X1ZBTElECQlCSVQoMjQpCisjZGVmaW5l
IFJYX0RNQV9MNF9WQUxJRF9QRE1BCUJJVCgzMCkJCS8qIHdoZW4gUERNQSBpcyB1c2VkICovCiAj
ZGVmaW5lIFJYX0RNQV9GUE9SVF9TSElGVAkxOQogI2RlZmluZSBSWF9ETUFfRlBPUlRfTUFTSwkw
eDcKIApAQCAtNDEyLDYgKzQyMiwxOSBAQAogI2RlZmluZSBDT19RUEhZX1NFTCAgICAgICAgICAg
IEJJVCgwKQogI2RlZmluZSBHRVBIWV9NQUNfU0VMICAgICAgICAgIEJJVCgxKQogCisvKiBNVDc2
MjgvODggc3BlY2lmaWMgc3R1ZmYgKi8KKyNkZWZpbmUgTVQ3NjI4X1BETUFfT0ZGU0VUCTB4MDgw
MAorI2RlZmluZSBNVDc2MjhfU0RNX09GRlNFVAkweDBjMDAKKworI2RlZmluZSBNVDc2MjhfVFhf
QkFTRV9QVFIwCShNVDc2MjhfUERNQV9PRkZTRVQgKyAweDAwKQorI2RlZmluZSBNVDc2MjhfVFhf
TUFYX0NOVDAJKE1UNzYyOF9QRE1BX09GRlNFVCArIDB4MDQpCisjZGVmaW5lIE1UNzYyOF9UWF9D
VFhfSURYMAkoTVQ3NjI4X1BETUFfT0ZGU0VUICsgMHgwOCkKKyNkZWZpbmUgTVQ3NjI4X1RYX0RU
WF9JRFgwCShNVDc2MjhfUERNQV9PRkZTRVQgKyAweDBjKQorI2RlZmluZSBNVDc2MjhfUFNUX0RU
WF9JRFgwCUJJVCgwKQorCisjZGVmaW5lIE1UNzYyOF9TRE1fTUFDX0FEUkwJKE1UNzYyOF9TRE1f
T0ZGU0VUICsgMHgwYykKKyNkZWZpbmUgTVQ3NjI4X1NETV9NQUNfQURSSAkoTVQ3NjI4X1NETV9P
RkZTRVQgKyAweDEwKQorCiBzdHJ1Y3QgbXRrX3J4X2RtYSB7CiAJdW5zaWduZWQgaW50IHJ4ZDE7
CiAJdW5zaWduZWQgaW50IHJ4ZDI7CkBAIC01MDksNiArNTMyLDcgQEAgZW51bSBtdGtfY2xrc19t
YXAgewogCQkJCSBCSVQoTVRLX0NMS19TR01JSV9DSykgfCBcCiAJCQkJIEJJVChNVEtfQ0xLX0VU
SDJQTEwpKQogI2RlZmluZSBNVDc2MjFfQ0xLU19CSVRNQVAJKDApCisjZGVmaW5lIE1UNzYyOF9D
TEtTX0JJVE1BUAkoMCkKICNkZWZpbmUgTVQ3NjI5X0NMS1NfQklUTUFQCShCSVQoTVRLX0NMS19F
VEhJRikgfCBCSVQoTVRLX0NMS19FU1cpIHwgIFwKIAkJCQkgQklUKE1US19DTEtfR1AwKSB8IEJJ
VChNVEtfQ0xLX0dQMSkgfCBcCiAJCQkJIEJJVChNVEtfQ0xLX0dQMikgfCBCSVQoTVRLX0NMS19G
RSkgfCBcCkBAIC01NjMsNiArNTg3LDEwIEBAIHN0cnVjdCBtdGtfdHhfcmluZyB7CiAJc3RydWN0
IG10a190eF9kbWEgKmxhc3RfZnJlZTsKIAl1MTYgdGhyZXNoOwogCWF0b21pY190IGZyZWVfY291
bnQ7CisJaW50IGRtYV9zaXplOworCXN0cnVjdCBtdGtfdHhfZG1hICpkbWFfcGRtYTsJLyogRm9y
IE1UNzYyOC84OCBQRE1BIGhhbmRsaW5nICovCisJZG1hX2FkZHJfdCBwaHlzX3BkbWE7CisJaW50
IGNwdV9pZHg7CiB9OwogCiAvKiBQRE1BIHJ4IHJpbmcgbW9kZSAqLwpAQCAtNjA0LDYgKzYzMiw3
IEBAIGVudW0gbWt0X2V0aF9jYXBhYmlsaXRpZXMgewogCU1US19IV0xST19CSVQsCiAJTVRLX1NI
QVJFRF9JTlRfQklULAogCU1US19UUkdNSUlfTVQ3NjIxX0NMS19CSVQsCisJTVRLX1NPQ19NVDc2
MjgsCiAKIAkvKiBNVVggQklUUyovCiAJTVRLX0VUSF9NVVhfR0RNMV9UT19HTUFDMV9FU1dfQklU
LApAQCAtNjk2LDYgKzcyNSw4IEBAIGVudW0gbWt0X2V0aF9jYXBhYmlsaXRpZXMgewogCiAjZGVm
aW5lIE1UNzYyM19DQVBTICAoTVRLX0dNQUMxX1JHTUlJIHwgTVRLX0dNQUMxX1RSR01JSSB8IE1U
S19HTUFDMl9SR01JSSkKIAorI2RlZmluZSBNVDc2MjhfQ0FQUyAgKE1US19TSEFSRURfSU5UIHwg
TVRLX1NPQ19NVDc2MjgpCisKICNkZWZpbmUgTVQ3NjI5X0NBUFMgIChNVEtfR01BQzFfU0dNSUkg
fCBNVEtfR01BQzJfU0dNSUkgfCBNVEtfR01BQzJfR0VQSFkgfCBcCiAJCSAgICAgIE1US19HRE0x
X0VTVyB8IE1US19NVVhfR0RNMV9UT19HTUFDMV9FU1cgfCBcCiAJCSAgICAgIE1US19NVVhfR01B
QzJfR01BQzBfVE9fR0VQSFkgfCBcCkBAIC03MDcsNiArNzM4LDcgQEAgZW51bSBta3RfZXRoX2Nh
cGFiaWxpdGllcyB7CiAgKiBAYW5hX3JnYzM6ICAgICAgICAgICAgICAgICAgIFRoZSBvZmZzZXQg
Zm9yIHJlZ2lzdGVyIEFOQV9SR0MzIHJlbGF0ZWQgdG8KICAqCQkJCXNnbWlpc3lzIHN5c2Nvbgog
ICogQGNhcHMJCQlGbGFncyBzaG93biB0aGUgZXh0cmEgY2FwYWJpbGl0eSBmb3IgdGhlIFNvQwor
ICogQGh3X2ZlYXR1cmVzCQkJRmxhZ3Mgc2hvd24gSFcgZmVhdHVyZXMKICAqIEByZXF1aXJlZF9j
bGtzCQlGbGFncyBzaG93biB0aGUgYml0bWFwIGZvciByZXF1aXJlZCBjbG9ja3Mgb24KICAqCQkJ
CXRoZSB0YXJnZXQgU29DCiAgKiBAcmVxdWlyZWRfcGN0bAkJQSBib29sIHZhbHVlIHRvIHNob3cg
d2hldGhlciB0aGUgU29DIHJlcXVpcmVzCkBAIC03MTcsNiArNzQ5LDcgQEAgc3RydWN0IG10a19z
b2NfZGF0YSB7CiAJdTMyCQljYXBzOwogCXUzMgkJcmVxdWlyZWRfY2xrczsKIAlib29sCQlyZXF1
aXJlZF9wY3RsOworCW5ldGRldl9mZWF0dXJlc190IGh3X2ZlYXR1cmVzOwogfTsKIAogLyogY3Vy
cmVudGx5IG5vIFNvQyBoYXMgbW9yZSB0aGFuIDIgbWFjcyAqLwpAQCAtODEwLDYgKzg0MywxMCBA
QCBzdHJ1Y3QgbXRrX2V0aCB7CiAJdW5zaWduZWQgbG9uZwkJCXN0YXRlOwogCiAJY29uc3Qgc3Ry
dWN0IG10a19zb2NfZGF0YQkqc29jOworCisJdTMyCQkJCXR4X2ludF9tYXNrX3JlZzsKKwl1MzIJ
CQkJcnhfZG1hX2w0X3ZhbGlkOworCWludAkJCQlpcF9hbGlnbjsKIH07CiAKIC8qIHN0cnVjdCBt
dGtfbWFjIC0JdGhlIHN0cnVjdHVyZSB0aGF0IGhvbGRzIHRoZSBpbmZvIGFib3V0IHRoZSBNQUNz
IG9mIHRoZQotLSAKMi4yMi4wCgoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX18KTGludXgtbWVkaWF0ZWsgbWFpbGluZyBsaXN0CkxpbnV4LW1lZGlhdGVrQGxp
c3RzLmluZnJhZGVhZC5vcmcKaHR0cDovL2xpc3RzLmluZnJhZGVhZC5vcmcvbWFpbG1hbi9saXN0
aW5mby9saW51eC1tZWRpYXRlawo=
