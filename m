Return-Path: <linux-mediatek-bounces+lists+linux-mediatek=lfdr.de@lists.infradead.org>
X-Original-To: lists+linux-mediatek@lfdr.de
Delivered-To: lists+linux-mediatek@lfdr.de
Received: from bombadil.infradead.org (bombadil.infradead.org [IPv6:2607:7c80:54:e::133])
	by mail.lfdr.de (Postfix) with ESMTPS id 604C9902E2
	for <lists+linux-mediatek@lfdr.de>; Fri, 16 Aug 2019 15:23:56 +0200 (CEST)
DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt; c=relaxed/relaxed;
	d=lists.infradead.org; s=bombadil.20170209; h=Sender:
	Content-Transfer-Encoding:Content-Type:Cc:List-Subscribe:List-Help:List-Post:
	List-Archive:List-Unsubscribe:List-Id:MIME-Version:References:In-Reply-To:
	Message-Id:Date:Subject:To:From:Reply-To:Content-ID:Content-Description:
	Resent-Date:Resent-From:Resent-Sender:Resent-To:Resent-Cc:Resent-Message-ID:
	List-Owner; bh=bcHD0oEJuH8JU6rfxABORbE6H7+6pTWQnyHFi/yMTJE=; b=sLyhEMLvZYpeg/
	NupVvXd7JLYieSmpRzrJmtH01yw8nMgnhiHcJbiCc/EvvjHotoQmGQUGWHTmNuiB7iwpauA/yP56u
	hFy9v4e6OcTZaKClJpWldYOtZ6KsFEAejNrn/gux1UFWvI+GaCxyFZ9kfApPBhjc7038IfnuWqT9t
	l8pJaYv7dXxla+MCDitfi1YXXuqHjVZsT/f35qXp955ubJqxMyV7jTWbWXIdoQf0jnxMdHjQTW8EZ
	YGdEuUh6yIjTy3tCxwW97g6Q79Hr/5hNjoGgJE9VXR4oQMwph/uBqW/n6MVnLbhXD9UtxYSrIdkZS
	naiF/5V7JELEnJMpWurg==;
Received: from localhost ([127.0.0.1] helo=bombadil.infradead.org)
	by bombadil.infradead.org with esmtp (Exim 4.92 #3 (Red Hat Linux))
	id 1hycCq-0000X6-8e; Fri, 16 Aug 2019 13:23:48 +0000
Received: from mx2a.mailbox.org ([2001:67c:2050:104:0:2:25:2]
 helo=mx2.mailbox.org)
 by bombadil.infradead.org with esmtps (Exim 4.92 #3 (Red Hat Linux))
 id 1hycCg-0000SG-3U
 for linux-mediatek@lists.infradead.org; Fri, 16 Aug 2019 13:23:44 +0000
Received: from smtp1.mailbox.org (smtp1.mailbox.org [80.241.60.240])
 (using TLSv1.2 with cipher ECDHE-RSA-CHACHA20-POLY1305 (256/256 bits))
 (No client certificate requested)
 by mx2.mailbox.org (Postfix) with ESMTPS id A1A14A1068;
 Fri, 16 Aug 2019 15:23:34 +0200 (CEST)
X-Virus-Scanned: amavisd-new at heinlein-support.de
Received: from smtp1.mailbox.org ([80.241.60.240])
 by spamfilter01.heinlein-hosting.de (spamfilter01.heinlein-hosting.de
 [80.241.56.115]) (amavisd-new, port 10030)
 with ESMTP id A-V-whBbFz6w; Fri, 16 Aug 2019 15:23:30 +0200 (CEST)
From: Stefan Roese <sr@denx.de>
To: netdev@vger.kernel.org,
	linux-mediatek@lists.infradead.org
Subject: [PATCH net-next 4/4 v3] net: ethernet: mediatek: Add MT7628/88 SoC
 support
Date: Fri, 16 Aug 2019 15:23:25 +0200
Message-Id: <20190816132325.28426-4-sr@denx.de>
In-Reply-To: <20190816132325.28426-1-sr@denx.de>
References: <20190816132325.28426-1-sr@denx.de>
MIME-Version: 1.0
X-CRM114-Version: 20100106-BlameMichelson ( TRE 0.8.0 (BSD) ) MR-646709E3 
X-CRM114-CacheID: sfid-20190816_062338_454697_0390C01B 
X-CRM114-Status: GOOD (  26.30  )
X-Spam-Score: -0.7 (/)
X-Spam-Report: SpamAssassin version 3.4.2 on bombadil.infradead.org summary:
 Content analysis details:   (-0.7 points)
 pts rule name              description
 ---- ---------------------- --------------------------------------------------
 -0.7 RCVD_IN_DNSWL_LOW      RBL: Sender listed at https://www.dnswl.org/,
 low trust [2001:67c:2050:104:0:2:25:2 listed in]
 [list.dnswl.org]
 0.0 SPF_NONE               SPF: sender does not publish an SPF Record
 0.0 SPF_HELO_NONE          SPF: HELO does not publish an SPF Record
X-BeenThere: linux-mediatek@lists.infradead.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: <linux-mediatek.lists.infradead.org>
List-Unsubscribe: <http://lists.infradead.org/mailman/options/linux-mediatek>, 
 <mailto:linux-mediatek-request@lists.infradead.org?subject=unsubscribe>
List-Archive: <http://lists.infradead.org/pipermail/linux-mediatek/>
List-Post: <mailto:linux-mediatek@lists.infradead.org>
List-Help: <mailto:linux-mediatek-request@lists.infradead.org?subject=help>
List-Subscribe: <http://lists.infradead.org/mailman/listinfo/linux-mediatek>, 
 <mailto:linux-mediatek-request@lists.infradead.org?subject=subscribe>
Cc: =?UTF-8?q?Ren=C3=A9=20van=20Dorst?= <opensource@vdorst.com>,
 Sean Wang <sean.wang@mediatek.com>, Daniel Golle <daniel@makrotopia.org>,
 John Crispin <john@phrozen.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Sender: "Linux-mediatek" <linux-mediatek-bounces@lists.infradead.org>
Errors-To: linux-mediatek-bounces+lists+linux-mediatek=lfdr.de@lists.infradead.org

VGhpcyBwYXRjaCBhZGRzIHN1cHBvcnQgZm9yIHRoZSBNZWRpYVRlayBNVDc2MjgvODggU29DcyB0
byB0aGUgY29tbW9uCk1lZGlhVGVrIGV0aGVybmV0IGRyaXZlci4gU29tZSBtaW5vciBjaGFuZ2Vz
IGFyZSBuZWVkZWQgZm9yIHRoaXMgYW5kCmEgYmlnZ2VyIGNoYW5nZSwgYXMgdGhlIE1UNzYyOCBk
b2VzIG5vdCBzdXBwb3J0IFFETUEgKG9ubHkgUERNQSkuCgpTaWduZWQtb2ZmLWJ5OiBTdGVmYW4g
Um9lc2UgPHNyQGRlbnguZGU+CkNjOiBSZW7DqSB2YW4gRG9yc3QgPG9wZW5zb3VyY2VAdmRvcnN0
LmNvbT4KQ2M6IERhbmllbCBHb2xsZSA8ZGFuaWVsQG1ha3JvdG9waWEub3JnPgpDYzogU2VhbiBX
YW5nIDxzZWFuLndhbmdAbWVkaWF0ZWsuY29tPgpDYzogSm9obiBDcmlzcGluIDxqb2huQHBocm96
ZW4ub3JnPgotLS0KdjM6Ci0gQ29ycmVjdGVkIHBvaW50ZXIgYXJ0aG1ldGljIC0gdXNlIHByb3Bl
ciAodm9pZCAqKSBjYXN0IChEYXZpZCkKCnYyOgotIFJlYmFzZWQgb24gbmV0LW5leHQgKERhdmlk
KQotIFVzZWQgInJhbGluayxydDUzNTAtZXRoIiBjb21wYXRpYmxlIChEYW5pZWwpCi0gRml4ZWQg
Y2FwYWJpbGl0eSBiaXQgdXNhZ2UgKFJlbmUpCi0gRXh0cmFjdGVkIERUIGJpbmRpbmdzIGRlc2Ny
aXB0aW9uIHRvIHNlcGFyYXRlIHBhdGNoCi0gSW50cm9kdWNlZCBNVEtfUURNQSBjYXBhYmlsaXR5
LCB3aGljaCBpcyB1c2VkIG9uIGFsbAogIGN1cnJlbnRseSBzdXBwb3J0ZWQgU29Dcy4gT25seSB0
aGUgbmV3bHkgaW50cm9jdWRlZCBNVDc2MjgKICB1c2VzIFBETUEgYW5kIGRvZXMgbm90IGhhdmUg
dGhpcyBjYXBhYmlsaXR5IGJpdCBzZXQKLSBBZGRlZCB0eF9pbnRfbWFza19yZWcvdHhfaW50X3N0
YXR1c19yZWcgdmFyaWFibGVzIHRvIGJldHRlcgogIGFic3RyYWN0IHRoZSBRRE1BIHZzIFBETUEg
dXNhZ2UKICAKIGRyaXZlcnMvbmV0L2V0aGVybmV0L21lZGlhdGVrL0tjb25maWcgICAgICAgIHwg
ICAyICstCiBkcml2ZXJzL25ldC9ldGhlcm5ldC9tZWRpYXRlay9tdGtfZXRoX3BhdGguYyB8ICAg
NCArCiBkcml2ZXJzL25ldC9ldGhlcm5ldC9tZWRpYXRlay9tdGtfZXRoX3NvYy5jICB8IDQ4MCAr
KysrKysrKysrKysrKy0tLS0tCiBkcml2ZXJzL25ldC9ldGhlcm5ldC9tZWRpYXRlay9tdGtfZXRo
X3NvYy5oICB8ICA1MSArLQogNCBmaWxlcyBjaGFuZ2VkLCA0MjUgaW5zZXJ0aW9ucygrKSwgMTEy
IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbmV0L2V0aGVybmV0L21lZGlhdGVr
L0tjb25maWcgYi9kcml2ZXJzL25ldC9ldGhlcm5ldC9tZWRpYXRlay9LY29uZmlnCmluZGV4IDFm
N2ZmZjgxZjI0ZC4uYjc2Y2YyZTFjOWRjIDEwMDY0NAotLS0gYS9kcml2ZXJzL25ldC9ldGhlcm5l
dC9tZWRpYXRlay9LY29uZmlnCisrKyBiL2RyaXZlcnMvbmV0L2V0aGVybmV0L21lZGlhdGVrL0tj
b25maWcKQEAgLTEsNyArMSw3IEBACiAjIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4w
LW9ubHkKIGNvbmZpZyBORVRfVkVORE9SX01FRElBVEVLCiAJYm9vbCAiTWVkaWFUZWsgZXRoZXJu
ZXQgZHJpdmVyIgotCWRlcGVuZHMgb24gQVJDSF9NRURJQVRFSyB8fCBTT0NfTVQ3NjIxCisJZGVw
ZW5kcyBvbiBBUkNIX01FRElBVEVLIHx8IFNPQ19NVDc2MjEgfHwgU09DX01UNzYyMAogCS0tLWhl
bHAtLS0KIAkgIElmIHlvdSBoYXZlIGEgTWVkaWF0ZWsgU29DIHdpdGggZXRoZXJuZXQsIHNheSBZ
LgogCmRpZmYgLS1naXQgYS9kcml2ZXJzL25ldC9ldGhlcm5ldC9tZWRpYXRlay9tdGtfZXRoX3Bh
dGguYyBiL2RyaXZlcnMvbmV0L2V0aGVybmV0L21lZGlhdGVrL210a19ldGhfcGF0aC5jCmluZGV4
IDdmMDU4ODBjZjllZi4uMjg5NjBlNGM0ZTQzIDEwMDY0NAotLS0gYS9kcml2ZXJzL25ldC9ldGhl
cm5ldC9tZWRpYXRlay9tdGtfZXRoX3BhdGguYworKysgYi9kcml2ZXJzL25ldC9ldGhlcm5ldC9t
ZWRpYXRlay9tdGtfZXRoX3BhdGguYwpAQCAtMzE1LDYgKzMxNSwxMCBAQCBpbnQgbXRrX3NldHVw
X2h3X3BhdGgoc3RydWN0IG10a19ldGggKmV0aCwgaW50IG1hY19pZCwgaW50IHBoeW1vZGUpCiB7
CiAJaW50IGVycjsKIAorCS8qIE5vIG11eCdpbmcgZm9yIE1UNzYyOC84OCAqLworCWlmIChNVEtf
SEFTX0NBUFMoZXRoLT5zb2MtPmNhcHMsIE1US19TT0NfTVQ3NjI4KSkKKwkJcmV0dXJuIDA7CisK
IAlzd2l0Y2ggKHBoeW1vZGUpIHsKIAljYXNlIFBIWV9JTlRFUkZBQ0VfTU9ERV9UUkdNSUk6CiAJ
Y2FzZSBQSFlfSU5URVJGQUNFX01PREVfUkdNSUlfVFhJRDoKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
bmV0L2V0aGVybmV0L21lZGlhdGVrL210a19ldGhfc29jLmMgYi9kcml2ZXJzL25ldC9ldGhlcm5l
dC9tZWRpYXRlay9tdGtfZXRoX3NvYy5jCmluZGV4IGQ5OTc4MTc0Yjk2YS4uOGRkYmI4ZGNmMDMy
IDEwMDY0NAotLS0gYS9kcml2ZXJzL25ldC9ldGhlcm5ldC9tZWRpYXRlay9tdGtfZXRoX3NvYy5j
CisrKyBiL2RyaXZlcnMvbmV0L2V0aGVybmV0L21lZGlhdGVrL210a19ldGhfc29jLmMKQEAgLTMy
MywxMSArMzIzLDE0IEBAIHN0YXRpYyBpbnQgbXRrX3BoeV9jb25uZWN0KHN0cnVjdCBuZXRfZGV2
aWNlICpkZXYpCiAJCWdvdG8gZXJyX3BoeTsKIAl9CiAKLQkvKiBwdXQgdGhlIGdtYWMgaW50byB0
aGUgcmlnaHQgbW9kZSAqLwotCXJlZ21hcF9yZWFkKGV0aC0+ZXRoc3lzLCBFVEhTWVNfU1lTQ0ZH
MCwgJnZhbCk7Ci0JdmFsICY9IH5TWVNDRkcwX0dFX01PREUoU1lTQ0ZHMF9HRV9NQVNLLCBtYWMt
PmlkKTsKLQl2YWwgfD0gU1lTQ0ZHMF9HRV9NT0RFKG1hYy0+Z2VfbW9kZSwgbWFjLT5pZCk7Ci0J
cmVnbWFwX3dyaXRlKGV0aC0+ZXRoc3lzLCBFVEhTWVNfU1lTQ0ZHMCwgdmFsKTsKKwkvKiBObyBN
VDc2MjgvODggc3VwcG9ydCBmb3Igbm93ICovCisJaWYgKCFNVEtfSEFTX0NBUFMoZXRoLT5zb2Mt
PmNhcHMsIE1US19TT0NfTVQ3NjI4KSkgeworCQkvKiBwdXQgdGhlIGdtYWMgaW50byB0aGUgcmln
aHQgbW9kZSAqLworCQlyZWdtYXBfcmVhZChldGgtPmV0aHN5cywgRVRIU1lTX1NZU0NGRzAsICZ2
YWwpOworCQl2YWwgJj0gflNZU0NGRzBfR0VfTU9ERShTWVNDRkcwX0dFX01BU0ssIG1hYy0+aWQp
OworCQl2YWwgfD0gU1lTQ0ZHMF9HRV9NT0RFKG1hYy0+Z2VfbW9kZSwgbWFjLT5pZCk7CisJCXJl
Z21hcF93cml0ZShldGgtPmV0aHN5cywgRVRIU1lTX1NZU0NGRzAsIHZhbCk7CisJfQogCiAJLyog
Y291cGxlIHBoeWRldiB0byBuZXRfZGV2aWNlICovCiAJaWYgKG10a19waHlfY29ubmVjdF9ub2Rl
KGV0aCwgbWFjLCBucCkpCkBAIC0zOTUsOCArMzk4LDggQEAgc3RhdGljIGlubGluZSB2b2lkIG10
a190eF9pcnFfZGlzYWJsZShzdHJ1Y3QgbXRrX2V0aCAqZXRoLCB1MzIgbWFzaykKIAl1MzIgdmFs
OwogCiAJc3Bpbl9sb2NrX2lycXNhdmUoJmV0aC0+dHhfaXJxX2xvY2ssIGZsYWdzKTsKLQl2YWwg
PSBtdGtfcjMyKGV0aCwgTVRLX1FETUFfSU5UX01BU0spOwotCW10a193MzIoZXRoLCB2YWwgJiB+
bWFzaywgTVRLX1FETUFfSU5UX01BU0spOworCXZhbCA9IG10a19yMzIoZXRoLCBldGgtPnR4X2lu
dF9tYXNrX3JlZyk7CisJbXRrX3czMihldGgsIHZhbCAmIH5tYXNrLCBldGgtPnR4X2ludF9tYXNr
X3JlZyk7CiAJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmZXRoLT50eF9pcnFfbG9jaywgZmxhZ3Mp
OwogfQogCkBAIC00MDYsOCArNDA5LDggQEAgc3RhdGljIGlubGluZSB2b2lkIG10a190eF9pcnFf
ZW5hYmxlKHN0cnVjdCBtdGtfZXRoICpldGgsIHUzMiBtYXNrKQogCXUzMiB2YWw7CiAKIAlzcGlu
X2xvY2tfaXJxc2F2ZSgmZXRoLT50eF9pcnFfbG9jaywgZmxhZ3MpOwotCXZhbCA9IG10a19yMzIo
ZXRoLCBNVEtfUURNQV9JTlRfTUFTSyk7Ci0JbXRrX3czMihldGgsIHZhbCB8IG1hc2ssIE1US19R
RE1BX0lOVF9NQVNLKTsKKwl2YWwgPSBtdGtfcjMyKGV0aCwgZXRoLT50eF9pbnRfbWFza19yZWcp
OworCW10a193MzIoZXRoLCB2YWwgfCBtYXNrLCBldGgtPnR4X2ludF9tYXNrX3JlZyk7CiAJc3Bp
bl91bmxvY2tfaXJxcmVzdG9yZSgmZXRoLT50eF9pcnFfbG9jaywgZmxhZ3MpOwogfQogCkBAIC00
MzcsNiArNDQwLDcgQEAgc3RhdGljIGludCBtdGtfc2V0X21hY19hZGRyZXNzKHN0cnVjdCBuZXRf
ZGV2aWNlICpkZXYsIHZvaWQgKnApCiB7CiAJaW50IHJldCA9IGV0aF9tYWNfYWRkcihkZXYsIHAp
OwogCXN0cnVjdCBtdGtfbWFjICptYWMgPSBuZXRkZXZfcHJpdihkZXYpOworCXN0cnVjdCBtdGtf
ZXRoICpldGggPSBtYWMtPmh3OwogCWNvbnN0IGNoYXIgKm1hY2FkZHIgPSBkZXYtPmRldl9hZGRy
OwogCiAJaWYgKHJldCkKQEAgLTQ0NiwxMSArNDUwLDE5IEBAIHN0YXRpYyBpbnQgbXRrX3NldF9t
YWNfYWRkcmVzcyhzdHJ1Y3QgbmV0X2RldmljZSAqZGV2LCB2b2lkICpwKQogCQlyZXR1cm4gLUVC
VVNZOwogCiAJc3Bpbl9sb2NrX2JoKCZtYWMtPmh3LT5wYWdlX2xvY2spOwotCW10a193MzIobWFj
LT5odywgKG1hY2FkZHJbMF0gPDwgOCkgfCBtYWNhZGRyWzFdLAotCQlNVEtfR0RNQV9NQUNfQURS
SChtYWMtPmlkKSk7Ci0JbXRrX3czMihtYWMtPmh3LCAobWFjYWRkclsyXSA8PCAyNCkgfCAobWFj
YWRkclszXSA8PCAxNikgfAotCQkobWFjYWRkcls0XSA8PCA4KSB8IG1hY2FkZHJbNV0sCi0JCU1U
S19HRE1BX01BQ19BRFJMKG1hYy0+aWQpKTsKKwlpZiAoTVRLX0hBU19DQVBTKGV0aC0+c29jLT5j
YXBzLCBNVEtfU09DX01UNzYyOCkpIHsKKwkJbXRrX3czMihtYWMtPmh3LCAobWFjYWRkclswXSA8
PCA4KSB8IG1hY2FkZHJbMV0sCisJCQlNVDc2MjhfU0RNX01BQ19BRFJIKTsKKwkJbXRrX3czMiht
YWMtPmh3LCAobWFjYWRkclsyXSA8PCAyNCkgfCAobWFjYWRkclszXSA8PCAxNikgfAorCQkJKG1h
Y2FkZHJbNF0gPDwgOCkgfCBtYWNhZGRyWzVdLAorCQkJTVQ3NjI4X1NETV9NQUNfQURSTCk7CisJ
fSBlbHNlIHsKKwkJbXRrX3czMihtYWMtPmh3LCAobWFjYWRkclswXSA8PCA4KSB8IG1hY2FkZHJb
MV0sCisJCQlNVEtfR0RNQV9NQUNfQURSSChtYWMtPmlkKSk7CisJCW10a193MzIobWFjLT5odywg
KG1hY2FkZHJbMl0gPDwgMjQpIHwgKG1hY2FkZHJbM10gPDwgMTYpIHwKKwkJCShtYWNhZGRyWzRd
IDw8IDgpIHwgbWFjYWRkcls1XSwKKwkJCU1US19HRE1BX01BQ19BRFJMKG1hYy0+aWQpKTsKKwl9
CiAJc3Bpbl91bmxvY2tfYmgoJm1hYy0+aHctPnBhZ2VfbG9jayk7CiAKIAlyZXR1cm4gMDsKQEAg
LTYyNiwxOSArNjM4LDQ3IEBAIHN0YXRpYyBpbmxpbmUgc3RydWN0IG10a190eF9idWYgKm10a19k
ZXNjX3RvX3R4X2J1ZihzdHJ1Y3QgbXRrX3R4X3JpbmcgKnJpbmcsCiAJcmV0dXJuICZyaW5nLT5i
dWZbaWR4XTsKIH0KIAorc3RhdGljIHN0cnVjdCBtdGtfdHhfZG1hICpxZG1hX3RvX3BkbWEoc3Ry
dWN0IG10a190eF9yaW5nICpyaW5nLAorCQkJCSAgICAgICBzdHJ1Y3QgbXRrX3R4X2RtYSAqZG1h
KQoreworCXJldHVybiByaW5nLT5kbWFfcGRtYSAtIHJpbmctPmRtYSArIGRtYTsKK30KKworc3Rh
dGljIGludCB0eGRfdG9faWR4KHN0cnVjdCBtdGtfdHhfcmluZyAqcmluZywgc3RydWN0IG10a190
eF9kbWEgKmRtYSkKK3sKKwlyZXR1cm4gKCh2b2lkICopZG1hIC0gKHZvaWQgKilyaW5nLT5kbWEp
IC8gc2l6ZW9mKCpkbWEpOworfQorCiBzdGF0aWMgdm9pZCBtdGtfdHhfdW5tYXAoc3RydWN0IG10
a19ldGggKmV0aCwgc3RydWN0IG10a190eF9idWYgKnR4X2J1ZikKIHsKLQlpZiAodHhfYnVmLT5m
bGFncyAmIE1US19UWF9GTEFHU19TSU5HTEUwKSB7Ci0JCWRtYV91bm1hcF9zaW5nbGUoZXRoLT5k
ZXYsCi0JCQkJIGRtYV91bm1hcF9hZGRyKHR4X2J1ZiwgZG1hX2FkZHIwKSwKLQkJCQkgZG1hX3Vu
bWFwX2xlbih0eF9idWYsIGRtYV9sZW4wKSwKLQkJCQkgRE1BX1RPX0RFVklDRSk7Ci0JfSBlbHNl
IGlmICh0eF9idWYtPmZsYWdzICYgTVRLX1RYX0ZMQUdTX1BBR0UwKSB7Ci0JCWRtYV91bm1hcF9w
YWdlKGV0aC0+ZGV2LAotCQkJICAgICAgIGRtYV91bm1hcF9hZGRyKHR4X2J1ZiwgZG1hX2FkZHIw
KSwKLQkJCSAgICAgICBkbWFfdW5tYXBfbGVuKHR4X2J1ZiwgZG1hX2xlbjApLAotCQkJICAgICAg
IERNQV9UT19ERVZJQ0UpOworCWlmIChNVEtfSEFTX0NBUFMoZXRoLT5zb2MtPmNhcHMsIE1US19R
RE1BKSkgeworCQlpZiAodHhfYnVmLT5mbGFncyAmIE1US19UWF9GTEFHU19TSU5HTEUwKSB7CisJ
CQlkbWFfdW5tYXBfc2luZ2xlKGV0aC0+ZGV2LAorCQkJCQkgZG1hX3VubWFwX2FkZHIodHhfYnVm
LCBkbWFfYWRkcjApLAorCQkJCQkgZG1hX3VubWFwX2xlbih0eF9idWYsIGRtYV9sZW4wKSwKKwkJ
CQkJIERNQV9UT19ERVZJQ0UpOworCQl9IGVsc2UgaWYgKHR4X2J1Zi0+ZmxhZ3MgJiBNVEtfVFhf
RkxBR1NfUEFHRTApIHsKKwkJCWRtYV91bm1hcF9wYWdlKGV0aC0+ZGV2LAorCQkJCSAgICAgICBk
bWFfdW5tYXBfYWRkcih0eF9idWYsIGRtYV9hZGRyMCksCisJCQkJICAgICAgIGRtYV91bm1hcF9s
ZW4odHhfYnVmLCBkbWFfbGVuMCksCisJCQkJICAgICAgIERNQV9UT19ERVZJQ0UpOworCQl9CisJ
fSBlbHNlIHsKKwkJaWYgKGRtYV91bm1hcF9sZW4odHhfYnVmLCBkbWFfbGVuMCkpIHsKKwkJCWRt
YV91bm1hcF9wYWdlKGV0aC0+ZGV2LAorCQkJCSAgICAgICBkbWFfdW5tYXBfYWRkcih0eF9idWYs
IGRtYV9hZGRyMCksCisJCQkJICAgICAgIGRtYV91bm1hcF9sZW4odHhfYnVmLCBkbWFfbGVuMCks
CisJCQkJICAgICAgIERNQV9UT19ERVZJQ0UpOworCQl9CisKKwkJaWYgKGRtYV91bm1hcF9sZW4o
dHhfYnVmLCBkbWFfbGVuMSkpIHsKKwkJCWRtYV91bm1hcF9wYWdlKGV0aC0+ZGV2LAorCQkJCSAg
ICAgICBkbWFfdW5tYXBfYWRkcih0eF9idWYsIGRtYV9hZGRyMSksCisJCQkJICAgICAgIGRtYV91
bm1hcF9sZW4odHhfYnVmLCBkbWFfbGVuMSksCisJCQkJICAgICAgIERNQV9UT19ERVZJQ0UpOwor
CQl9CiAJfQorCiAJdHhfYnVmLT5mbGFncyA9IDA7CiAJaWYgKHR4X2J1Zi0+c2tiICYmCiAJICAg
ICh0eF9idWYtPnNrYiAhPSAoc3RydWN0IHNrX2J1ZmYgKilNVEtfRE1BX0RVTU1ZX0RFU0MpKQpA
QCAtNjQ2LDE5ICs2ODYsNDUgQEAgc3RhdGljIHZvaWQgbXRrX3R4X3VubWFwKHN0cnVjdCBtdGtf
ZXRoICpldGgsIHN0cnVjdCBtdGtfdHhfYnVmICp0eF9idWYpCiAJdHhfYnVmLT5za2IgPSBOVUxM
OwogfQogCitzdGF0aWMgdm9pZCBzZXR1cF90eF9idWYoc3RydWN0IG10a19ldGggKmV0aCwgc3Ry
dWN0IG10a190eF9idWYgKnR4X2J1ZiwKKwkJCSBzdHJ1Y3QgbXRrX3R4X2RtYSAqdHhkLCBkbWFf
YWRkcl90IG1hcHBlZF9hZGRyLAorCQkJIHNpemVfdCBzaXplLCBpbnQgaWR4KQoreworCWlmIChN
VEtfSEFTX0NBUFMoZXRoLT5zb2MtPmNhcHMsIE1US19RRE1BKSkgeworCQlkbWFfdW5tYXBfYWRk
cl9zZXQodHhfYnVmLCBkbWFfYWRkcjAsIG1hcHBlZF9hZGRyKTsKKwkJZG1hX3VubWFwX2xlbl9z
ZXQodHhfYnVmLCBkbWFfbGVuMCwgc2l6ZSk7CisJfSBlbHNlIHsKKwkJaWYgKGlkeCAmIDEpIHsK
KwkJCXR4ZC0+dHhkMyA9IG1hcHBlZF9hZGRyOworCQkJdHhkLT50eGQyIHw9IFRYX0RNQV9QTEVO
MShzaXplKTsKKwkJCWRtYV91bm1hcF9hZGRyX3NldCh0eF9idWYsIGRtYV9hZGRyMSwgbWFwcGVk
X2FkZHIpOworCQkJZG1hX3VubWFwX2xlbl9zZXQodHhfYnVmLCBkbWFfbGVuMSwgc2l6ZSk7CisJ
CX0gZWxzZSB7CisJCQl0eF9idWYtPnNrYiA9IChzdHJ1Y3Qgc2tfYnVmZiAqKU1US19ETUFfRFVN
TVlfREVTQzsKKwkJCXR4ZC0+dHhkMSA9IG1hcHBlZF9hZGRyOworCQkJdHhkLT50eGQyID0gVFhf
RE1BX1BMRU4wKHNpemUpOworCQkJZG1hX3VubWFwX2FkZHJfc2V0KHR4X2J1ZiwgZG1hX2FkZHIw
LCBtYXBwZWRfYWRkcik7CisJCQlkbWFfdW5tYXBfbGVuX3NldCh0eF9idWYsIGRtYV9sZW4wLCBz
aXplKTsKKwkJfQorCX0KK30KKwogc3RhdGljIGludCBtdGtfdHhfbWFwKHN0cnVjdCBza19idWZm
ICpza2IsIHN0cnVjdCBuZXRfZGV2aWNlICpkZXYsCiAJCSAgICAgIGludCB0eF9udW0sIHN0cnVj
dCBtdGtfdHhfcmluZyAqcmluZywgYm9vbCBnc28pCiB7CiAJc3RydWN0IG10a19tYWMgKm1hYyA9
IG5ldGRldl9wcml2KGRldik7CiAJc3RydWN0IG10a19ldGggKmV0aCA9IG1hYy0+aHc7CiAJc3Ry
dWN0IG10a190eF9kbWEgKml0eGQsICp0eGQ7CisJc3RydWN0IG10a190eF9kbWEgKml0eGRfcGRt
YSwgKnR4ZF9wZG1hOwogCXN0cnVjdCBtdGtfdHhfYnVmICppdHhfYnVmLCAqdHhfYnVmOwogCWRt
YV9hZGRyX3QgbWFwcGVkX2FkZHI7CiAJdW5zaWduZWQgaW50IG5yX2ZyYWdzOwogCWludCBpLCBu
X2Rlc2MgPSAxOwogCXUzMiB0eGQ0ID0gMCwgZnBvcnQ7CisJaW50IGsgPSAwOwogCiAJaXR4ZCA9
IHJpbmctPm5leHRfZnJlZTsKKwlpdHhkX3BkbWEgPSBxZG1hX3RvX3BkbWEocmluZywgaXR4ZCk7
CiAJaWYgKGl0eGQgPT0gcmluZy0+bGFzdF9mcmVlKQogCQlyZXR1cm4gLUVOT01FTTsKIApAQCAt
Njg5LDEyICs3NTUsMTQgQEAgc3RhdGljIGludCBtdGtfdHhfbWFwKHN0cnVjdCBza19idWZmICpz
a2IsIHN0cnVjdCBuZXRfZGV2aWNlICpkZXYsCiAJaXR4X2J1Zi0+ZmxhZ3MgfD0gTVRLX1RYX0ZM
QUdTX1NJTkdMRTA7CiAJaXR4X2J1Zi0+ZmxhZ3MgfD0gKCFtYWMtPmlkKSA/IE1US19UWF9GTEFH
U19GUE9SVDAgOgogCQkJICBNVEtfVFhfRkxBR1NfRlBPUlQxOwotCWRtYV91bm1hcF9hZGRyX3Nl
dChpdHhfYnVmLCBkbWFfYWRkcjAsIG1hcHBlZF9hZGRyKTsKLQlkbWFfdW5tYXBfbGVuX3NldChp
dHhfYnVmLCBkbWFfbGVuMCwgc2tiX2hlYWRsZW4oc2tiKSk7CisJc2V0dXBfdHhfYnVmKGV0aCwg
aXR4X2J1ZiwgaXR4ZF9wZG1hLCBtYXBwZWRfYWRkciwgc2tiX2hlYWRsZW4oc2tiKSwKKwkJICAg
ICBrKyspOwogCiAJLyogVFggU0cgb2ZmbG9hZCAqLwogCXR4ZCA9IGl0eGQ7CisJdHhkX3BkbWEg
PSBxZG1hX3RvX3BkbWEocmluZywgdHhkKTsKIAlucl9mcmFncyA9IHNrYl9zaGluZm8oc2tiKS0+
bnJfZnJhZ3M7CisKIAlmb3IgKGkgPSAwOyBpIDwgbnJfZnJhZ3M7IGkrKykgewogCQlza2JfZnJh
Z190ICpmcmFnID0gJnNrYl9zaGluZm8oc2tiKS0+ZnJhZ3NbaV07CiAJCXVuc2lnbmVkIGludCBv
ZmZzZXQgPSAwOwpAQCAtNzAzLDEyICs3NzEsMjEgQEAgc3RhdGljIGludCBtdGtfdHhfbWFwKHN0
cnVjdCBza19idWZmICpza2IsIHN0cnVjdCBuZXRfZGV2aWNlICpkZXYsCiAJCXdoaWxlIChmcmFn
X3NpemUpIHsKIAkJCWJvb2wgbGFzdF9mcmFnID0gZmFsc2U7CiAJCQl1bnNpZ25lZCBpbnQgZnJh
Z19tYXBfc2l6ZTsKKwkJCWJvb2wgbmV3X2Rlc2MgPSB0cnVlOworCisJCQlpZiAoTVRLX0hBU19D
QVBTKGV0aC0+c29jLT5jYXBzLCBNVEtfUURNQSkgfHwKKwkJCSAgICAoaSAmIDB4MSkpIHsKKwkJ
CQl0eGQgPSBtdGtfcWRtYV9waHlzX3RvX3ZpcnQocmluZywgdHhkLT50eGQyKTsKKwkJCQl0eGRf
cGRtYSA9IHFkbWFfdG9fcGRtYShyaW5nLCB0eGQpOworCQkJCWlmICh0eGQgPT0gcmluZy0+bGFz
dF9mcmVlKQorCQkJCQlnb3RvIGVycl9kbWE7CisKKwkJCQluX2Rlc2MrKzsKKwkJCX0gZWxzZSB7
CisJCQkJbmV3X2Rlc2MgPSBmYWxzZTsKKwkJCX0KIAotCQkJdHhkID0gbXRrX3FkbWFfcGh5c190
b192aXJ0KHJpbmcsIHR4ZC0+dHhkMik7Ci0JCQlpZiAodHhkID09IHJpbmctPmxhc3RfZnJlZSkK
LQkJCQlnb3RvIGVycl9kbWE7CiAKLQkJCW5fZGVzYysrOwogCQkJZnJhZ19tYXBfc2l6ZSA9IG1p
bihmcmFnX3NpemUsIE1US19UWF9ETUFfQlVGX0xFTik7CiAJCQltYXBwZWRfYWRkciA9IHNrYl9m
cmFnX2RtYV9tYXAoZXRoLT5kZXYsIGZyYWcsIG9mZnNldCwKIAkJCQkJCSAgICAgICBmcmFnX21h
cF9zaXplLApAQCAtNzI3LDE0ICs4MDQsMTYgQEAgc3RhdGljIGludCBtdGtfdHhfbWFwKHN0cnVj
dCBza19idWZmICpza2IsIHN0cnVjdCBuZXRfZGV2aWNlICpkZXYsCiAJCQlXUklURV9PTkNFKHR4
ZC0+dHhkNCwgZnBvcnQpOwogCiAJCQl0eF9idWYgPSBtdGtfZGVzY190b190eF9idWYocmluZywg
dHhkKTsKLQkJCW1lbXNldCh0eF9idWYsIDAsIHNpemVvZigqdHhfYnVmKSk7CisJCQlpZiAobmV3
X2Rlc2MpCisJCQkJbWVtc2V0KHR4X2J1ZiwgMCwgc2l6ZW9mKCp0eF9idWYpKTsKIAkJCXR4X2J1
Zi0+c2tiID0gKHN0cnVjdCBza19idWZmICopTVRLX0RNQV9EVU1NWV9ERVNDOwogCQkJdHhfYnVm
LT5mbGFncyB8PSBNVEtfVFhfRkxBR1NfUEFHRTA7CiAJCQl0eF9idWYtPmZsYWdzIHw9ICghbWFj
LT5pZCkgPyBNVEtfVFhfRkxBR1NfRlBPUlQwIDoKIAkJCQkJIE1US19UWF9GTEFHU19GUE9SVDE7
CiAKLQkJCWRtYV91bm1hcF9hZGRyX3NldCh0eF9idWYsIGRtYV9hZGRyMCwgbWFwcGVkX2FkZHIp
OwotCQkJZG1hX3VubWFwX2xlbl9zZXQodHhfYnVmLCBkbWFfbGVuMCwgZnJhZ19tYXBfc2l6ZSk7
CisJCQlzZXR1cF90eF9idWYoZXRoLCB0eF9idWYsIHR4ZF9wZG1hLCBtYXBwZWRfYWRkciwKKwkJ
CQkgICAgIGZyYWdfbWFwX3NpemUsIGsrKyk7CisKIAkJCWZyYWdfc2l6ZSAtPSBmcmFnX21hcF9z
aXplOwogCQkJb2Zmc2V0ICs9IGZyYWdfbWFwX3NpemU7CiAJCX0KQEAgLTc0Niw2ICs4MjUsMTIg
QEAgc3RhdGljIGludCBtdGtfdHhfbWFwKHN0cnVjdCBza19idWZmICpza2IsIHN0cnVjdCBuZXRf
ZGV2aWNlICpkZXYsCiAJV1JJVEVfT05DRShpdHhkLT50eGQ0LCB0eGQ0KTsKIAlXUklURV9PTkNF
KGl0eGQtPnR4ZDMsIChUWF9ETUFfU1dDIHwgVFhfRE1BX1BMRU4wKHNrYl9oZWFkbGVuKHNrYikp
IHwKIAkJCQkoIW5yX2ZyYWdzICogVFhfRE1BX0xTMCkpKTsKKwlpZiAoIU1US19IQVNfQ0FQUyhl
dGgtPnNvYy0+Y2FwcywgTVRLX1FETUEpKSB7CisJCWlmIChrICYgMHgxKQorCQkJdHhkX3BkbWEt
PnR4ZDIgfD0gVFhfRE1BX0xTMDsKKwkJZWxzZQorCQkJdHhkX3BkbWEtPnR4ZDIgfD0gVFhfRE1B
X0xTMTsKKwl9CiAKIAluZXRkZXZfc2VudF9xdWV1ZShkZXYsIHNrYi0+bGVuKTsKIAlza2JfdHhf
dGltZXN0YW1wKHNrYik7CkBAIC03NTgsOSArODQzLDE1IEBAIHN0YXRpYyBpbnQgbXRrX3R4X21h
cChzdHJ1Y3Qgc2tfYnVmZiAqc2tiLCBzdHJ1Y3QgbmV0X2RldmljZSAqZGV2LAogCSAqLwogCXdt
YigpOwogCi0JaWYgKG5ldGlmX3htaXRfc3RvcHBlZChuZXRkZXZfZ2V0X3R4X3F1ZXVlKGRldiwg
MCkpIHx8Ci0JICAgICFuZXRkZXZfeG1pdF9tb3JlKCkpCi0JCW10a193MzIoZXRoLCB0eGQtPnR4
ZDIsIE1US19RVFhfQ1RYX1BUUik7CisJaWYgKE1US19IQVNfQ0FQUyhldGgtPnNvYy0+Y2Fwcywg
TVRLX1FETUEpKSB7CisJCWlmIChuZXRpZl94bWl0X3N0b3BwZWQobmV0ZGV2X2dldF90eF9xdWV1
ZShkZXYsIDApKSB8fAorCQkgICAgIW5ldGRldl94bWl0X21vcmUoKSkKKwkJCW10a193MzIoZXRo
LCB0eGQtPnR4ZDIsIE1US19RVFhfQ1RYX1BUUik7CisJfSBlbHNlIHsKKwkJaW50IG5leHRfaWR4
ID0gTkVYVF9ERVNQX0lEWCh0eGRfdG9faWR4KHJpbmcsIHR4ZCksCisJCQkJCSAgICAgcmluZy0+
ZG1hX3NpemUpOworCQltdGtfdzMyKGV0aCwgbmV4dF9pZHgsIE1UNzYyOF9UWF9DVFhfSURYMCk7
CisJfQogCiAJcmV0dXJuIDA7CiAKQEAgLTc3Miw3ICs4NjMsMTEgQEAgc3RhdGljIGludCBtdGtf
dHhfbWFwKHN0cnVjdCBza19idWZmICpza2IsIHN0cnVjdCBuZXRfZGV2aWNlICpkZXYsCiAJCW10
a190eF91bm1hcChldGgsIHR4X2J1Zik7CiAKIAkJaXR4ZC0+dHhkMyA9IFRYX0RNQV9MUzAgfCBU
WF9ETUFfT1dORVJfQ1BVOworCQlpZiAoIU1US19IQVNfQ0FQUyhldGgtPnNvYy0+Y2FwcywgTVRL
X1FETUEpKQorCQkJaXR4ZF9wZG1hLT50eGQyID0gVFhfRE1BX0RFU1AyX0RFRjsKKwogCQlpdHhk
ID0gbXRrX3FkbWFfcGh5c190b192aXJ0KHJpbmcsIGl0eGQtPnR4ZDIpOworCQlpdHhkX3BkbWEg
PSBxZG1hX3RvX3BkbWEocmluZywgaXR4ZCk7CiAJfSB3aGlsZSAoaXR4ZCAhPSB0eGQpOwogCiAJ
cmV0dXJuIC1FTk9NRU07CkBAIC05NDYsNyArMTA0MSw3IEBAIHN0YXRpYyBpbnQgbXRrX3BvbGxf
cngoc3RydWN0IG5hcGlfc3RydWN0ICpuYXBpLCBpbnQgYnVkZ2V0LAogCQlzdHJ1Y3QgbmV0X2Rl
dmljZSAqbmV0ZGV2OwogCQl1bnNpZ25lZCBpbnQgcGt0bGVuOwogCQlkbWFfYWRkcl90IGRtYV9h
ZGRyOwotCQlpbnQgbWFjID0gMDsKKwkJaW50IG1hYzsKIAogCQlyaW5nID0gbXRrX2dldF9yeF9y
aW5nKGV0aCk7CiAJCWlmICh1bmxpa2VseSghcmluZykpCkBAIC05NjEsOSArMTA1NiwxMyBAQCBz
dGF0aWMgaW50IG10a19wb2xsX3J4KHN0cnVjdCBuYXBpX3N0cnVjdCAqbmFwaSwgaW50IGJ1ZGdl
dCwKIAkJCWJyZWFrOwogCiAJCS8qIGZpbmQgb3V0IHdoaWNoIG1hYyB0aGUgcGFja2V0IGNvbWUg
ZnJvbS4gdmFsdWVzIHN0YXJ0IGF0IDEgKi8KLQkJbWFjID0gKHRyeGQucnhkNCA+PiBSWF9ETUFf
RlBPUlRfU0hJRlQpICYKLQkJICAgICAgUlhfRE1BX0ZQT1JUX01BU0s7Ci0JCW1hYy0tOworCQlp
ZiAoTVRLX0hBU19DQVBTKGV0aC0+c29jLT5jYXBzLCBNVEtfU09DX01UNzYyOCkpIHsKKwkJCW1h
YyA9IDA7CisJCX0gZWxzZSB7CisJCQltYWMgPSAodHJ4ZC5yeGQ0ID4+IFJYX0RNQV9GUE9SVF9T
SElGVCkgJgorCQkJCVJYX0RNQV9GUE9SVF9NQVNLOworCQkJbWFjLS07CisJCX0KIAogCQlpZiAo
dW5saWtlbHkobWFjIDwgMCB8fCBtYWMgPj0gTVRLX01BQ19DT1VOVCB8fAogCQkJICAgICAhZXRo
LT5uZXRkZXZbbWFjXSkpCkBAIC05ODEsNyArMTA4MCw4IEBAIHN0YXRpYyBpbnQgbXRrX3BvbGxf
cngoc3RydWN0IG5hcGlfc3RydWN0ICpuYXBpLCBpbnQgYnVkZ2V0LAogCQkJZ290byByZWxlYXNl
X2Rlc2M7CiAJCX0KIAkJZG1hX2FkZHIgPSBkbWFfbWFwX3NpbmdsZShldGgtPmRldiwKLQkJCQkJ
ICBuZXdfZGF0YSArIE5FVF9TS0JfUEFELAorCQkJCQkgIG5ld19kYXRhICsgTkVUX1NLQl9QQUQg
KworCQkJCQkgIGV0aC0+aXBfYWxpZ24sCiAJCQkJCSAgcmluZy0+YnVmX3NpemUsCiAJCQkJCSAg
RE1BX0ZST01fREVWSUNFKTsKIAkJaWYgKHVubGlrZWx5KGRtYV9tYXBwaW5nX2Vycm9yKGV0aC0+
ZGV2LCBkbWFfYWRkcikpKSB7CkBAIC0xMDA0LDcgKzExMDQsNyBAQCBzdGF0aWMgaW50IG10a19w
b2xsX3J4KHN0cnVjdCBuYXBpX3N0cnVjdCAqbmFwaSwgaW50IGJ1ZGdldCwKIAkJcGt0bGVuID0g
UlhfRE1BX0dFVF9QTEVOMCh0cnhkLnJ4ZDIpOwogCQlza2ItPmRldiA9IG5ldGRldjsKIAkJc2ti
X3B1dChza2IsIHBrdGxlbik7Ci0JCWlmICh0cnhkLnJ4ZDQgJiBSWF9ETUFfTDRfVkFMSUQpCisJ
CWlmICh0cnhkLnJ4ZDQgJiBldGgtPnJ4X2RtYV9sNF92YWxpZCkKIAkJCXNrYi0+aXBfc3VtbWVk
ID0gQ0hFQ0tTVU1fVU5ORUNFU1NBUlk7CiAJCWVsc2UKIAkJCXNrYl9jaGVja3N1bV9ub25lX2Fz
c2VydChza2IpOwpAQCAtMTAyMSw3ICsxMTIxLDEwIEBAIHN0YXRpYyBpbnQgbXRrX3BvbGxfcngo
c3RydWN0IG5hcGlfc3RydWN0ICpuYXBpLCBpbnQgYnVkZ2V0LAogCQlyeGQtPnJ4ZDEgPSAodW5z
aWduZWQgaW50KWRtYV9hZGRyOwogCiByZWxlYXNlX2Rlc2M6Ci0JCXJ4ZC0+cnhkMiA9IFJYX0RN
QV9QTEVOMChyaW5nLT5idWZfc2l6ZSk7CisJCWlmIChNVEtfSEFTX0NBUFMoZXRoLT5zb2MtPmNh
cHMsIE1US19TT0NfTVQ3NjI4KSkKKwkJCXJ4ZC0+cnhkMiA9IFJYX0RNQV9MU087CisJCWVsc2UK
KwkJCXJ4ZC0+cnhkMiA9IFJYX0RNQV9QTEVOMChyaW5nLT5idWZfc2l6ZSk7CiAKIAkJcmluZy0+
Y2FsY19pZHggPSBpZHg7CiAKQEAgLTEwNDAsMTkgKzExNDMsMTQgQEAgc3RhdGljIGludCBtdGtf
cG9sbF9yeChzdHJ1Y3QgbmFwaV9zdHJ1Y3QgKm5hcGksIGludCBidWRnZXQsCiAJcmV0dXJuIGRv
bmU7CiB9CiAKLXN0YXRpYyBpbnQgbXRrX3BvbGxfdHgoc3RydWN0IG10a19ldGggKmV0aCwgaW50
IGJ1ZGdldCkKK3N0YXRpYyBpbnQgbXRrX3BvbGxfdHhfcWRtYShzdHJ1Y3QgbXRrX2V0aCAqZXRo
LCBpbnQgYnVkZ2V0LAorCQkJICAgIHVuc2lnbmVkIGludCAqZG9uZSwgdW5zaWduZWQgaW50ICpi
eXRlcykKIHsKIAlzdHJ1Y3QgbXRrX3R4X3JpbmcgKnJpbmcgPSAmZXRoLT50eF9yaW5nOwogCXN0
cnVjdCBtdGtfdHhfZG1hICpkZXNjOwogCXN0cnVjdCBza19idWZmICpza2I7CiAJc3RydWN0IG10
a190eF9idWYgKnR4X2J1ZjsKLQl1bnNpZ25lZCBpbnQgZG9uZVtNVEtfTUFYX0RFVlNdOwotCXVu
c2lnbmVkIGludCBieXRlc1tNVEtfTUFYX0RFVlNdOwogCXUzMiBjcHUsIGRtYTsKLQlpbnQgdG90
YWwgPSAwLCBpOwotCi0JbWVtc2V0KGRvbmUsIDAsIHNpemVvZihkb25lKSk7Ci0JbWVtc2V0KGJ5
dGVzLCAwLCBzaXplb2YoYnl0ZXMpKTsKIAogCWNwdSA9IG10a19yMzIoZXRoLCBNVEtfUVRYX0NS
WF9QVFIpOwogCWRtYSA9IG10a19yMzIoZXRoLCBNVEtfUVRYX0RSWF9QVFIpOwpAQCAtMTA5MCw2
ICsxMTg4LDYyIEBAIHN0YXRpYyBpbnQgbXRrX3BvbGxfdHgoc3RydWN0IG10a19ldGggKmV0aCwg
aW50IGJ1ZGdldCkKIAogCW10a193MzIoZXRoLCBjcHUsIE1US19RVFhfQ1JYX1BUUik7CiAKKwly
ZXR1cm4gYnVkZ2V0OworfQorCitzdGF0aWMgaW50IG10a19wb2xsX3R4X3BkbWEoc3RydWN0IG10
a19ldGggKmV0aCwgaW50IGJ1ZGdldCwKKwkJCSAgICB1bnNpZ25lZCBpbnQgKmRvbmUsIHVuc2ln
bmVkIGludCAqYnl0ZXMpCit7CisJc3RydWN0IG10a190eF9yaW5nICpyaW5nID0gJmV0aC0+dHhf
cmluZzsKKwlzdHJ1Y3QgbXRrX3R4X2RtYSAqZGVzYzsKKwlzdHJ1Y3Qgc2tfYnVmZiAqc2tiOwor
CXN0cnVjdCBtdGtfdHhfYnVmICp0eF9idWY7CisJdTMyIGNwdSwgZG1hOworCisJY3B1ID0gcmlu
Zy0+Y3B1X2lkeDsKKwlkbWEgPSBtdGtfcjMyKGV0aCwgTVQ3NjI4X1RYX0RUWF9JRFgwKTsKKwor
CXdoaWxlICgoY3B1ICE9IGRtYSkgJiYgYnVkZ2V0KSB7CisJCXR4X2J1ZiA9ICZyaW5nLT5idWZb
Y3B1XTsKKwkJc2tiID0gdHhfYnVmLT5za2I7CisJCWlmICghc2tiKQorCQkJYnJlYWs7CisKKwkJ
aWYgKHNrYiAhPSAoc3RydWN0IHNrX2J1ZmYgKilNVEtfRE1BX0RVTU1ZX0RFU0MpIHsKKwkJCWJ5
dGVzWzBdICs9IHNrYi0+bGVuOworCQkJZG9uZVswXSsrOworCQkJYnVkZ2V0LS07CisJCX0KKwor
CQltdGtfdHhfdW5tYXAoZXRoLCB0eF9idWYpOworCisJCWRlc2MgPSAmcmluZy0+ZG1hW2NwdV07
CisJCXJpbmctPmxhc3RfZnJlZSA9IGRlc2M7CisJCWF0b21pY19pbmMoJnJpbmctPmZyZWVfY291
bnQpOworCisJCWNwdSA9IE5FWFRfREVTUF9JRFgoY3B1LCByaW5nLT5kbWFfc2l6ZSk7CisJfQor
CisJcmluZy0+Y3B1X2lkeCA9IGNwdTsKKworCXJldHVybiBidWRnZXQ7Cit9CisKK3N0YXRpYyBp
bnQgbXRrX3BvbGxfdHgoc3RydWN0IG10a19ldGggKmV0aCwgaW50IGJ1ZGdldCkKK3sKKwlzdHJ1
Y3QgbXRrX3R4X3JpbmcgKnJpbmcgPSAmZXRoLT50eF9yaW5nOworCXVuc2lnbmVkIGludCBkb25l
W01US19NQVhfREVWU107CisJdW5zaWduZWQgaW50IGJ5dGVzW01US19NQVhfREVWU107CisJaW50
IHRvdGFsID0gMCwgaTsKKworCW1lbXNldChkb25lLCAwLCBzaXplb2YoZG9uZSkpOworCW1lbXNl
dChieXRlcywgMCwgc2l6ZW9mKGJ5dGVzKSk7CisKKwlpZiAoTVRLX0hBU19DQVBTKGV0aC0+c29j
LT5jYXBzLCBNVEtfUURNQSkpCisJCWJ1ZGdldCA9IG10a19wb2xsX3R4X3FkbWEoZXRoLCBidWRn
ZXQsIGRvbmUsIGJ5dGVzKTsKKwllbHNlCisJCWJ1ZGdldCA9IG10a19wb2xsX3R4X3BkbWEoZXRo
LCBidWRnZXQsIGRvbmUsIGJ5dGVzKTsKKwogCWZvciAoaSA9IDA7IGkgPCBNVEtfTUFDX0NPVU5U
OyBpKyspIHsKIAkJaWYgKCFldGgtPm5ldGRldltpXSB8fCAhZG9uZVtpXSkKIAkJCWNvbnRpbnVl
OwpAQCAtMTEyMSwxMyArMTI3NSwxNCBAQCBzdGF0aWMgaW50IG10a19uYXBpX3R4KHN0cnVjdCBu
YXBpX3N0cnVjdCAqbmFwaSwgaW50IGJ1ZGdldCkKIAl1MzIgc3RhdHVzLCBtYXNrOwogCWludCB0
eF9kb25lID0gMDsKIAotCW10a19oYW5kbGVfc3RhdHVzX2lycShldGgpOwotCW10a193MzIoZXRo
LCBNVEtfVFhfRE9ORV9JTlQsIE1US19RRE1BX0lOVF9TVEFUVVMpOworCWlmIChNVEtfSEFTX0NB
UFMoZXRoLT5zb2MtPmNhcHMsIE1US19RRE1BKSkKKwkJbXRrX2hhbmRsZV9zdGF0dXNfaXJxKGV0
aCk7CisJbXRrX3czMihldGgsIE1US19UWF9ET05FX0lOVCwgZXRoLT50eF9pbnRfc3RhdHVzX3Jl
Zyk7CiAJdHhfZG9uZSA9IG10a19wb2xsX3R4KGV0aCwgYnVkZ2V0KTsKIAogCWlmICh1bmxpa2Vs
eShuZXRpZl9tc2dfaW50cihldGgpKSkgewotCQlzdGF0dXMgPSBtdGtfcjMyKGV0aCwgTVRLX1FE
TUFfSU5UX1NUQVRVUyk7Ci0JCW1hc2sgPSBtdGtfcjMyKGV0aCwgTVRLX1FETUFfSU5UX01BU0sp
OworCQlzdGF0dXMgPSBtdGtfcjMyKGV0aCwgZXRoLT50eF9pbnRfc3RhdHVzX3JlZyk7CisJCW1h
c2sgPSBtdGtfcjMyKGV0aCwgZXRoLT50eF9pbnRfbWFza19yZWcpOwogCQlkZXZfaW5mbyhldGgt
PmRldiwKIAkJCSAiZG9uZSB0eCAlZCwgaW50ciAweCUwOHgvMHgleFxuIiwKIAkJCSB0eF9kb25l
LCBzdGF0dXMsIG1hc2spOwpAQCAtMTEzNiw3ICsxMjkxLDcgQEAgc3RhdGljIGludCBtdGtfbmFw
aV90eChzdHJ1Y3QgbmFwaV9zdHJ1Y3QgKm5hcGksIGludCBidWRnZXQpCiAJaWYgKHR4X2RvbmUg
PT0gYnVkZ2V0KQogCQlyZXR1cm4gYnVkZ2V0OwogCi0Jc3RhdHVzID0gbXRrX3IzMihldGgsIE1U
S19RRE1BX0lOVF9TVEFUVVMpOworCXN0YXR1cyA9IG10a19yMzIoZXRoLCBldGgtPnR4X2ludF9z
dGF0dXNfcmVnKTsKIAlpZiAoc3RhdHVzICYgTVRLX1RYX0RPTkVfSU5UKQogCQlyZXR1cm4gYnVk
Z2V0OwogCkBAIC0xMjAzLDYgKzEzNTgsMjQgQEAgc3RhdGljIGludCBtdGtfdHhfYWxsb2Moc3Ry
dWN0IG10a19ldGggKmV0aCkKIAkJcmluZy0+ZG1hW2ldLnR4ZDMgPSBUWF9ETUFfTFMwIHwgVFhf
RE1BX09XTkVSX0NQVTsKIAl9CiAKKwkvKiBPbiBNVDc2ODggKFBETUEgb25seSkgdGhpcyBkcml2
ZXIgdXNlcyB0aGUgcmluZy0+ZG1hIHN0cnVjdHMKKwkgKiBvbmx5IGFzIHRoZSBmcmFtZXdvcmsu
IFRoZSByZWFsIEhXIGRlc2NyaXB0b3JzIGFyZSB0aGUgUERNQQorCSAqIGRlc2NyaXB0b3JzIGlu
IHJpbmctPmRtYV9wZG1hLgorCSAqLworCWlmICghTVRLX0hBU19DQVBTKGV0aC0+c29jLT5jYXBz
LCBNVEtfUURNQSkpIHsKKwkJcmluZy0+ZG1hX3BkbWEgPSBkbWFfYWxsb2NfY29oZXJlbnQoZXRo
LT5kZXYsIE1US19ETUFfU0laRSAqIHN6LAorCQkJCQkJICAgICZyaW5nLT5waHlzX3BkbWEsCisJ
CQkJCQkgICAgR0ZQX0FUT01JQyk7CisJCWlmICghcmluZy0+ZG1hX3BkbWEpCisJCQlnb3RvIG5v
X3R4X21lbTsKKworCQlmb3IgKGkgPSAwOyBpIDwgTVRLX0RNQV9TSVpFOyBpKyspIHsKKwkJCXJp
bmctPmRtYV9wZG1hW2ldLnR4ZDIgPSBUWF9ETUFfREVTUDJfREVGOworCQkJcmluZy0+ZG1hX3Bk
bWFbaV0udHhkNCA9IDA7CisJCX0KKwl9CisKKwlyaW5nLT5kbWFfc2l6ZSA9IE1US19ETUFfU0la
RTsKIAlhdG9taWNfc2V0KCZyaW5nLT5mcmVlX2NvdW50LCBNVEtfRE1BX1NJWkUgLSAyKTsKIAly
aW5nLT5uZXh0X2ZyZWUgPSAmcmluZy0+ZG1hWzBdOwogCXJpbmctPmxhc3RfZnJlZSA9ICZyaW5n
LT5kbWFbTVRLX0RNQV9TSVpFIC0gMV07CkBAIC0xMjEzLDE1ICsxMzg2LDIzIEBAIHN0YXRpYyBp
bnQgbXRrX3R4X2FsbG9jKHN0cnVjdCBtdGtfZXRoICpldGgpCiAJICovCiAJd21iKCk7CiAKLQlt
dGtfdzMyKGV0aCwgcmluZy0+cGh5cywgTVRLX1FUWF9DVFhfUFRSKTsKLQltdGtfdzMyKGV0aCwg
cmluZy0+cGh5cywgTVRLX1FUWF9EVFhfUFRSKTsKLQltdGtfdzMyKGV0aCwKLQkJcmluZy0+cGh5
cyArICgoTVRLX0RNQV9TSVpFIC0gMSkgKiBzeiksCi0JCU1US19RVFhfQ1JYX1BUUik7Ci0JbXRr
X3czMihldGgsCi0JCXJpbmctPnBoeXMgKyAoKE1US19ETUFfU0laRSAtIDEpICogc3opLAotCQlN
VEtfUVRYX0RSWF9QVFIpOwotCW10a193MzIoZXRoLCAoUURNQV9SRVNfVEhSRVMgPDwgOCkgfCBR
RE1BX1JFU19USFJFUywgTVRLX1FUWF9DRkcoMCkpOworCWlmIChNVEtfSEFTX0NBUFMoZXRoLT5z
b2MtPmNhcHMsIE1US19RRE1BKSkgeworCQltdGtfdzMyKGV0aCwgcmluZy0+cGh5cywgTVRLX1FU
WF9DVFhfUFRSKTsKKwkJbXRrX3czMihldGgsIHJpbmctPnBoeXMsIE1US19RVFhfRFRYX1BUUik7
CisJCW10a193MzIoZXRoLAorCQkJcmluZy0+cGh5cyArICgoTVRLX0RNQV9TSVpFIC0gMSkgKiBz
eiksCisJCQlNVEtfUVRYX0NSWF9QVFIpOworCQltdGtfdzMyKGV0aCwKKwkJCXJpbmctPnBoeXMg
KyAoKE1US19ETUFfU0laRSAtIDEpICogc3opLAorCQkJTVRLX1FUWF9EUlhfUFRSKTsKKwkJbXRr
X3czMihldGgsIChRRE1BX1JFU19USFJFUyA8PCA4KSB8IFFETUFfUkVTX1RIUkVTLAorCQkJTVRL
X1FUWF9DRkcoMCkpOworCX0gZWxzZSB7CisJCW10a193MzIoZXRoLCByaW5nLT5waHlzX3BkbWEs
IE1UNzYyOF9UWF9CQVNFX1BUUjApOworCQltdGtfdzMyKGV0aCwgTVRLX0RNQV9TSVpFLCBNVDc2
MjhfVFhfTUFYX0NOVDApOworCQltdGtfdzMyKGV0aCwgMCwgTVQ3NjI4X1RYX0NUWF9JRFgwKTsK
KwkJbXRrX3czMihldGgsIE1UNzYyOF9QU1RfRFRYX0lEWDAsIE1US19QRE1BX1JTVF9JRFgpOwor
CX0KIAogCXJldHVybiAwOwogCkBAIC0xMjQ4LDYgKzE0MjksMTQgQEAgc3RhdGljIHZvaWQgbXRr
X3R4X2NsZWFuKHN0cnVjdCBtdGtfZXRoICpldGgpCiAJCQkJICByaW5nLT5waHlzKTsKIAkJcmlu
Zy0+ZG1hID0gTlVMTDsKIAl9CisKKwlpZiAocmluZy0+ZG1hX3BkbWEpIHsKKwkJZG1hX2ZyZWVf
Y29oZXJlbnQoZXRoLT5kZXYsCisJCQkJICBNVEtfRE1BX1NJWkUgKiBzaXplb2YoKnJpbmctPmRt
YV9wZG1hKSwKKwkJCQkgIHJpbmctPmRtYV9wZG1hLAorCQkJCSAgcmluZy0+cGh5c19wZG1hKTsK
KwkJcmluZy0+ZG1hX3BkbWEgPSBOVUxMOworCX0KIH0KIAogc3RhdGljIGludCBtdGtfcnhfYWxs
b2Moc3RydWN0IG10a19ldGggKmV0aCwgaW50IHJpbmdfbm8sIGludCByeF9mbGFnKQpAQCAtMTI5
NSwxNCArMTQ4NCwxNyBAQCBzdGF0aWMgaW50IG10a19yeF9hbGxvYyhzdHJ1Y3QgbXRrX2V0aCAq
ZXRoLCBpbnQgcmluZ19ubywgaW50IHJ4X2ZsYWcpCiAKIAlmb3IgKGkgPSAwOyBpIDwgcnhfZG1h
X3NpemU7IGkrKykgewogCQlkbWFfYWRkcl90IGRtYV9hZGRyID0gZG1hX21hcF9zaW5nbGUoZXRo
LT5kZXYsCi0JCQkJcmluZy0+ZGF0YVtpXSArIE5FVF9TS0JfUEFELAorCQkJCXJpbmctPmRhdGFb
aV0gKyBORVRfU0tCX1BBRCArIGV0aC0+aXBfYWxpZ24sCiAJCQkJcmluZy0+YnVmX3NpemUsCiAJ
CQkJRE1BX0ZST01fREVWSUNFKTsKIAkJaWYgKHVubGlrZWx5KGRtYV9tYXBwaW5nX2Vycm9yKGV0
aC0+ZGV2LCBkbWFfYWRkcikpKQogCQkJcmV0dXJuIC1FTk9NRU07CiAJCXJpbmctPmRtYVtpXS5y
eGQxID0gKHVuc2lnbmVkIGludClkbWFfYWRkcjsKIAotCQlyaW5nLT5kbWFbaV0ucnhkMiA9IFJY
X0RNQV9QTEVOMChyaW5nLT5idWZfc2l6ZSk7CisJCWlmIChNVEtfSEFTX0NBUFMoZXRoLT5zb2Mt
PmNhcHMsIE1US19TT0NfTVQ3NjI4KSkKKwkJCXJpbmctPmRtYVtpXS5yeGQyID0gUlhfRE1BX0xT
TzsKKwkJZWxzZQorCQkJcmluZy0+ZG1hW2ldLnJ4ZDIgPSBSWF9ETUFfUExFTjAocmluZy0+YnVm
X3NpemUpOwogCX0KIAlyaW5nLT5kbWFfc2l6ZSA9IHJ4X2RtYV9zaXplOwogCXJpbmctPmNhbGNf
aWR4X3VwZGF0ZSA9IGZhbHNlOwpAQCAtMTYxOCw5ICsxODEwLDE2IEBAIHN0YXRpYyBpbnQgbXRr
X2RtYV9idXN5X3dhaXQoc3RydWN0IG10a19ldGggKmV0aCkKIAl1bnNpZ25lZCBsb25nIHRfc3Rh
cnQgPSBqaWZmaWVzOwogCiAJd2hpbGUgKDEpIHsKLQkJaWYgKCEobXRrX3IzMihldGgsIE1US19R
RE1BX0dMT19DRkcpICYKLQkJICAgICAgKE1US19SWF9ETUFfQlVTWSB8IE1US19UWF9ETUFfQlVT
WSkpKQotCQkJcmV0dXJuIDA7CisJCWlmIChNVEtfSEFTX0NBUFMoZXRoLT5zb2MtPmNhcHMsIE1U
S19RRE1BKSkgeworCQkJaWYgKCEobXRrX3IzMihldGgsIE1US19RRE1BX0dMT19DRkcpICYKKwkJ
CSAgICAgIChNVEtfUlhfRE1BX0JVU1kgfCBNVEtfVFhfRE1BX0JVU1kpKSkKKwkJCQlyZXR1cm4g
MDsKKwkJfSBlbHNlIHsKKwkJCWlmICghKG10a19yMzIoZXRoLCBNVEtfUERNQV9HTE9fQ0ZHKSAm
CisJCQkgICAgICAoTVRLX1JYX0RNQV9CVVNZIHwgTVRLX1RYX0RNQV9CVVNZKSkpCisJCQkJcmV0
dXJuIDA7CisJCX0KKwogCQlpZiAodGltZV9hZnRlcihqaWZmaWVzLCB0X3N0YXJ0ICsgTVRLX0RN
QV9CVVNZX1RJTUVPVVQpKQogCQkJYnJlYWs7CiAJfQpAQCAtMTYzNywyMCArMTgzNiwyNCBAQCBz
dGF0aWMgaW50IG10a19kbWFfaW5pdChzdHJ1Y3QgbXRrX2V0aCAqZXRoKQogCWlmIChtdGtfZG1h
X2J1c3lfd2FpdChldGgpKQogCQlyZXR1cm4gLUVCVVNZOwogCi0JLyogUURNQSBuZWVkcyBzY3Jh
dGNoIG1lbW9yeSBmb3IgaW50ZXJuYWwgcmVvcmRlcmluZyBvZiB0aGUKLQkgKiBkZXNjcmlwdG9y
cwotCSAqLwotCWVyciA9IG10a19pbml0X2ZxX2RtYShldGgpOwotCWlmIChlcnIpCi0JCXJldHVy
biBlcnI7CisJaWYgKE1US19IQVNfQ0FQUyhldGgtPnNvYy0+Y2FwcywgTVRLX1FETUEpKSB7CisJ
CS8qIFFETUEgbmVlZHMgc2NyYXRjaCBtZW1vcnkgZm9yIGludGVybmFsIHJlb3JkZXJpbmcgb2Yg
dGhlCisJCSAqIGRlc2NyaXB0b3JzCisJCSAqLworCQllcnIgPSBtdGtfaW5pdF9mcV9kbWEoZXRo
KTsKKwkJaWYgKGVycikKKwkJCXJldHVybiBlcnI7CisJfQogCiAJZXJyID0gbXRrX3R4X2FsbG9j
KGV0aCk7CiAJaWYgKGVycikKIAkJcmV0dXJuIGVycjsKIAotCWVyciA9IG10a19yeF9hbGxvYyhl
dGgsIDAsIE1US19SWF9GTEFHU19RRE1BKTsKLQlpZiAoZXJyKQotCQlyZXR1cm4gZXJyOworCWlm
IChNVEtfSEFTX0NBUFMoZXRoLT5zb2MtPmNhcHMsIE1US19RRE1BKSkgeworCQllcnIgPSBtdGtf
cnhfYWxsb2MoZXRoLCAwLCBNVEtfUlhfRkxBR1NfUURNQSk7CisJCWlmIChlcnIpCisJCQlyZXR1
cm4gZXJyOworCX0KIAogCWVyciA9IG10a19yeF9hbGxvYyhldGgsIDAsIE1US19SWF9GTEFHU19O
T1JNQUwpOwogCWlmIChlcnIpCkBAIC0xNjY3LDEwICsxODcwLDE0IEBAIHN0YXRpYyBpbnQgbXRr
X2RtYV9pbml0KHN0cnVjdCBtdGtfZXRoICpldGgpCiAJCQlyZXR1cm4gZXJyOwogCX0KIAotCS8q
IEVuYWJsZSByYW5kb20gZWFybHkgZHJvcCBhbmQgc2V0IGRyb3AgdGhyZXNob2xkIGF1dG9tYXRp
Y2FsbHkgKi8KLQltdGtfdzMyKGV0aCwgRkNfVEhSRVNfRFJPUF9NT0RFIHwgRkNfVEhSRVNfRFJP
UF9FTiB8IEZDX1RIUkVTX01JTiwKLQkJTVRLX1FETUFfRkNfVEhSRVMpOwotCW10a193MzIoZXRo
LCAweDAsIE1US19RRE1BX0hSRUQyKTsKKwlpZiAoTVRLX0hBU19DQVBTKGV0aC0+c29jLT5jYXBz
LCBNVEtfUURNQSkpIHsKKwkJLyogRW5hYmxlIHJhbmRvbSBlYXJseSBkcm9wIGFuZCBzZXQgZHJv
cCB0aHJlc2hvbGQKKwkJICogYXV0b21hdGljYWxseQorCQkgKi8KKwkJbXRrX3czMihldGgsIEZD
X1RIUkVTX0RST1BfTU9ERSB8IEZDX1RIUkVTX0RST1BfRU4gfAorCQkJRkNfVEhSRVNfTUlOLCBN
VEtfUURNQV9GQ19USFJFUyk7CisJCW10a193MzIoZXRoLCAweDAsIE1US19RRE1BX0hSRUQyKTsK
Kwl9CiAKIAlyZXR1cm4gMDsKIH0KQEAgLTE3NDEsMTMgKzE5NDgsMTUgQEAgc3RhdGljIGlycXJl
dHVybl90IG10a19oYW5kbGVfaXJxX3R4KGludCBpcnEsIHZvaWQgKl9ldGgpCiBzdGF0aWMgaXJx
cmV0dXJuX3QgbXRrX2hhbmRsZV9pcnEoaW50IGlycSwgdm9pZCAqX2V0aCkKIHsKIAlzdHJ1Y3Qg
bXRrX2V0aCAqZXRoID0gX2V0aDsKKwl1MzIgc3RhdHVzOwogCisJc3RhdHVzID0gbXRrX3IzMihl
dGgsIE1US19QRE1BX0lOVF9TVEFUVVMpOwogCWlmIChtdGtfcjMyKGV0aCwgTVRLX1BETUFfSU5U
X01BU0spICYgTVRLX1JYX0RPTkVfSU5UKSB7CiAJCWlmIChtdGtfcjMyKGV0aCwgTVRLX1BETUFf
SU5UX1NUQVRVUykgJiBNVEtfUlhfRE9ORV9JTlQpCiAJCQltdGtfaGFuZGxlX2lycV9yeChpcnEs
IF9ldGgpOwogCX0KLQlpZiAobXRrX3IzMihldGgsIE1US19RRE1BX0lOVF9NQVNLKSAmIE1US19U
WF9ET05FX0lOVCkgewotCQlpZiAobXRrX3IzMihldGgsIE1US19RRE1BX0lOVF9TVEFUVVMpICYg
TVRLX1RYX0RPTkVfSU5UKQorCWlmIChtdGtfcjMyKGV0aCwgZXRoLT50eF9pbnRfbWFza19yZWcp
ICYgTVRLX1RYX0RPTkVfSU5UKSB7CisJCWlmIChtdGtfcjMyKGV0aCwgZXRoLT50eF9pbnRfc3Rh
dHVzX3JlZykgJiBNVEtfVFhfRE9ORV9JTlQpCiAJCQltdGtfaGFuZGxlX2lycV90eChpcnEsIF9l
dGgpOwogCX0KIApAQCAtMTc3OSwxNyArMTk4OCwyMyBAQCBzdGF0aWMgaW50IG10a19zdGFydF9k
bWEoc3RydWN0IG10a19ldGggKmV0aCkKIAkJcmV0dXJuIGVycjsKIAl9CiAKLQltdGtfdzMyKGV0
aCwKLQkJTVRLX1RYX1dCX0RET05FIHwgTVRLX1RYX0RNQV9FTiB8Ci0JCU1US19ETUFfU0laRV8x
NkRXT1JEUyB8IE1US19ORFBfQ09fUFJPIHwKLQkJTVRLX1JYX0RNQV9FTiB8IE1US19SWF8yQl9P
RkZTRVQgfAotCQlNVEtfUlhfQlRfMzJEV09SRFMsCi0JCU1US19RRE1BX0dMT19DRkcpOworCWlm
IChNVEtfSEFTX0NBUFMoZXRoLT5zb2MtPmNhcHMsIE1US19RRE1BKSkgeworCQltdGtfdzMyKGV0
aCwKKwkJCU1US19UWF9XQl9ERE9ORSB8IE1US19UWF9ETUFfRU4gfAorCQkJTVRLX0RNQV9TSVpF
XzE2RFdPUkRTIHwgTVRLX05EUF9DT19QUk8gfAorCQkJTVRLX1JYX0RNQV9FTiB8IE1US19SWF8y
Ql9PRkZTRVQgfAorCQkJTVRLX1JYX0JUXzMyRFdPUkRTLAorCQkJTVRLX1FETUFfR0xPX0NGRyk7
CiAKLQltdGtfdzMyKGV0aCwKLQkJTVRLX1JYX0RNQV9FTiB8IHJ4XzJiX29mZnNldCB8Ci0JCU1U
S19SWF9CVF8zMkRXT1JEUyB8IE1US19NVUxUSV9FTiwKLQkJTVRLX1BETUFfR0xPX0NGRyk7CisJ
CW10a193MzIoZXRoLAorCQkJTVRLX1JYX0RNQV9FTiB8IHJ4XzJiX29mZnNldCB8CisJCQlNVEtf
UlhfQlRfMzJEV09SRFMgfCBNVEtfTVVMVElfRU4sCisJCQlNVEtfUERNQV9HTE9fQ0ZHKTsKKwl9
IGVsc2UgeworCQltdGtfdzMyKGV0aCwgTVRLX1RYX1dCX0RET05FIHwgTVRLX1RYX0RNQV9FTiB8
IE1US19SWF9ETUFfRU4gfAorCQkJTVRLX01VTFRJX0VOIHwgTVRLX1BETUFfU0laRV84RFdPUkRT
LAorCQkJTVRLX1BETUFfR0xPX0NGRyk7CisJfQogCiAJcmV0dXJuIDA7CiB9CkBAIC0xODE3LDcg
KzIwMzIsNiBAQCBzdGF0aWMgaW50IG10a19vcGVuKHN0cnVjdCBuZXRfZGV2aWNlICpkZXYpCiAK
IAlwaHlfc3RhcnQoZGV2LT5waHlkZXYpOwogCW5ldGlmX3N0YXJ0X3F1ZXVlKGRldik7Ci0KIAly
ZXR1cm4gMDsKIH0KIApAQCAtMTg2MSw3ICsyMDc1LDggQEAgc3RhdGljIGludCBtdGtfc3RvcChz
dHJ1Y3QgbmV0X2RldmljZSAqZGV2KQogCW5hcGlfZGlzYWJsZSgmZXRoLT50eF9uYXBpKTsKIAlu
YXBpX2Rpc2FibGUoJmV0aC0+cnhfbmFwaSk7CiAKLQltdGtfc3RvcF9kbWEoZXRoLCBNVEtfUURN
QV9HTE9fQ0ZHKTsKKwlpZiAoTVRLX0hBU19DQVBTKGV0aC0+c29jLT5jYXBzLCBNVEtfUURNQSkp
CisJCW10a19zdG9wX2RtYShldGgsIE1US19RRE1BX0dMT19DRkcpOwogCW10a19zdG9wX2RtYShl
dGgsIE1US19QRE1BX0dMT19DRkcpOwogCiAJbXRrX2RtYV9mcmVlKGV0aCk7CkBAIC0xOTIzLDYg
KzIxMzgsMjQgQEAgc3RhdGljIGludCBtdGtfaHdfaW5pdChzdHJ1Y3QgbXRrX2V0aCAqZXRoKQog
CWlmIChyZXQpCiAJCWdvdG8gZXJyX2Rpc2FibGVfcG07CiAKKwlpZiAoTVRLX0hBU19DQVBTKGV0
aC0+c29jLT5jYXBzLCBNVEtfU09DX01UNzYyOCkpIHsKKwkJcmV0ID0gZGV2aWNlX3Jlc2V0KGV0
aC0+ZGV2KTsKKwkJaWYgKHJldCkgeworCQkJZGV2X2VycihldGgtPmRldiwgIk1BQyByZXNldCBm
YWlsZWQhXG4iKTsKKwkJCWdvdG8gZXJyX2Rpc2FibGVfcG07CisJCX0KKworCQkvKiBlbmFibGUg
aW50ZXJydXB0IGRlbGF5IGZvciBSWCAqLworCQltdGtfdzMyKGV0aCwgTVRLX1BETUFfREVMQVlf
UlhfREVMQVksIE1US19QRE1BX0RFTEFZX0lOVCk7CisKKwkJLyogZGlzYWJsZSBkZWxheSBhbmQg
bm9ybWFsIGludGVycnVwdCAqLworCQltdGtfdHhfaXJxX2Rpc2FibGUoZXRoLCB+MCk7CisJCW10
a19yeF9pcnFfZGlzYWJsZShldGgsIH4wKTsKKworCQlyZXR1cm4gMDsKKwl9CisKKwkvKiBOb24t
TVQ3NjI4IGhhbmRsaW5nLi4uICovCiAJZXRoc3lzX3Jlc2V0KGV0aCwgUlNUQ1RSTF9GRSk7CiAJ
ZXRoc3lzX3Jlc2V0KGV0aCwgUlNUQ1RSTF9QUEUpOwogCkBAIC0yNDI2LDEzICsyNjU5LDEzIEBA
IHN0YXRpYyBpbnQgbXRrX2FkZF9tYWMoc3RydWN0IG10a19ldGggKmV0aCwgc3RydWN0IGRldmlj
ZV9ub2RlICpucCkKIAlldGgtPm5ldGRldltpZF0tPm5ldGRldl9vcHMgPSAmbXRrX25ldGRldl9v
cHM7CiAJZXRoLT5uZXRkZXZbaWRdLT5iYXNlX2FkZHIgPSAodW5zaWduZWQgbG9uZylldGgtPmJh
c2U7CiAKLQlldGgtPm5ldGRldltpZF0tPmh3X2ZlYXR1cmVzID0gTVRLX0hXX0ZFQVRVUkVTOwor
CWV0aC0+bmV0ZGV2W2lkXS0+aHdfZmVhdHVyZXMgPSBldGgtPnNvYy0+aHdfZmVhdHVyZXM7CiAJ
aWYgKGV0aC0+aHdscm8pCiAJCWV0aC0+bmV0ZGV2W2lkXS0+aHdfZmVhdHVyZXMgfD0gTkVUSUZf
Rl9MUk87CiAKLQlldGgtPm5ldGRldltpZF0tPnZsYW5fZmVhdHVyZXMgPSBNVEtfSFdfRkVBVFVS
RVMgJgorCWV0aC0+bmV0ZGV2W2lkXS0+dmxhbl9mZWF0dXJlcyA9IGV0aC0+c29jLT5od19mZWF0
dXJlcyAmCiAJCX4oTkVUSUZfRl9IV19WTEFOX0NUQUdfVFggfCBORVRJRl9GX0hXX1ZMQU5fQ1RB
R19SWCk7Ci0JZXRoLT5uZXRkZXZbaWRdLT5mZWF0dXJlcyB8PSBNVEtfSFdfRkVBVFVSRVM7CisJ
ZXRoLT5uZXRkZXZbaWRdLT5mZWF0dXJlcyB8PSBldGgtPnNvYy0+aHdfZmVhdHVyZXM7CiAJZXRo
LT5uZXRkZXZbaWRdLT5ldGh0b29sX29wcyA9ICZtdGtfZXRodG9vbF9vcHM7CiAKIAlldGgtPm5l
dGRldltpZF0tPmlycSA9IGV0aC0+aXJxWzBdOwpAQCAtMjQ2MywxNSArMjY5NiwzMiBAQCBzdGF0
aWMgaW50IG10a19wcm9iZShzdHJ1Y3QgcGxhdGZvcm1fZGV2aWNlICpwZGV2KQogCWlmIChJU19F
UlIoZXRoLT5iYXNlKSkKIAkJcmV0dXJuIFBUUl9FUlIoZXRoLT5iYXNlKTsKIAorCWlmIChNVEtf
SEFTX0NBUFMoZXRoLT5zb2MtPmNhcHMsIE1US19RRE1BKSkgeworCQlldGgtPnR4X2ludF9tYXNr
X3JlZyA9IE1US19RRE1BX0lOVF9NQVNLOworCQlldGgtPnR4X2ludF9zdGF0dXNfcmVnID0gTVRL
X1FETUFfSU5UX1NUQVRVUzsKKwl9IGVsc2UgeworCQlldGgtPnR4X2ludF9tYXNrX3JlZyA9IE1U
S19QRE1BX0lOVF9NQVNLOworCQlldGgtPnR4X2ludF9zdGF0dXNfcmVnID0gTVRLX1BETUFfSU5U
X1NUQVRVUzsKKwl9CisKKwlpZiAoTVRLX0hBU19DQVBTKGV0aC0+c29jLT5jYXBzLCBNVEtfU09D
X01UNzYyOCkpIHsKKwkJZXRoLT5yeF9kbWFfbDRfdmFsaWQgPSBSWF9ETUFfTDRfVkFMSURfUERN
QTsKKwkJZXRoLT5pcF9hbGlnbiA9IE5FVF9JUF9BTElHTjsKKwl9IGVsc2UgeworCQlldGgtPnJ4
X2RtYV9sNF92YWxpZCA9IFJYX0RNQV9MNF9WQUxJRDsKKwl9CisKIAlzcGluX2xvY2tfaW5pdCgm
ZXRoLT5wYWdlX2xvY2spOwogCXNwaW5fbG9ja19pbml0KCZldGgtPnR4X2lycV9sb2NrKTsKIAlz
cGluX2xvY2tfaW5pdCgmZXRoLT5yeF9pcnFfbG9jayk7CiAKLQlldGgtPmV0aHN5cyA9IHN5c2Nv
bl9yZWdtYXBfbG9va3VwX2J5X3BoYW5kbGUocGRldi0+ZGV2Lm9mX25vZGUsCi0JCQkJCQkgICAg
ICAibWVkaWF0ZWssZXRoc3lzIik7Ci0JaWYgKElTX0VSUihldGgtPmV0aHN5cykpIHsKLQkJZGV2
X2VycigmcGRldi0+ZGV2LCAibm8gZXRoc3lzIHJlZ21hcCBmb3VuZFxuIik7Ci0JCXJldHVybiBQ
VFJfRVJSKGV0aC0+ZXRoc3lzKTsKKwlpZiAoIU1US19IQVNfQ0FQUyhldGgtPnNvYy0+Y2Fwcywg
TVRLX1NPQ19NVDc2MjgpKSB7CisJCWV0aC0+ZXRoc3lzID0gc3lzY29uX3JlZ21hcF9sb29rdXBf
YnlfcGhhbmRsZShwZGV2LT5kZXYub2Zfbm9kZSwKKwkJCQkJCQkgICAgICAibWVkaWF0ZWssZXRo
c3lzIik7CisJCWlmIChJU19FUlIoZXRoLT5ldGhzeXMpKSB7CisJCQlkZXZfZXJyKCZwZGV2LT5k
ZXYsICJubyBldGhzeXMgcmVnbWFwIGZvdW5kXG4iKTsKKwkJCXJldHVybiBQVFJfRVJSKGV0aC0+
ZXRoc3lzKTsKKwkJfQogCX0KIAogCWlmIChNVEtfSEFTX0NBUFMoZXRoLT5zb2MtPmNhcHMsIE1U
S19JTkZSQSkpIHsKQEAgLTI1NzIsOSArMjgyMiwxMiBAQCBzdGF0aWMgaW50IG10a19wcm9iZShz
dHJ1Y3QgcGxhdGZvcm1fZGV2aWNlICpwZGV2KQogCWlmIChlcnIpCiAJCWdvdG8gZXJyX2ZyZWVf
ZGV2OwogCi0JZXJyID0gbXRrX21kaW9faW5pdChldGgpOwotCWlmIChlcnIpCi0JCWdvdG8gZXJy
X2ZyZWVfZGV2OworCS8qIE5vIE1UNzYyOC84OCBzdXBwb3J0IHlldCAqLworCWlmICghTVRLX0hB
U19DQVBTKGV0aC0+c29jLT5jYXBzLCBNVEtfU09DX01UNzYyOCkpIHsKKwkJZXJyID0gbXRrX21k
aW9faW5pdChldGgpOworCQlpZiAoZXJyKQorCQkJZ290byBlcnJfZnJlZV9kZXY7CisJfQogCiAJ
Zm9yIChpID0gMDsgaSA8IE1US19NQVhfREVWUzsgaSsrKSB7CiAJCWlmICghZXRoLT5uZXRkZXZb
aV0pCkBAIC0yNjM3LDEyICsyODkwLDE0IEBAIHN0YXRpYyBpbnQgbXRrX3JlbW92ZShzdHJ1Y3Qg
cGxhdGZvcm1fZGV2aWNlICpwZGV2KQogCiBzdGF0aWMgY29uc3Qgc3RydWN0IG10a19zb2NfZGF0
YSBtdDI3MDFfZGF0YSA9IHsKIAkuY2FwcyA9IE1UNzYyM19DQVBTIHwgTVRLX0hXTFJPLAorCS5o
d19mZWF0dXJlcyA9IE1US19IV19GRUFUVVJFUywKIAkucmVxdWlyZWRfY2xrcyA9IE1UNzYyM19D
TEtTX0JJVE1BUCwKIAkucmVxdWlyZWRfcGN0bCA9IHRydWUsCiB9OwogCiBzdGF0aWMgY29uc3Qg
c3RydWN0IG10a19zb2NfZGF0YSBtdDc2MjFfZGF0YSA9IHsKIAkuY2FwcyA9IE1UNzYyMV9DQVBT
LAorCS5od19mZWF0dXJlcyA9IE1US19IV19GRUFUVVJFUywKIAkucmVxdWlyZWRfY2xrcyA9IE1U
NzYyMV9DTEtTX0JJVE1BUCwKIAkucmVxdWlyZWRfcGN0bCA9IGZhbHNlLAogfTsKQEAgLTI2NTAs
MTIgKzI5MDUsMTQgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBtdGtfc29jX2RhdGEgbXQ3NjIxX2Rh
dGEgPSB7CiBzdGF0aWMgY29uc3Qgc3RydWN0IG10a19zb2NfZGF0YSBtdDc2MjJfZGF0YSA9IHsK
IAkuYW5hX3JnYzMgPSAweDIwMjgsCiAJLmNhcHMgPSBNVDc2MjJfQ0FQUyB8IE1US19IV0xSTywK
KwkuaHdfZmVhdHVyZXMgPSBNVEtfSFdfRkVBVFVSRVMsCiAJLnJlcXVpcmVkX2Nsa3MgPSBNVDc2
MjJfQ0xLU19CSVRNQVAsCiAJLnJlcXVpcmVkX3BjdGwgPSBmYWxzZSwKIH07CiAKIHN0YXRpYyBj
b25zdCBzdHJ1Y3QgbXRrX3NvY19kYXRhIG10NzYyM19kYXRhID0gewogCS5jYXBzID0gTVQ3NjIz
X0NBUFMgfCBNVEtfSFdMUk8sCisJLmh3X2ZlYXR1cmVzID0gTVRLX0hXX0ZFQVRVUkVTLAogCS5y
ZXF1aXJlZF9jbGtzID0gTVQ3NjIzX0NMS1NfQklUTUFQLAogCS5yZXF1aXJlZF9wY3RsID0gdHJ1
ZSwKIH07CkBAIC0yNjYzLDE2ICsyOTIwLDI1IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgbXRrX3Nv
Y19kYXRhIG10NzYyM19kYXRhID0gewogc3RhdGljIGNvbnN0IHN0cnVjdCBtdGtfc29jX2RhdGEg
bXQ3NjI5X2RhdGEgPSB7CiAJLmFuYV9yZ2MzID0gMHgxMjgsCiAJLmNhcHMgPSBNVDc2MjlfQ0FQ
UyB8IE1US19IV0xSTywKKwkuaHdfZmVhdHVyZXMgPSBNVEtfSFdfRkVBVFVSRVMsCiAJLnJlcXVp
cmVkX2Nsa3MgPSBNVDc2MjlfQ0xLU19CSVRNQVAsCiAJLnJlcXVpcmVkX3BjdGwgPSBmYWxzZSwK
IH07CiAKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgbXRrX3NvY19kYXRhIHJ0NTM1MF9kYXRhID0gewor
CS5jYXBzID0gTVQ3NjI4X0NBUFMsCisJLmh3X2ZlYXR1cmVzID0gTVRLX0hXX0ZFQVRVUkVTX01U
NzYyOCwKKwkucmVxdWlyZWRfY2xrcyA9IE1UNzYyOF9DTEtTX0JJVE1BUCwKKwkucmVxdWlyZWRf
cGN0bCA9IGZhbHNlLAorfTsKKwogY29uc3Qgc3RydWN0IG9mX2RldmljZV9pZCBvZl9tdGtfbWF0
Y2hbXSA9IHsKIAl7IC5jb21wYXRpYmxlID0gIm1lZGlhdGVrLG10MjcwMS1ldGgiLCAuZGF0YSA9
ICZtdDI3MDFfZGF0YX0sCiAJeyAuY29tcGF0aWJsZSA9ICJtZWRpYXRlayxtdDc2MjEtZXRoIiwg
LmRhdGEgPSAmbXQ3NjIxX2RhdGF9LAogCXsgLmNvbXBhdGlibGUgPSAibWVkaWF0ZWssbXQ3NjIy
LWV0aCIsIC5kYXRhID0gJm10NzYyMl9kYXRhfSwKIAl7IC5jb21wYXRpYmxlID0gIm1lZGlhdGVr
LG10NzYyMy1ldGgiLCAuZGF0YSA9ICZtdDc2MjNfZGF0YX0sCiAJeyAuY29tcGF0aWJsZSA9ICJt
ZWRpYXRlayxtdDc2MjktZXRoIiwgLmRhdGEgPSAmbXQ3NjI5X2RhdGF9LAorCXsgLmNvbXBhdGli
bGUgPSAicmFsaW5rLHJ0NTM1MC1ldGgiLCAuZGF0YSA9ICZydDUzNTBfZGF0YX0sCiAJe30sCiB9
OwogTU9EVUxFX0RFVklDRV9UQUJMRShvZiwgb2ZfbXRrX21hdGNoKTsKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvbmV0L2V0aGVybmV0L21lZGlhdGVrL210a19ldGhfc29jLmggYi9kcml2ZXJzL25ldC9l
dGhlcm5ldC9tZWRpYXRlay9tdGtfZXRoX3NvYy5oCmluZGV4IDU1NjY0NGYyOGVhZS4uY2MxNDY2
YWUwOTI2IDEwMDY0NAotLS0gYS9kcml2ZXJzL25ldC9ldGhlcm5ldC9tZWRpYXRlay9tdGtfZXRo
X3NvYy5oCisrKyBiL2RyaXZlcnMvbmV0L2V0aGVybmV0L21lZGlhdGVrL210a19ldGhfc29jLmgK
QEAgLTM5LDYgKzM5LDcgQEAKIAkJCQkgTkVUSUZfRl9TRyB8IE5FVElGX0ZfVFNPIHwgXAogCQkJ
CSBORVRJRl9GX1RTTzYgfCBcCiAJCQkJIE5FVElGX0ZfSVBWNl9DU1VNKQorI2RlZmluZSBNVEtf
SFdfRkVBVFVSRVNfTVQ3NjI4CShORVRJRl9GX1NHIHwgTkVUSUZfRl9SWENTVU0pCiAjZGVmaW5l
IE5FWFRfREVTUF9JRFgoWCwgWSkJKCgoWCkgKyAxKSAmICgoWSkgLSAxKSkKIAogI2RlZmluZSBN
VEtfTUFYX1JYX1JJTkdfTlVNCTQKQEAgLTExOCw2ICsxMTksNyBAQAogLyogUERNQSBHbG9iYWwg
Q29uZmlndXJhdGlvbiBSZWdpc3RlciAqLwogI2RlZmluZSBNVEtfUERNQV9HTE9fQ0ZHCTB4YTA0
CiAjZGVmaW5lIE1US19NVUxUSV9FTgkJQklUKDEwKQorI2RlZmluZSBNVEtfUERNQV9TSVpFXzhE
V09SRFMJKDEgPDwgNCkKIAogLyogUERNQSBSZXNldCBJbmRleCBSZWdpc3RlciAqLwogI2RlZmlu
ZSBNVEtfUERNQV9SU1RfSURYCTB4YTA4CkBAIC0yNzYsMTEgKzI3OCwxOCBAQAogI2RlZmluZSBU
WF9ETUFfT1dORVJfQ1BVCUJJVCgzMSkKICNkZWZpbmUgVFhfRE1BX0xTMAkJQklUKDMwKQogI2Rl
ZmluZSBUWF9ETUFfUExFTjAoX3gpCSgoKF94KSAmIE1US19UWF9ETUFfQlVGX0xFTikgPDwgMTYp
CisjZGVmaW5lIFRYX0RNQV9QTEVOMShfeCkJKChfeCkgJiBNVEtfVFhfRE1BX0JVRl9MRU4pCiAj
ZGVmaW5lIFRYX0RNQV9TV0MJCUJJVCgxNCkKICNkZWZpbmUgVFhfRE1BX1NETChfeCkJCSgoKF94
KSAmIDB4M2ZmZikgPDwgMTYpCiAKKy8qIFBETUEgb24gTVQ3NjI4ICovCisjZGVmaW5lIFRYX0RN
QV9ET05FCQlCSVQoMzEpCisjZGVmaW5lIFRYX0RNQV9MUzEJCUJJVCgxNCkKKyNkZWZpbmUgVFhf
RE1BX0RFU1AyX0RFRgkoVFhfRE1BX0xTMCB8IFRYX0RNQV9ET05FKQorCiAvKiBRRE1BIGRlc2Ny
aXB0b3IgcnhkMiAqLwogI2RlZmluZSBSWF9ETUFfRE9ORQkJQklUKDMxKQorI2RlZmluZSBSWF9E
TUFfTFNPCQlCSVQoMzApCiAjZGVmaW5lIFJYX0RNQV9QTEVOMChfeCkJKCgoX3gpICYgMHgzZmZm
KSA8PCAxNikKICNkZWZpbmUgUlhfRE1BX0dFVF9QTEVOMChfeCkJKCgoX3gpID4+IDE2KSAmIDB4
M2ZmZikKIApAQCAtMjg5LDYgKzI5OCw3IEBACiAKIC8qIFFETUEgZGVzY3JpcHRvciByeGQ0ICov
CiAjZGVmaW5lIFJYX0RNQV9MNF9WQUxJRAkJQklUKDI0KQorI2RlZmluZSBSWF9ETUFfTDRfVkFM
SURfUERNQQlCSVQoMzApCQkvKiB3aGVuIFBETUEgaXMgdXNlZCAqLwogI2RlZmluZSBSWF9ETUFf
RlBPUlRfU0hJRlQJMTkKICNkZWZpbmUgUlhfRE1BX0ZQT1JUX01BU0sJMHg3CiAKQEAgLTQxMiw2
ICs0MjIsMTkgQEAKICNkZWZpbmUgQ09fUVBIWV9TRUwgICAgICAgICAgICBCSVQoMCkKICNkZWZp
bmUgR0VQSFlfTUFDX1NFTCAgICAgICAgICBCSVQoMSkKIAorLyogTVQ3NjI4Lzg4IHNwZWNpZmlj
IHN0dWZmICovCisjZGVmaW5lIE1UNzYyOF9QRE1BX09GRlNFVAkweDA4MDAKKyNkZWZpbmUgTVQ3
NjI4X1NETV9PRkZTRVQJMHgwYzAwCisKKyNkZWZpbmUgTVQ3NjI4X1RYX0JBU0VfUFRSMAkoTVQ3
NjI4X1BETUFfT0ZGU0VUICsgMHgwMCkKKyNkZWZpbmUgTVQ3NjI4X1RYX01BWF9DTlQwCShNVDc2
MjhfUERNQV9PRkZTRVQgKyAweDA0KQorI2RlZmluZSBNVDc2MjhfVFhfQ1RYX0lEWDAJKE1UNzYy
OF9QRE1BX09GRlNFVCArIDB4MDgpCisjZGVmaW5lIE1UNzYyOF9UWF9EVFhfSURYMAkoTVQ3NjI4
X1BETUFfT0ZGU0VUICsgMHgwYykKKyNkZWZpbmUgTVQ3NjI4X1BTVF9EVFhfSURYMAlCSVQoMCkK
KworI2RlZmluZSBNVDc2MjhfU0RNX01BQ19BRFJMCShNVDc2MjhfU0RNX09GRlNFVCArIDB4MGMp
CisjZGVmaW5lIE1UNzYyOF9TRE1fTUFDX0FEUkgJKE1UNzYyOF9TRE1fT0ZGU0VUICsgMHgxMCkK
Kwogc3RydWN0IG10a19yeF9kbWEgewogCXVuc2lnbmVkIGludCByeGQxOwogCXVuc2lnbmVkIGlu
dCByeGQyOwpAQCAtNTA5LDYgKzUzMiw3IEBAIGVudW0gbXRrX2Nsa3NfbWFwIHsKIAkJCQkgQklU
KE1US19DTEtfU0dNSUlfQ0spIHwgXAogCQkJCSBCSVQoTVRLX0NMS19FVEgyUExMKSkKICNkZWZp
bmUgTVQ3NjIxX0NMS1NfQklUTUFQCSgwKQorI2RlZmluZSBNVDc2MjhfQ0xLU19CSVRNQVAJKDAp
CiAjZGVmaW5lIE1UNzYyOV9DTEtTX0JJVE1BUAkoQklUKE1US19DTEtfRVRISUYpIHwgQklUKE1U
S19DTEtfRVNXKSB8ICBcCiAJCQkJIEJJVChNVEtfQ0xLX0dQMCkgfCBCSVQoTVRLX0NMS19HUDEp
IHwgXAogCQkJCSBCSVQoTVRLX0NMS19HUDIpIHwgQklUKE1US19DTEtfRkUpIHwgXApAQCAtNTYz
LDYgKzU4NywxMCBAQCBzdHJ1Y3QgbXRrX3R4X3JpbmcgewogCXN0cnVjdCBtdGtfdHhfZG1hICps
YXN0X2ZyZWU7CiAJdTE2IHRocmVzaDsKIAlhdG9taWNfdCBmcmVlX2NvdW50OworCWludCBkbWFf
c2l6ZTsKKwlzdHJ1Y3QgbXRrX3R4X2RtYSAqZG1hX3BkbWE7CS8qIEZvciBNVDc2MjgvODggUERN
QSBoYW5kbGluZyAqLworCWRtYV9hZGRyX3QgcGh5c19wZG1hOworCWludCBjcHVfaWR4OwogfTsK
IAogLyogUERNQSByeCByaW5nIG1vZGUgKi8KQEAgLTYwNCw2ICs2MzIsOCBAQCBlbnVtIG1rdF9l
dGhfY2FwYWJpbGl0aWVzIHsKIAlNVEtfSFdMUk9fQklULAogCU1US19TSEFSRURfSU5UX0JJVCwK
IAlNVEtfVFJHTUlJX01UNzYyMV9DTEtfQklULAorCU1US19RRE1BX0JJVCwKKwlNVEtfU09DX01U
NzYyOF9CSVQsCiAKIAkvKiBNVVggQklUUyovCiAJTVRLX0VUSF9NVVhfR0RNMV9UT19HTUFDMV9F
U1dfQklULApAQCAtNjM0LDYgKzY2NCw4IEBAIGVudW0gbWt0X2V0aF9jYXBhYmlsaXRpZXMgewog
I2RlZmluZSBNVEtfSFdMUk8JCUJJVChNVEtfSFdMUk9fQklUKQogI2RlZmluZSBNVEtfU0hBUkVE
X0lOVAkJQklUKE1US19TSEFSRURfSU5UX0JJVCkKICNkZWZpbmUgTVRLX1RSR01JSV9NVDc2MjFf
Q0xLCUJJVChNVEtfVFJHTUlJX01UNzYyMV9DTEtfQklUKQorI2RlZmluZSBNVEtfUURNQQkJQklU
KE1US19RRE1BX0JJVCkKKyNkZWZpbmUgTVRLX1NPQ19NVDc2MjgJCUJJVChNVEtfU09DX01UNzYy
OF9CSVQpCiAKICNkZWZpbmUgTVRLX0VUSF9NVVhfR0RNMV9UT19HTUFDMV9FU1cJCVwKIAlCSVQo
TVRLX0VUSF9NVVhfR0RNMV9UT19HTUFDMV9FU1dfQklUKQpAQCAtNjg3LDI2ICs3MTksMzEgQEAg
ZW51bSBta3RfZXRoX2NhcGFiaWxpdGllcyB7CiAjZGVmaW5lIE1US19IQVNfQ0FQUyhjYXBzLCBf
eCkJCSgoKGNhcHMpICYgKF94KSkgPT0gKF94KSkKIAogI2RlZmluZSBNVDc2MjFfQ0FQUyAgKE1U
S19HTUFDMV9SR01JSSB8IE1US19HTUFDMV9UUkdNSUkgfCBcCi0JCSAgICAgIE1US19HTUFDMl9S
R01JSSB8IE1US19TSEFSRURfSU5UIHwgTVRLX1RSR01JSV9NVDc2MjFfQ0xLKQorCQkgICAgICBN
VEtfR01BQzJfUkdNSUkgfCBNVEtfU0hBUkVEX0lOVCB8IFwKKwkJICAgICAgTVRLX1RSR01JSV9N
VDc2MjFfQ0xLIHwgTVRLX1FETUEpCiAKICNkZWZpbmUgTVQ3NjIyX0NBUFMgIChNVEtfR01BQzFf
UkdNSUkgfCBNVEtfR01BQzFfU0dNSUkgfCBNVEtfR01BQzJfUkdNSUkgfCBcCiAJCSAgICAgIE1U
S19HTUFDMl9TR01JSSB8IE1US19HRE0xX0VTVyB8IFwKIAkJICAgICAgTVRLX01VWF9HRE0xX1RP
X0dNQUMxX0VTVyB8IFwKLQkJICAgICAgTVRLX01VWF9HTUFDMV9HTUFDMl9UT19TR01JSV9SR01J
SSkKKwkJICAgICAgTVRLX01VWF9HTUFDMV9HTUFDMl9UT19TR01JSV9SR01JSSB8IE1US19RRE1B
KQorCisjZGVmaW5lIE1UNzYyM19DQVBTICAoTVRLX0dNQUMxX1JHTUlJIHwgTVRLX0dNQUMxX1RS
R01JSSB8IE1US19HTUFDMl9SR01JSSB8IFwKKwkJICAgICAgTVRLX1FETUEpCiAKLSNkZWZpbmUg
TVQ3NjIzX0NBUFMgIChNVEtfR01BQzFfUkdNSUkgfCBNVEtfR01BQzFfVFJHTUlJIHwgTVRLX0dN
QUMyX1JHTUlJKQorI2RlZmluZSBNVDc2MjhfQ0FQUyAgKE1US19TSEFSRURfSU5UIHwgTVRLX1NP
Q19NVDc2MjgpCiAKICNkZWZpbmUgTVQ3NjI5X0NBUFMgIChNVEtfR01BQzFfU0dNSUkgfCBNVEtf
R01BQzJfU0dNSUkgfCBNVEtfR01BQzJfR0VQSFkgfCBcCiAJCSAgICAgIE1US19HRE0xX0VTVyB8
IE1US19NVVhfR0RNMV9UT19HTUFDMV9FU1cgfCBcCiAJCSAgICAgIE1US19NVVhfR01BQzJfR01B
QzBfVE9fR0VQSFkgfCBcCiAJCSAgICAgIE1US19NVVhfVTNfR01BQzJfVE9fUVBIWSB8IFwKLQkJ
ICAgICAgTVRLX01VWF9HTUFDMTJfVE9fR0VQSFlfU0dNSUkpCisJCSAgICAgIE1US19NVVhfR01B
QzEyX1RPX0dFUEhZX1NHTUlJIHwgTVRLX1FETUEpCiAKIC8qIHN0cnVjdCBtdGtfZXRoX2RhdGEg
LQlUaGlzIGlzIHRoZSBzdHJ1Y3R1cmUgaG9sZGluZyBhbGwgZGlmZmVyZW5jZXMKICAqCQkJCWFt
b25nIHZhcmlvdXMgcGxhZm9ybXMKICAqIEBhbmFfcmdjMzogICAgICAgICAgICAgICAgICAgVGhl
IG9mZnNldCBmb3IgcmVnaXN0ZXIgQU5BX1JHQzMgcmVsYXRlZCB0bwogICoJCQkJc2dtaWlzeXMg
c3lzY29uCiAgKiBAY2FwcwkJCUZsYWdzIHNob3duIHRoZSBleHRyYSBjYXBhYmlsaXR5IGZvciB0
aGUgU29DCisgKiBAaHdfZmVhdHVyZXMJCQlGbGFncyBzaG93biBIVyBmZWF0dXJlcwogICogQHJl
cXVpcmVkX2Nsa3MJCUZsYWdzIHNob3duIHRoZSBiaXRtYXAgZm9yIHJlcXVpcmVkIGNsb2NrcyBv
bgogICoJCQkJdGhlIHRhcmdldCBTb0MKICAqIEByZXF1aXJlZF9wY3RsCQlBIGJvb2wgdmFsdWUg
dG8gc2hvdyB3aGV0aGVyIHRoZSBTb0MgcmVxdWlyZXMKQEAgLTcxNyw2ICs3NTQsNyBAQCBzdHJ1
Y3QgbXRrX3NvY19kYXRhIHsKIAl1MzIJCWNhcHM7CiAJdTMyCQlyZXF1aXJlZF9jbGtzOwogCWJv
b2wJCXJlcXVpcmVkX3BjdGw7CisJbmV0ZGV2X2ZlYXR1cmVzX3QgaHdfZmVhdHVyZXM7CiB9Owog
CiAvKiBjdXJyZW50bHkgbm8gU29DIGhhcyBtb3JlIHRoYW4gMiBtYWNzICovCkBAIC04MTAsNiAr
ODQ4LDExIEBAIHN0cnVjdCBtdGtfZXRoIHsKIAl1bnNpZ25lZCBsb25nCQkJc3RhdGU7CiAKIAlj
b25zdCBzdHJ1Y3QgbXRrX3NvY19kYXRhCSpzb2M7CisKKwl1MzIJCQkJdHhfaW50X21hc2tfcmVn
OworCXUzMgkJCQl0eF9pbnRfc3RhdHVzX3JlZzsKKwl1MzIJCQkJcnhfZG1hX2w0X3ZhbGlkOwor
CWludAkJCQlpcF9hbGlnbjsKIH07CiAKIC8qIHN0cnVjdCBtdGtfbWFjIC0JdGhlIHN0cnVjdHVy
ZSB0aGF0IGhvbGRzIHRoZSBpbmZvIGFib3V0IHRoZSBNQUNzIG9mIHRoZQotLSAKMi4yMi4xCgoK
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KTGludXgtbWVk
aWF0ZWsgbWFpbGluZyBsaXN0CkxpbnV4LW1lZGlhdGVrQGxpc3RzLmluZnJhZGVhZC5vcmcKaHR0
cDovL2xpc3RzLmluZnJhZGVhZC5vcmcvbWFpbG1hbi9saXN0aW5mby9saW51eC1tZWRpYXRlawo=
